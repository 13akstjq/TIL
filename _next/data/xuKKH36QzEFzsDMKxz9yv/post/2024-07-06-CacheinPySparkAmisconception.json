{"pageProps":{"post":{"title":"PySparkμ Cache κΈ°λ¥μ— λ€ν• μ¤ν•΄","description":"","date":"2024-07-06 10:34","slug":"2024-07-06-CacheinPySparkAmisconception","content":"\n\n/assets/img/2024-07-06-CacheinPySparkAmisconception_0.png\n\nνμ΄μ¤νν¬(Pyspark)μ—μ„ λ³€ν™(transformations)κ³Ό μ•΅μ…(actions) μ‚¬μ΄μ λ―Έλ¬ν• μ°¨μ΄λ¥Ό μ΄ν•΄ν•λ” κ²ƒμ€ λ°μ΄ν„° μ²λ¦¬ μ›ν¬ν”λ΅μ°λ¥Ό μµμ ν™”ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤. ν•λ‚μ ν”ν• μ¤ν•΄λ” μ„±λ¥ μµμ ν™”μ— μ¤‘μ”ν• μ—­ν• μ„ ν•λ” `cache()` ν•¨μλ¥Ό μ•΅μ…μΌλ΅ μλ» μΈμ‹ν•λ” κ²ƒμ…λ‹λ‹¤.\n\nμ΄ μ¤ν•΄λ¥Ό μμ„Έν μ‚΄ν΄λ³΄μ\n\n# λ³€ν™(Transformations) λ° μ•΅μ…(Actions)\n\n<!-- TIL μν‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- λ³€ν™ μ‘μ—…: RDD(Resilience Distributed Dataset)μ— λ€ν• μ—°μ‚°μ„ μλ―Έν•λ©°, μƒλ΅μ΄ RDDλ¥Ό μƒμ„±ν•©λ‹λ‹¤. μ΄λ¬ν• μ‘μ—…λ“¤μ€ μ§€μ—° κ³„μ‚°μ„ μ‚¬μ©ν•μ—¬ μ¦‰μ‹ κ²°κ³Όλ¥Ό κ³„μ‚°ν•μ§€ μ•μµλ‹λ‹¤. μ¤‘μ”ν• μλ΅λ” filter(), join(), flatMap(), cache() λ“±μ΄ μμµλ‹λ‹¤. (μ΄ λ©λ΅μ— cache()κ°€ ν¬ν•¨λ κ²ƒμ„ λ³΄κ³  λ†€λΌμ…¨μ„ κ±°λΌκ³  μƒκ°ν•μ§€λ§, μ΄ λ‚΄μ©μ„ ν™•μΈν•μ‹λ©΄ λ” ν° κΉ¨λ‹¬μμ„ μ–»κ² λ  κ±°μ—μ” π‰)\n- μ•΅μ…: μ•΅μ…μ€ λ³€ν™ μ‘μ—…μ„ μ‹¤ν–‰ν•μ—¬ κ²°κ³Όλ¥Ό μƒμ„±ν•κ±°λ‚ λ°μ΄ν„°λ¥Ό μ™Έλ¶€ μ €μ¥μ†μ— μ“Έ λ• μ‚¬μ©λ©λ‹λ‹¤. μ¤‘μ”ν• μλ΅λ” collect(), count(), reduce(), saveAsTextFile() λ“±μ΄ μμµλ‹λ‹¤.\n\n# cache()κ°€ μ•΅μ…μΌλ΅ μ¤ν•΄λλ” λ¶€λ¶„μ— λ€ν• ν•΄λ…\n\ncache()λ” RDDλ¥Ό λ©”λ¨λ¦¬μ— μ €μ¥ν•μ—¬ μ΄ν›„μ μ‘μ—…μ—μ„ λΉ λ¥΄κ² μ ‘κ·Όν•  μ μλ„λ΅ ν‘μ‹ν•λ” λ³€ν™ μ‘μ—…μ…λ‹λ‹¤. μ΄λ” μ¦‰μ‹ κ³„μ‚°μ„ μν–‰ν•μ§€ μ•μΌλ©°, λ‹¨μ§€ RDDκ°€ μµμ΄ κ³„μ‚°μ„ μν–‰ν• ν›„ λ©”λ¨λ¦¬μ— μ μ§€λμ–΄μ•Ό ν•¨μ„ λ‚νƒ€λƒ…λ‹λ‹¤.\n\ncache()κ°€ ν¨κ³Όλ¥Ό λ°νν•λ” κ²½μ°:\n\n<!-- TIL μν‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nRDDμ μ‹¤μ  μΊμ‹±μ€ μ•΅μ…μ΄ νΈμ¶λ  λ•μ—λ§ λ°μƒν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μΊμ‹±λ RDDμ— count()μ™€ κ°™μ€ μ•΅μ…μ„ μν–‰ν•λ©΄, Sparkλ” RDDλ¥Ό κ³„μ‚°ν• λ‹¤μ λ―Έλ μ‚¬μ©μ„ μ„ν•΄ λ©”λ¨λ¦¬μ— μ €μ¥ν•©λ‹λ‹¤.\n\n```js\nrdd = sc.parallelize([1, 2, 3, 4, 5])\ncached_rdd = rdd.map(lambda x: x * 2).cache()  # μ΄κ²ƒμ€ λ³€ν™μ…λ‹λ‹¤\n\n# ν„μ¬κΉμ§€ μ•„μ§ κ³„μ‚°μ΄ λ°μƒν•μ§€λ” μ•μ•μµλ‹λ‹¤.\n\ncount = cached_rdd.count()  # μ΄κ²ƒμ€ μ•΅μ…μΌλ΅ κ³„μ‚° λ° μΊμ‹±μ„ νΈλ¦¬κ±°ν•©λ‹λ‹¤\n```\n\n# μ”μ•½:\n\n- λ³€ν™(Transformation): cache()λ” λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬μ— μ μ§€ν•¨μΌλ΅μ¨ λ―Έλμ μ•΅μ…μ„ μµμ ν™”ν•λ” λ°©λ²•μ„ Sparkμ— μ•λ ¤μ¤λ‹λ‹¤.\n- μ•΅μ…(Action): count(), collect()μ™€ κ°™μ΄ μ‹¤μ  κ³„μ‚°μ„ νΈλ¦¬κ±°ν•λ” λ¨λ“  μ‘μ—…μ€ λ³€ν™(μΊμ‹± ν¬ν•¨)μ΄ μ‹¤ν–‰λλ„λ΅ ν•©λ‹λ‹¤.\n\n<!-- TIL μν‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nμ΄λ¬ν• ν¬μΈνΈλ¥Ό μ΄ν•΄ν•λ©΄ cache()κ°€ λ³€ν™(transform)μ΄λ©° λ™μ‘(action)μ΄ μ•„λ‹ μ΄μ κ°€ λ…ν™•ν•΄μ§€λ¦¬λΌκ³  μƒκ°ν•΄μ”. cache()λ” λ―Έλ κ³„μ‚°μ„ μµμ ν™”ν•λ” λ° λ„μ›€μ„ μ£Όμ§€λ§ μ§μ ‘μ μΈ κ³„μ‚°μ„ μΌμΌν‚¤μ§€λ” μ•μ•„μ”.","ogImage":{"url":"/assets/img/2024-07-06-CacheinPySparkAmisconception_0.png"},"coverImage":"/assets/img/2024-07-06-CacheinPySparkAmisconception_0.png","tag":["Tech"],"readingTime":3},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>/assets/img/2024-07-06-CacheinPySparkAmisconception_0.png</p>\n<p>νμ΄μ¤νν¬(Pyspark)μ—μ„ λ³€ν™(transformations)κ³Ό μ•΅μ…(actions) μ‚¬μ΄μ λ―Έλ¬ν• μ°¨μ΄λ¥Ό μ΄ν•΄ν•λ” κ²ƒμ€ λ°μ΄ν„° μ²λ¦¬ μ›ν¬ν”λ΅μ°λ¥Ό μµμ ν™”ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤. ν•λ‚μ ν”ν• μ¤ν•΄λ” μ„±λ¥ μµμ ν™”μ— μ¤‘μ”ν• μ—­ν• μ„ ν•λ” <code>cache()</code> ν•¨μλ¥Ό μ•΅μ…μΌλ΅ μλ» μΈμ‹ν•λ” κ²ƒμ…λ‹λ‹¤.</p>\n<p>μ΄ μ¤ν•΄λ¥Ό μμ„Έν μ‚΄ν΄λ³΄μ</p>\n<h1>λ³€ν™(Transformations) λ° μ•΅μ…(Actions)</h1>\n<!-- TIL μν‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>λ³€ν™ μ‘μ—…: RDD(Resilience Distributed Dataset)μ— λ€ν• μ—°μ‚°μ„ μλ―Έν•λ©°, μƒλ΅μ΄ RDDλ¥Ό μƒμ„±ν•©λ‹λ‹¤. μ΄λ¬ν• μ‘μ—…λ“¤μ€ μ§€μ—° κ³„μ‚°μ„ μ‚¬μ©ν•μ—¬ μ¦‰μ‹ κ²°κ³Όλ¥Ό κ³„μ‚°ν•μ§€ μ•μµλ‹λ‹¤. μ¤‘μ”ν• μλ΅λ” filter(), join(), flatMap(), cache() λ“±μ΄ μμµλ‹λ‹¤. (μ΄ λ©λ΅μ— cache()κ°€ ν¬ν•¨λ κ²ƒμ„ λ³΄κ³  λ†€λΌμ…¨μ„ κ±°λΌκ³  μƒκ°ν•μ§€λ§, μ΄ λ‚΄μ©μ„ ν™•μΈν•μ‹λ©΄ λ” ν° κΉ¨λ‹¬μμ„ μ–»κ² λ  κ±°μ—μ” π‰)</li>\n<li>μ•΅μ…: μ•΅μ…μ€ λ³€ν™ μ‘μ—…μ„ μ‹¤ν–‰ν•μ—¬ κ²°κ³Όλ¥Ό μƒμ„±ν•κ±°λ‚ λ°μ΄ν„°λ¥Ό μ™Έλ¶€ μ €μ¥μ†μ— μ“Έ λ• μ‚¬μ©λ©λ‹λ‹¤. μ¤‘μ”ν• μλ΅λ” collect(), count(), reduce(), saveAsTextFile() λ“±μ΄ μμµλ‹λ‹¤.</li>\n</ul>\n<h1>cache()κ°€ μ•΅μ…μΌλ΅ μ¤ν•΄λλ” λ¶€λ¶„μ— λ€ν• ν•΄λ…</h1>\n<p>cache()λ” RDDλ¥Ό λ©”λ¨λ¦¬μ— μ €μ¥ν•μ—¬ μ΄ν›„μ μ‘μ—…μ—μ„ λΉ λ¥΄κ² μ ‘κ·Όν•  μ μλ„λ΅ ν‘μ‹ν•λ” λ³€ν™ μ‘μ—…μ…λ‹λ‹¤. μ΄λ” μ¦‰μ‹ κ³„μ‚°μ„ μν–‰ν•μ§€ μ•μΌλ©°, λ‹¨μ§€ RDDκ°€ μµμ΄ κ³„μ‚°μ„ μν–‰ν• ν›„ λ©”λ¨λ¦¬μ— μ μ§€λμ–΄μ•Ό ν•¨μ„ λ‚νƒ€λƒ…λ‹λ‹¤.</p>\n<p>cache()κ°€ ν¨κ³Όλ¥Ό λ°νν•λ” κ²½μ°:</p>\n<!-- TIL μν‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>RDDμ μ‹¤μ  μΊμ‹±μ€ μ•΅μ…μ΄ νΈμ¶λ  λ•μ—λ§ λ°μƒν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μΊμ‹±λ RDDμ— count()μ™€ κ°™μ€ μ•΅μ…μ„ μν–‰ν•λ©΄, Sparkλ” RDDλ¥Ό κ³„μ‚°ν• λ‹¤μ λ―Έλ μ‚¬μ©μ„ μ„ν•΄ λ©”λ¨λ¦¬μ— μ €μ¥ν•©λ‹λ‹¤.</p>\n<pre><code class=\"hljs language-js\">rdd = sc.<span class=\"hljs-title function_\">parallelize</span>([<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">5</span>])\ncached_rdd = rdd.<span class=\"hljs-title function_\">map</span>(lambda <span class=\"hljs-attr\">x</span>: x * <span class=\"hljs-number\">2</span>).<span class=\"hljs-title function_\">cache</span>()  # μ΄κ²ƒμ€ λ³€ν™μ…λ‹λ‹¤\n\n# ν„μ¬κΉμ§€ μ•„μ§ κ³„μ‚°μ΄ λ°μƒν•μ§€λ” μ•μ•μµλ‹λ‹¤.\n\ncount = cached_rdd.<span class=\"hljs-title function_\">count</span>()  # μ΄κ²ƒμ€ μ•΅μ…μΌλ΅ κ³„μ‚° λ° μΊμ‹±μ„ νΈλ¦¬κ±°ν•©λ‹λ‹¤\n</code></pre>\n<h1>μ”μ•½:</h1>\n<ul>\n<li>λ³€ν™(Transformation): cache()λ” λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬μ— μ μ§€ν•¨μΌλ΅μ¨ λ―Έλμ μ•΅μ…μ„ μµμ ν™”ν•λ” λ°©λ²•μ„ Sparkμ— μ•λ ¤μ¤λ‹λ‹¤.</li>\n<li>μ•΅μ…(Action): count(), collect()μ™€ κ°™μ΄ μ‹¤μ  κ³„μ‚°μ„ νΈλ¦¬κ±°ν•λ” λ¨λ“  μ‘μ—…μ€ λ³€ν™(μΊμ‹± ν¬ν•¨)μ΄ μ‹¤ν–‰λλ„λ΅ ν•©λ‹λ‹¤.</li>\n</ul>\n<!-- TIL μν‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>μ΄λ¬ν• ν¬μΈνΈλ¥Ό μ΄ν•΄ν•λ©΄ cache()κ°€ λ³€ν™(transform)μ΄λ©° λ™μ‘(action)μ΄ μ•„λ‹ μ΄μ κ°€ λ…ν™•ν•΄μ§€λ¦¬λΌκ³  μƒκ°ν•΄μ”. cache()λ” λ―Έλ κ³„μ‚°μ„ μµμ ν™”ν•λ” λ° λ„μ›€μ„ μ£Όμ§€λ§ μ§μ ‘μ μΈ κ³„μ‚°μ„ μΌμΌν‚¤μ§€λ” μ•μ•„μ”.</p>\n</body>\n</html>\n"},"__N_SSG":true}