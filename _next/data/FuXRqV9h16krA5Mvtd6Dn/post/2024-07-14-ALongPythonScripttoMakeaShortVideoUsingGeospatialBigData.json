{"pageProps":{"post":{"title":"ì§€ë¦¬ ê³µê°„ ë¹… ë°ì´í„°ë¥¼ í™œìš©í•œ ì§§ì€ ì˜ìƒ ì œì‘ì„ ìœ„í•œ ê¸´ Python ìŠ¤í¬ë¦½íŠ¸","description":"","date":"2024-07-14 19:43","slug":"2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData","content":"\n\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_0.png)\n\n# ëª©ì°¨\n\n- ğŸŒŸ ì†Œê°œ\n- ğŸ” ì„¤ì •: ì„¤ì¹˜ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸\n- â³ \"NetCDF\" íŒŒì¼ì˜ ì¿¼ë¦¬ ë° ì²˜ë¦¬\n- ğŸ—ºï¸ ìº˜ë¦¬í¬ë‹ˆì•„ ì§€ì—­ ë° NDVI ì§€ë„ í”Œë¡œíŒ…ì„ ìœ„í•œ ì´ë¯¸ì§€ í´ë¦¬í•‘\n- ğŸ¥ NDVI ì§€ë„ë¥¼ ë¹„ë””ì˜¤ë¡œ ë‚´ë³´ë‚´ê¸°\n- ğŸ“ ê²°ë¡ \n- ğŸ“š ì°¸ê³  ìë£Œ\n\n## ğŸŒŸ ì†Œê°œ\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì›í•˜ëŠ” ê³³ì—ì„œ ë§¤ì¼ ë˜ëŠ” ë§¤ì£¼ ì´¬ì˜ëœ ìœ„ì„± ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì˜ìƒê³¼ ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“œëŠ” ê²ƒì„ ì¦ê¸°ë©° ëŒ€ê·œëª¨ ì§€ë¦¬ ê³µê°„ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ëŠ” ì¼ì— ê¹Šì€ ì—´ì •ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ë§ì€ ì–‘ì˜ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ë‹¤ìš´ë¡œë“œ, í´ë¦¬í•‘, ìœ„ì„± ì´ë¯¸ì§€ í‘œì‹œ ë“±ì˜ ë‹¨ê³„ë¥¼ ê±°ì¹˜ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ë§ì´ ê±¸ë¦½ë‹ˆë‹¤. ì´ ê³¼ì •ì—ëŠ” API, ì½”ë”©, ì§€ë¦¬ ë°ì´í„°ì— ëŒ€í•œ ì‹¬ë„ ìˆëŠ” ì´í•´, ë°ì´í„° ì‹œê°í™”ì— ëŒ€í•œ ë›°ì–´ë‚œ ê¸°ìˆ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ì´ì•¼ê¸°ëŠ” 'ìœ„ì— ì–¸ê¸‰ëœ ëª¨ë“ ' ê¸°ìˆ ì˜ ì¡°í•©ì— ê´€í•œ ê²ƒì…ë‹ˆë‹¤.\n\në‹¤ë¥¸ ê²Œì‹œë¬¼ì—ì„œ Sentinel-2 ë° Sentinel-3 ì´ë¯¸ì§€ì˜ ì‹œê°í™”ì— ëŒ€í•´ ì‘ì„±í•˜ë˜ ì¤‘, ì´ ì¤‘ í•˜ë‚˜ì˜ ìœ„ì„±ì´ íŠ¹ì • ìœ„ì¹˜ ìœ„ì—ì„œ ì´¬ì˜í•œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ëª¨ì•„ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì œì‹œí•˜ëŠ” ì•„ì´ë””ì–´ì— ì£¼ëª©í–ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ì´ ë¹„ì „ì„ ì‹¤í˜„í•˜ê³  2023ë…„ ìº˜ë¦¬í¬ë‹ˆì•„ ìœ„ì—ì„œ ìº¡ì²˜ëœ Sentinel-3ì˜ NDVI ë§µì„ íƒìƒ‰í•´ë³´ëŠ” ë‚ ì…ë‹ˆë‹¤!\n\nì´ ì´ì•¼ê¸°ì—ì„œëŠ” ì´ëŸ¬í•œ NDVI ë§µì„ ì²˜ë¦¬, ì‹œê°í™”í•˜ê³  ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ê¸° ìœ„í•´ Google Colabì—ì„œ ê°•ë ¥í•œ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ê²ƒì…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë¶€ë¶„ì„ ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¯¸ ë³„ë„ì˜ ì´ì•¼ê¸°ì—ì„œ ìì„¸íˆ ë‹¤ë£¨ì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n## ğŸ” ì„¤ì •: ì„¤ì¹˜ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” ë‹¤ìŒ í´ë”ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤: NetCDF, Geotiff, Geotiff_reproj, Geotiff_reproj_clipped, Shapefile, JPEG ë° Animation. ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nimport os\n\n# í´ë” ì´ë¦„ ì •ì˜\nfolders = ['NetCDF', 'Geotiff', 'Geotiff_reproj', 'Geotiff_reproj_clipped', 'Shapefile', 'JPEG', 'Animation']\n\n# í´ë” ìƒì„±\nfor folder in folders:\n    if not os.path.exists(folder):\n        os.makedirs(folder)\n\n# í™•ì¸ ë©”ì‹œì§€ ì¶œë ¥\nprint('í´ë”ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!')\n```\n\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_1.png\" />\n\nNetCDF í´ë”ëŠ” Sentinel-3 NDVIì˜ raw ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì¶”ê°€ë¡œ, Geotiff, Geotiff_reproj, Geotiff_reproj_clipped í´ë”ëŠ” ë˜ìŠ¤í„° íŒŒì¼, ì¬íˆ¬ì˜ëœ ë˜ìŠ¤í„° íŒŒì¼ ë° ë˜ìŠ¤í„° íŒŒì¼ í´ë¦½ì„ GeoTIFF í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ìƒì„±ë©ë‹ˆë‹¤ (ëª¨ë‘ NetCDF íŒŒì¼ì—ì„œ ë³€í™˜ëœ í˜•ì‹). Shapefile í´ë”ì—ëŠ” ìº˜ë¦¬í¬ë‹ˆì•„ í˜•íƒœ íŒŒì¼(ìš°ë¦¬ì˜ ê´€ì‹¬ ì˜ì—­(AOI)ë¡œ Sentinel-3 ì´ë¯¸ì§€ í´ë¦¬í•‘ì„ ìœ„í•´)ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. JPEG í´ë”ëŠ” NDVI ë§µì„ \".jpg\" í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ìƒì„±ë˜ë©°, Animation í´ë”ëŠ” ìµœì¢… ë¹„ë””ì˜¤ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në˜í•œ, Google Colabì— ëª‡ ê°€ì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤.\n\n```js\npip install pandas rasterio netCDF4 rioxarray\n```\n\n```js\nimport os\nimport re\nimport sys\nimport random\nfrom pathlib import Path\n\nimport requests\nimport json\nimport xml.etree.ElementTree as ET\nimport certifi\n\nimport pandas as pd\nimport numpy as np\n\nimport rasterio\nimport matplotlib.pyplot as plt\nimport matplotlib.image\nfrom rasterio.windows import Window\n\nimport netCDF4 as nc\n\nimport rioxarray\n\nfrom rasterio.control import GroundControlPoint\n```\n\n## â³ \"NetCDF\" íŒŒì¼ì˜ ì¿¼ë¦¬ ë° ì²˜ë¦¬\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në‹¤ìŒ ë‹¨ê³„ëŠ” ì¿¼ë¦¬ë¥¼ ì œì¶œí•˜ê³  ì‹œì‘ ë‚ ì§œ, ì¢…ë£Œ ë‚ ì§œ ë° AOIë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. NDVI ì§€ë„ëŠ” í† ì–‘ í‘œë©´ ì˜¨ë„ ìˆ˜ì¤€ì˜ ë¶€ìˆ˜ ë°ì´í„°ì´ë¯€ë¡œ, ì—¬ì „íˆ ë ˆë²¨ ë³€ìˆ˜ë¡œ \"LST\"ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¯¸êµ­ì˜ ë‹¤ë¥¸ ì£¼ì— ëŒ€í•œ ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´, AOI ì§€ì ì´ë‚˜ í´ë¦¬ê³¤ì„ í•´ë‹¹í•˜ë„ë¡ ìˆ˜ì •í•˜ì„¸ìš”. ë˜í•œ, ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¡œ 2023ë…„ 5ì›” 1ì¼ ë° 8ì›” 1ì¼ì„ ê³ ë ¤í•´ë³´ì„¸ìš”. ë‹¤ìŒê³¼ ê°™ì€ ì¤„ë¡œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nurl_dataspace = \"https://catalogue.dataspace.copernicus.eu/odata/v1\"\n\n# í•„í„°ë§\nsatellite = \"SENTINEL-3\"\nlevel= \"LST\"\n\naoi_point =\"POINT(-121.669668 38.372428)\"\n#aoi_polygon = \"POLYGON ((-121.0616 37.6391, -120.966 37.6391, -120.966 37.6987, -121.0616 37.6987, -121.0616 37.6391))\"\n\nstart_date = \"2023-05-01\"\nend_date = \"2023-08-01\"\nstart_date_full =start_date+\"T00:00:00.000Z\"\nend_date_full = end_date +\"T00:00:00.000Z\"\n```\n\nì´ ì •ë³´ë¥¼ í†µí•´ ì¿¼ë¦¬ë¥¼ ì œì¶œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ëª©ë¡ì„ ë‚´ë³´ë‚´ì•¼ í•˜ë¯€ë¡œ, ì¿¼ë¦¬ ëì— \"&$top=1000&$expand=Attributes\"ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°ì˜ ê¸°ë³¸ ìˆ˜ê°€ 20ì´ë©°, 2023ë…„ì— Sentinel-3ê°€ ì´¬ì˜í•œ ì´ë¯¸ì§€ ìˆ˜ê°€ 20ì„ ì´ˆê³¼í•˜ê¸° ë•Œë¬¸ì— í•„ìš”í•©ë‹ˆë‹¤:\n\n```js\nquery = f\"{url_dataspace}/Products?$filter=Collection/Name eq '{satellite}' and Attributes/OData.CSC.StringAttribute/any(att:att/Name eq 'productType' and att/OData.CSC.StringAttribute/Value eq '{level}') and OData.CSC.Intersects(area=geography'SRID=4326;{aoi_point}') and ContentDate/Start gt {start_date_full} and ContentDate/Start lt {end_date_full}&$top=1000&$expand=Attributes\"\nresponse = requests.get(query).json()\nresult = pd.DataFrame.from_dict(response[\"value\"])\n\n# 'Online' ì—´ì´ Trueì¸ ë ˆì½”ë“œ í•„í„°ë§\nresult = result[result['Online'] == True]\n\n# ì²˜ìŒ 10ê°œ ê²°ê³¼ ì¶œë ¥\nresult.head(10)\n\nresult.to_csv('result_LST.csv', index=False)\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në‹¤ìŒ ë‹¨ê³„ì—ì„œëŠ” ì˜¨ë¼ì¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ëª©ë¡ì„ í•„í„°ë§í•˜ì—¬ ì •ì˜¤ì¯¤ ì´¬ì˜ëœ ì´ë¯¸ì§€ì— íŠ¹íˆ ì£¼ëª©í•  ê²ƒì…ë‹ˆë‹¤. íŒŒì¼ì˜ ê°ì§€ ì‹œê°„ì€ UTMì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì— 18:00:00ì€ íƒœí‰ì–‘ í‘œì¤€ì‹œ (ìº˜ë¦¬í¬ë‹ˆì•„ ì‹œê°„) ê¸°ì¤€ìœ¼ë¡œ ëŒ€ëµ 12:00:00 ì˜¤í›„ì— í•´ë‹¹í•©ë‹ˆë‹¤:\n\n```js\nfiltered_df = result[result[\"Name\"].str.split(\"_\").str[8].str.contains(\"T18\") & result[\"Name\"].str.split(\"_\").str[14].str.contains(\"PS2\") & result[\"Name\"].str.split(\"_\").str[16].str.contains(\"NT\")]\n\nfiltered_df = filtered_df.reset_index(drop=True)\n\nprint(filtered_df['Name'])\n```\n\n```js\nfiltered_df.to_csv('result_LST_Filtered.csv', index=False)\n```\n\ní•„í„°ë§ëœ ë°ì´í„°í”„ë ˆì„ì„ ê¸°ë°˜ìœ¼ë¡œ, 2023ë…„ 5ì›” 1ì¼ë¶€í„° 8ì›” 1ì¼ê¹Œì§€ ìº˜ë¦¬í¬ë‹ˆì•„ ìƒê³µì—ì„œ ì´¬ì˜ëœ Sentinel-3ì˜ 53ì¥ì˜ ì´ë¯¸ì§€ê°€ ìˆìŠµë‹ˆë‹¤.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_2.png\" />\n\nì´ë¯¸ì§€ê°€ íë¦¿í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê¸°ì–µí•˜ì„¸ìš”. ì„¼í‹°ë„¬-3 ì´ë¯¸ì§€ë¥¼ êµ¬ë¦„ ë®ê°œë¡œ ê±¸ëŸ¬ë‚´ëŠ” ê²ƒì„ ì œì–´í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\n\në‹¤ìŒ ë‹¨ê³„ëŠ” í•„í„°ë§ëœ ëª©ë¡ì˜ ì œí’ˆ IDë¥¼ ì‚¬ìš©í•˜ì—¬ NetCDF íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ì´ë¯¸ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì˜ ì„¹ì…˜ë“¤(ğŸ“¥ \"NetCDF\" íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ğŸ› ï¸ Geotiffë¡œ ë³€í™˜)ì—ì„œ ì„¤ëª…ëœ ìë£Œì˜ ì¤‘ë³µì„ í”¼í•˜ê¸° ìœ„í•´ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤:\n\n## ğŸ—ºï¸ ìº˜ë¦¬í¬ë‹ˆì•„ë¥¼ ìœ„í•œ ì´ë¯¸ì§€ í´ë¦¬í•‘ê³¼ NDVI ì§€ë„ í”Œë¡œíŒ…\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì´ ë‹¨ê³„ë¥¼ ìì„¸íˆ ì„¤ëª…í•˜ê¸° ì „ì— ë‹¤ìŒ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê³  ë¡œë“œí•´ì£¼ì„¸ìš”:\n\n```js\npip install matplotlib-scalebar\n```\n\n```js\nimport os\nimport matplotlib.pyplot as plt\nfrom matplotlib import colors\nfrom mpl_toolkits.axes_grid1 import make_axes_locatable\nfrom mpl_toolkits.axes_grid1.inset_locator import inset_axes\nfrom matplotlib_scalebar.scalebar import ScaleBar\nfrom matplotlib.offsetbox import OffsetImage, AnnotationBbox\nfrom datetime import datetime\nimport rasterio.plot\n```\n\nì´ ë‹¨ê³„ì—ì„œëŠ” Geotiff_reproj í´ë”ì— ì €ì¥ëœ 53ê°œì˜ ë˜ìŠ¤í„° íŒŒì¼ ê°ê°ì„ ì½ì–´ì˜¬ ê²ƒì…ë‹ˆë‹¤. ìº˜ë¦¬í¬ë‹ˆì•„ ì‰ì´í”„íŒŒì¼ íˆ¬ì˜ê³¼ ë˜ìŠ¤í„° íŒŒì¼ ê°„ì˜ ì¼ê´€ì„±ì„ í™•ì¸í•  ê²ƒì…ë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° ì‰ì´í”„íŒŒì¼ì„ ì¬íˆ¬ì˜í•  ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ë˜ìŠ¤í„° íŒŒì¼ì„ ìº˜ë¦¬í¬ë‹ˆì•„ì˜ ê²½ê³„ì— ë§ê²Œ ìë¦…ë‹ˆë‹¤. í•´ë‹¹ í”Œë¡¯ì„ í”Œë¡œíŒ…í•˜ê³  JPEG í´ë”ì— ì €ì¥í•  ê²ƒì…ë‹ˆë‹¤. ìº˜ë¦¬í¬ë‹ˆì•„ ì‰ì´í”„íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´ ë‹¤ìŒ URLì„ ë°©ë¬¸í•˜ì—¬ \"California State Boundry\"ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  Shapefile í´ë”ì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”:\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n[California Geographic Boundaries](https://data.ca.gov/dataset/ca-geographic-boundaries)\n\n![Image](/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_3.png)\n\nThe following code also requires an image for the north arrow symbol. You can either download one from the internet or, like me, draw it in PowerPoint, save it, and upload it to your main folder.\n\n![Image](/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_4.png)\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në§µì— ì´ ì•„ì´ì½˜ì´ í‘œì‹œë˜ëŠ” ê²ƒì€ ì™„ì „íˆ ì„ íƒ ì‚¬í•­ì…ë‹ˆë‹¤. ë§µì— ë¶ìª½ í™”ì‚´í‘œë¥¼ í‘œì‹œí•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´ í•´ë‹¹ ì„¹ì…˜ì„ ì£¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n# ë””ë ‰í† ë¦¬ ê²½ë¡œ ì„¤ì •\ndirectory = '/content/Geotiff_reproj_clipped/'\n\n\n# ë””ë ‰í† ë¦¬ ë‚´ ëª¨ë“  íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\nfiles = os.listdir(directory)\n\n# NDVI TIF íŒŒì¼ë§Œ í¬í•¨í•˜ëŠ” ëª©ë¡ í•„í„°ë§\nndvi_files = [f for f in files if f.endswith('.tif')]\n\n\n# ìƒ‰ìƒ í•œê³„ ì„¤ì •\nvmin = 0\nvmax = 1\nndvi_norm = colors.Normalize(vmin, vmax)\nndvi_cmap = plt.cm.RdYlGn\nndvi_cmap.set_bad(color='white')\n\n# ê°ê°ì˜ NDVI íŒŒì¼ì„ ë£¨í”„í•˜ì—¬ í”Œë¡¯í•˜ê¸°\nfor ndvi_file in ndvi_files:\n    print(ndvi_file)\n    date_str = ndvi_file.split('_')[0]\n    date_obj = datetime.strptime(date_str, \"%Y%m%d\")\n    formatted_date_str = date_obj.strftime(\"%Y/%-m/%-d\")\n\n    # NDVI ë˜ìŠ¤í„° ì—´ê¸°\n    with rasterio.open(f\"/content/Geotiff_reproj_clipped/{ndvi_file}\") as ndvi:\n      # shapefile ì½ê¸°\n      california_shapefile = gpd.read_file('/content/Shapefile/CA_State_TIGER2016.shp')\n\n      ndvi_data = ndvi.read(1).astype(float)\n      ndvi_data[ndvi_data<=-1]=np.nan\n      ndvi_crs = ndvi.crs\n      extent = rasterio.plot.plotting_extent(ndvi)\n\n      # shapefileì„ ë˜ìŠ¤í„°ì˜ íˆ¬ì˜ê³¼ ì¼ì¹˜í•˜ë„ë¡ ì¬íˆ¬ì˜\n      california_shapefile = california_shapefile.to_crs(ndvi_crs)\n\n\n    # í”Œë¡¯ ìƒì„±\n    fig, ax = plt.subplots(figsize=(10, 6))\n\n    \n    image= rasterio.plot.show(ndvi_data, ax=ax, extent=extent, alpha=1, cmap=ndvi_cmap,norm=ndvi_norm,)\n    im = image.get_images()[0]  # ì»¬ëŸ¬ë°”ì— ëŒ€í•œ íŠ¸ë¦­ (rasterio.plot.showì™€ í˜¸í™˜ë˜ì§€ ì•ŠìŒ)\n    fig.colorbar(im, ax=ax)\n   \n\n    ax.set_title(formatted_date_str, fontsize=16,fontweight='bold')\n    california_shapefile.boundary.plot(ax=ax, color='k', linewidth=1)\n\n    ax.set_xticklabels([])\n    ax.set_yticklabels([])\n\n    # ë¶ìª½ í™”ì‚´í‘œ ì¶”ê°€\n    north_arrow_image = plt.imread('North_sign.png')\n    imagebox = OffsetImage(north_arrow_image, zoom=0.25)\n    ab = AnnotationBbox(imagebox, (0.8, 0.99), xycoords='axes fraction', box_alignment=(0, 1), frameon=False)\n    ax.add_artist(ab)\n\n    # ìŠ¤ì¼€ì¼ ë°” ì¶”ê°€\n    scalebar = ScaleBar(1000, 'm', length_fraction=0.2, location='lower right', font_properties={'size':12})\n    ax.add_artist(scalebar)\n\n    # ë§µ ì£¼ë³€ì— ë„¤ëª¨ ìƒì ë„ê¸°\n    ax.axis('off')\n\n    # í”Œë¡¯ì„ JPEG íŒŒì¼ë¡œ ì €ì¥\n    plt.savefig(os.path.join('/content/JPEG', ndvi_file.split('_')[0] + '.jpg'), dpi=300, bbox_inches='tight')\n\n    # ë©”ëª¨ë¦¬ í•´ì œë¥¼ ìœ„í•´ í”Œë¡¯ ë‹«ê¸°\n    plt.close(fig)\r\n```\n\nì´ ë‹¨ê³„ë¥¼ ì™„ë£Œí•˜ë©´ \"JPEG\" í´ë”ì— ì„¼ì‹± ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì €ì¥ëœ 53ê°œì˜ NDVI ì§€ë„ê°€ ìˆê²Œ ë  ê²ƒì…ë‹ˆë‹¤:\n\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_5.png\" />\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## ğŸ¥ NDVI ì§€ë„ë¥¼ ë¹„ë””ì˜¤ë¡œ ë‚´ë³´ë‚´ê¸°\n\n3ê°œì›” ë™ì•ˆ ì„¼í‹°ë„¬-3ì— ì˜í•´ ì´¬ì˜ëœ 53ê°œì˜ NDVI ì§€ë„(ëŒ€ëµ ë§¤ 2ì¼ë§ˆë‹¤ 1ì¥ì”©)ë¥¼ ì‚¬ìš©í•˜ì—¬, 2023ë…„ ìº˜ë¦¬í¬ë‹ˆì•„ ì§€ì—­ ì „ì²´ì˜ NDVI íŒ¨í„´ê³¼ ë³€í™”ë¥¼ ë³´ì—¬ì£¼ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¹„ë””ì˜¤ë¥¼ ìƒì„±í•˜ë ¤ë©´, ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:\n\n```js\npip install pillow\n```\n\n```js\nfrom PIL import Image\nimport os\nimport glob\n\n# 'path/to/folder'ë¥¼ ì—¬ëŸ¬ë¶„ì˜ jpg ì´ë¯¸ì§€ê°€ ì €ì¥ëœ í´ë” ê²½ë¡œë¡œ êµì²´í•˜ì„¸ìš”\nfolder_path = '/content/JPEG'\noutput_gif = os.path.join('/content/Animation', 'NDVI_animation.gif')\n\n# í´ë” ë‚´ ëª¨ë“  jpg íŒŒì¼ì˜ ì •ë ¬ëœ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤\nfile_list = sorted(glob.glob(os.path.join(folder_path, '*.jpg')))\n\n# ì´ë¯¸ì§€ì˜ ì›í•˜ëŠ” í¬ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤\nwidth, height = 1000, 1000\n\n# ì´ë¯¸ì§€ë¥¼ ì½ì–´ì„œ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥í•©ë‹ˆë‹¤\nframes = []\nfor file in file_list:\n    frame = Image.open(file)\n\n    # ì´ë¯¸ì§€ í¬ê¸° ì¡°ì •\n    frame = frame.resize((width, height), Image.ANTIALIAS)\n\n    # ì´ë¯¸ì§€ì— í°ìƒ‰ ë°°ê²½ ì¶”ê°€\n    background = Image.new('RGB', frame.size, (255, 255, 255))\n    background.paste(frame)\n    frame = background.convert('RGB')\n\n    # ì´ë¯¸ì§€ë¥¼ P ëª¨ë“œë¡œ ë³€í™˜í•˜ê³  ì „ì—­ ìƒ‰ìƒ í…Œì´ë¸”ì„ ì‚¬ìš©í•©ë‹ˆë‹¤\n    frame = frame.convert('P', palette=Image.ADAPTIVE, colors=256)\n    frames.append(frame)\n\n# ì• ë‹ˆë©”ì´ì…˜ GIFë¡œ í”„ë ˆì„ì„ ì €ì¥í•©ë‹ˆë‹¤\nif frames:\n    frames[0].save(\n        output_gif,\n        save_all=True,\n        append_images=frames[1:],\n        duration=500,  # í”„ë ˆì„ ê°„ ì§€ì† ì‹œê°„(ë°€ë¦¬ì´ˆ)ì„ ì„¤ì •í•©ë‹ˆë‹¤\n        loop=0,  # ë£¨í”„ íšŸìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤ (0ì€ ë¬´í•œì„ ì˜ë¯¸í•©ë‹ˆë‹¤)\n        optimize=True,\n    )\nelse:\n    print(\"jpg íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\")\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì‘ì—…ì´ ì™„ë£Œë˜ë©´ í™”ë©´ì—ì„œ ë§Œë“¤ì–´ì§„ ì§€í¼ ì˜ìƒì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‹œì²­í•  ìˆ˜ ìˆì–´ìš”!\n\n![ì´ë¯¸ì§€](https://miro.medium.com/v2/resize:fit:1000/1*B8CQ1b8hgqEPrGj33oxrzQ.gif)\n\nêµ¬ë¦„ì´ ê°€ë ¤ì ¸ ìˆê¸° ë•Œë¬¸ì— ì§€ë„ ë‚´ ëª‡ êµ°ë°ëŠ” í°ìƒ‰ ì˜ì—­ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë˜í•œ íŠ¹ì • ë‚ ì§œì— ìº˜ë¦¬í¬ë‹ˆì•„ì˜ ëª¨ë“  ì˜ì—­ì„ ì»¤ë²„í•˜ì§€ ì•Šì•„ ì¼ë¶€ ì´ë¯¸ì§€ê°€ ì˜ë ¤ ë‚˜ì™€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë ˆì„ì´ ë„ˆë¬´ ë¹¨ë¦¬ ë³€ê²½ë˜ëŠ” ê²ƒ ê°™ë‹¤ë©´, ê° í”„ë ˆì„ ê°„ì˜ ì§€ì† ì‹œê°„ì„ ì¡°ì ˆí•  ìˆ˜ ìˆì–´ìš”. ê¸´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œ í›„ì—ëŠ” ì´ ì•„ë¦„ë‹¤ìš´ ì§§ì€ ì• ë‹ˆë©”ì´ì…˜ì„ ì¦ê¸°ì‹œê¸° ë°”ëë‹ˆë‹¤.\n\n## ğŸ“ ê²°ë¡ \n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nìš”ì•½í•˜ìë©´, ìƒìƒë ¥ì„ ë°ì´í„° ì‹œê°í™”ì™€ ì½”ë”©ì„ í†µí•´ í˜„ì‹¤í™”í•˜ëŠ” ê²ƒì€ ë•Œë¡œëŠ” ê½¤ ë§ì€ ì‹œê°„ì„ ì†Œìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì´ì•¼ê¸°ì—ì„œëŠ” 50ì´ˆì§œë¦¬ ë¹„ë””ì˜¤ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ 300ì¤„ ì´ìƒì˜ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ìƒë‹¹í•œ ì‹œê°„ íˆ¬ìì—ë„ ë¶ˆêµ¬í•˜ê³ , ê·¸ ë…¸ë ¥ì€ ê°€ì¹˜ê°€ ìˆë‹¤ê³  ë¯¿ìŠµë‹ˆë‹¤. ì§€ë„ì˜ ìˆœì°¨ì ì¸ í‘œí˜„ì€ ìˆ¨ê²¨ì§„ íŒ¨í„´ê³¼ ë™ì  ë³€í™”ë¥¼ ë“œëŸ¬ë‚´ë©° ë” ë§ì€ íƒêµ¬ë¥¼ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ ì´ì•¼ê¸°ì—ì„œëŠ” 6ì›” ì´ì „ì˜ NDVI ë³€ë™ì„± ê´€ì¸¡ê³¼ 6ì›” ì¤‘ìˆœë¶€í„° 7ì›”ê¹Œì§€ ì•ˆì •í™”ëœ ëª¨ìŠµì´ ìš°ë¦¬ì—ê²Œ ì¶”ê°€ì ì¸ ì§ˆë¬¸ì„ ë˜ì§€ë©° ë” ë§ì€ ì¡°ì‚¬ì™€ ë‹µì„ ë°œê²¬í•˜ë„ë¡ ë™ê¸°ë¶€ì—¬í•©ë‹ˆë‹¤.\n\n## ğŸ“š ì°¸ê³  ìë£Œ\n\nhttps://documentation.dataspace.copernicus.eu/APIs/OData.html\n\n- ğŸ“± ë” ë§ì€ ìƒí˜¸ì‘ìš©ì´ ìˆëŠ” ì½˜í…ì¸ ë¥¼ ìœ„í•´ ë‹¤ë¥¸ í”Œë«í¼ì—ì„œ ì €ì™€ ì—°ê²°í•˜ì„¸ìš”! LinkedIn, ResearchGate, Github, ê·¸ë¦¬ê³  Twitter.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\ní•´ë‹¹ ë§í¬ë¥¼ í†µí•´ ê´€ë ¨ ê²Œì‹œë¬¼ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:","ogImage":{"url":"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_0.png"},"coverImage":"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_0.png","tag":["Tech"],"readingTime":15},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p><img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_0.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<h1>ëª©ì°¨</h1>\n<ul>\n<li>ğŸŒŸ ì†Œê°œ</li>\n<li>ğŸ” ì„¤ì •: ì„¤ì¹˜ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸</li>\n<li>â³ \"NetCDF\" íŒŒì¼ì˜ ì¿¼ë¦¬ ë° ì²˜ë¦¬</li>\n<li>ğŸ—ºï¸ ìº˜ë¦¬í¬ë‹ˆì•„ ì§€ì—­ ë° NDVI ì§€ë„ í”Œë¡œíŒ…ì„ ìœ„í•œ ì´ë¯¸ì§€ í´ë¦¬í•‘</li>\n<li>ğŸ¥ NDVI ì§€ë„ë¥¼ ë¹„ë””ì˜¤ë¡œ ë‚´ë³´ë‚´ê¸°</li>\n<li>ğŸ“ ê²°ë¡ </li>\n<li>ğŸ“š ì°¸ê³  ìë£Œ</li>\n</ul>\n<h2>ğŸŒŸ ì†Œê°œ</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ì›í•˜ëŠ” ê³³ì—ì„œ ë§¤ì¼ ë˜ëŠ” ë§¤ì£¼ ì´¬ì˜ëœ ìœ„ì„± ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì˜ìƒê³¼ ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“œëŠ” ê²ƒì„ ì¦ê¸°ë©° ëŒ€ê·œëª¨ ì§€ë¦¬ ê³µê°„ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ëŠ” ì¼ì— ê¹Šì€ ì—´ì •ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ë§ì€ ì–‘ì˜ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ë‹¤ìš´ë¡œë“œ, í´ë¦¬í•‘, ìœ„ì„± ì´ë¯¸ì§€ í‘œì‹œ ë“±ì˜ ë‹¨ê³„ë¥¼ ê±°ì¹˜ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ë§ì´ ê±¸ë¦½ë‹ˆë‹¤. ì´ ê³¼ì •ì—ëŠ” API, ì½”ë”©, ì§€ë¦¬ ë°ì´í„°ì— ëŒ€í•œ ì‹¬ë„ ìˆëŠ” ì´í•´, ë°ì´í„° ì‹œê°í™”ì— ëŒ€í•œ ë›°ì–´ë‚œ ê¸°ìˆ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ì´ì•¼ê¸°ëŠ” 'ìœ„ì— ì–¸ê¸‰ëœ ëª¨ë“ ' ê¸°ìˆ ì˜ ì¡°í•©ì— ê´€í•œ ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ë‹¤ë¥¸ ê²Œì‹œë¬¼ì—ì„œ Sentinel-2 ë° Sentinel-3 ì´ë¯¸ì§€ì˜ ì‹œê°í™”ì— ëŒ€í•´ ì‘ì„±í•˜ë˜ ì¤‘, ì´ ì¤‘ í•˜ë‚˜ì˜ ìœ„ì„±ì´ íŠ¹ì • ìœ„ì¹˜ ìœ„ì—ì„œ ì´¬ì˜í•œ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ëª¨ì•„ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì œì‹œí•˜ëŠ” ì•„ì´ë””ì–´ì— ì£¼ëª©í–ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ì´ ë¹„ì „ì„ ì‹¤í˜„í•˜ê³  2023ë…„ ìº˜ë¦¬í¬ë‹ˆì•„ ìœ„ì—ì„œ ìº¡ì²˜ëœ Sentinel-3ì˜ NDVI ë§µì„ íƒìƒ‰í•´ë³´ëŠ” ë‚ ì…ë‹ˆë‹¤!</p>\n<p>ì´ ì´ì•¼ê¸°ì—ì„œëŠ” ì´ëŸ¬í•œ NDVI ë§µì„ ì²˜ë¦¬, ì‹œê°í™”í•˜ê³  ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ê¸° ìœ„í•´ Google Colabì—ì„œ ê°•ë ¥í•œ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ê²ƒì…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë¶€ë¶„ì„ ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¯¸ ë³„ë„ì˜ ì´ì•¼ê¸°ì—ì„œ ìì„¸íˆ ë‹¤ë£¨ì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<h2>ğŸ” ì„¤ì •: ì„¤ì¹˜ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” ë‹¤ìŒ í´ë”ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤: NetCDF, Geotiff, Geotiff_reproj, Geotiff_reproj_clipped, Shapefile, JPEG ë° Animation. ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> os\n\n# í´ë” ì´ë¦„ ì •ì˜\nfolders = [<span class=\"hljs-string\">'NetCDF'</span>, <span class=\"hljs-string\">'Geotiff'</span>, <span class=\"hljs-string\">'Geotiff_reproj'</span>, <span class=\"hljs-string\">'Geotiff_reproj_clipped'</span>, <span class=\"hljs-string\">'Shapefile'</span>, <span class=\"hljs-string\">'JPEG'</span>, <span class=\"hljs-string\">'Animation'</span>]\n\n# í´ë” ìƒì„±\n<span class=\"hljs-keyword\">for</span> folder <span class=\"hljs-keyword\">in</span> <span class=\"hljs-attr\">folders</span>:\n    <span class=\"hljs-keyword\">if</span> not os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">exists</span>(folder):\n        os.<span class=\"hljs-title function_\">makedirs</span>(folder)\n\n# í™•ì¸ ë©”ì‹œì§€ ì¶œë ¥\n<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">'í´ë”ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!'</span>)\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_1.png\">\n<p>NetCDF í´ë”ëŠ” Sentinel-3 NDVIì˜ raw ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì¶”ê°€ë¡œ, Geotiff, Geotiff_reproj, Geotiff_reproj_clipped í´ë”ëŠ” ë˜ìŠ¤í„° íŒŒì¼, ì¬íˆ¬ì˜ëœ ë˜ìŠ¤í„° íŒŒì¼ ë° ë˜ìŠ¤í„° íŒŒì¼ í´ë¦½ì„ GeoTIFF í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ìƒì„±ë©ë‹ˆë‹¤ (ëª¨ë‘ NetCDF íŒŒì¼ì—ì„œ ë³€í™˜ëœ í˜•ì‹). Shapefile í´ë”ì—ëŠ” ìº˜ë¦¬í¬ë‹ˆì•„ í˜•íƒœ íŒŒì¼(ìš°ë¦¬ì˜ ê´€ì‹¬ ì˜ì—­(AOI)ë¡œ Sentinel-3 ì´ë¯¸ì§€ í´ë¦¬í•‘ì„ ìœ„í•´)ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. JPEG í´ë”ëŠ” NDVI ë§µì„ \".jpg\" í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ìƒì„±ë˜ë©°, Animation í´ë”ëŠ” ìµœì¢… ë¹„ë””ì˜¤ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ë˜í•œ, Google Colabì— ëª‡ ê°€ì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\">pip install pandas rasterio netCDF4 rioxarray\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> re\n<span class=\"hljs-keyword\">import</span> sys\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> pathlib <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Path</span>\n\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> xml.<span class=\"hljs-property\">etree</span>.<span class=\"hljs-property\">ElementTree</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable constant_\">ET</span>\n<span class=\"hljs-keyword\">import</span> certifi\n\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n\n<span class=\"hljs-keyword\">import</span> rasterio\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">pyplot</span> <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">image</span>\n<span class=\"hljs-keyword\">from</span> rasterio.<span class=\"hljs-property\">windows</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Window</span>\n\n<span class=\"hljs-keyword\">import</span> netCDF4 <span class=\"hljs-keyword\">as</span> nc\n\n<span class=\"hljs-keyword\">import</span> rioxarray\n\n<span class=\"hljs-keyword\">from</span> rasterio.<span class=\"hljs-property\">control</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">GroundControlPoint</span>\n</code></pre>\n<h2>â³ \"NetCDF\" íŒŒì¼ì˜ ì¿¼ë¦¬ ë° ì²˜ë¦¬</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ë‹¤ìŒ ë‹¨ê³„ëŠ” ì¿¼ë¦¬ë¥¼ ì œì¶œí•˜ê³  ì‹œì‘ ë‚ ì§œ, ì¢…ë£Œ ë‚ ì§œ ë° AOIë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. NDVI ì§€ë„ëŠ” í† ì–‘ í‘œë©´ ì˜¨ë„ ìˆ˜ì¤€ì˜ ë¶€ìˆ˜ ë°ì´í„°ì´ë¯€ë¡œ, ì—¬ì „íˆ ë ˆë²¨ ë³€ìˆ˜ë¡œ \"LST\"ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¯¸êµ­ì˜ ë‹¤ë¥¸ ì£¼ì— ëŒ€í•œ ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´, AOI ì§€ì ì´ë‚˜ í´ë¦¬ê³¤ì„ í•´ë‹¹í•˜ë„ë¡ ìˆ˜ì •í•˜ì„¸ìš”. ë˜í•œ, ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¡œ 2023ë…„ 5ì›” 1ì¼ ë° 8ì›” 1ì¼ì„ ê³ ë ¤í•´ë³´ì„¸ìš”. ë‹¤ìŒê³¼ ê°™ì€ ì¤„ë¡œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">url_dataspace = <span class=\"hljs-string\">\"https://catalogue.dataspace.copernicus.eu/odata/v1\"</span>\n\n# í•„í„°ë§\nsatellite = <span class=\"hljs-string\">\"SENTINEL-3\"</span>\nlevel= <span class=\"hljs-string\">\"LST\"</span>\n\naoi_point =<span class=\"hljs-string\">\"POINT(-121.669668 38.372428)\"</span>\n#aoi_polygon = <span class=\"hljs-string\">\"POLYGON ((-121.0616 37.6391, -120.966 37.6391, -120.966 37.6987, -121.0616 37.6987, -121.0616 37.6391))\"</span>\n\nstart_date = <span class=\"hljs-string\">\"2023-05-01\"</span>\nend_date = <span class=\"hljs-string\">\"2023-08-01\"</span>\nstart_date_full =start_date+<span class=\"hljs-string\">\"T00:00:00.000Z\"</span>\nend_date_full = end_date +<span class=\"hljs-string\">\"T00:00:00.000Z\"</span>\n</code></pre>\n<p>ì´ ì •ë³´ë¥¼ í†µí•´ ì¿¼ë¦¬ë¥¼ ì œì¶œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ëª©ë¡ì„ ë‚´ë³´ë‚´ì•¼ í•˜ë¯€ë¡œ, ì¿¼ë¦¬ ëì— \"&#x26;$top=1000&#x26;$expand=Attributes\"ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°ì˜ ê¸°ë³¸ ìˆ˜ê°€ 20ì´ë©°, 2023ë…„ì— Sentinel-3ê°€ ì´¬ì˜í•œ ì´ë¯¸ì§€ ìˆ˜ê°€ 20ì„ ì´ˆê³¼í•˜ê¸° ë•Œë¬¸ì— í•„ìš”í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">query = f<span class=\"hljs-string\">\"{url_dataspace}/Products?$filter=Collection/Name eq '{satellite}' and Attributes/OData.CSC.StringAttribute/any(att:att/Name eq 'productType' and att/OData.CSC.StringAttribute/Value eq '{level}') and OData.CSC.Intersects(area=geography'SRID=4326;{aoi_point}') and ContentDate/Start gt {start_date_full} and ContentDate/Start lt {end_date_full}&#x26;$top=1000&#x26;$expand=Attributes\"</span>\nresponse = requests.<span class=\"hljs-title function_\">get</span>(query).<span class=\"hljs-title function_\">json</span>()\nresult = pd.<span class=\"hljs-property\">DataFrame</span>.<span class=\"hljs-title function_\">from_dict</span>(response[<span class=\"hljs-string\">\"value\"</span>])\n\n# <span class=\"hljs-string\">'Online'</span> ì—´ì´ <span class=\"hljs-title class_\">True</span>ì¸ ë ˆì½”ë“œ í•„í„°ë§\nresult = result[result[<span class=\"hljs-string\">'Online'</span>] == <span class=\"hljs-title class_\">True</span>]\n\n# ì²˜ìŒ <span class=\"hljs-number\">10</span>ê°œ ê²°ê³¼ ì¶œë ¥\nresult.<span class=\"hljs-title function_\">head</span>(<span class=\"hljs-number\">10</span>)\n\nresult.<span class=\"hljs-title function_\">to_csv</span>(<span class=\"hljs-string\">'result_LST.csv'</span>, index=<span class=\"hljs-title class_\">False</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ë‹¤ìŒ ë‹¨ê³„ì—ì„œëŠ” ì˜¨ë¼ì¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ëª©ë¡ì„ í•„í„°ë§í•˜ì—¬ ì •ì˜¤ì¯¤ ì´¬ì˜ëœ ì´ë¯¸ì§€ì— íŠ¹íˆ ì£¼ëª©í•  ê²ƒì…ë‹ˆë‹¤. íŒŒì¼ì˜ ê°ì§€ ì‹œê°„ì€ UTMì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì— 18:00:00ì€ íƒœí‰ì–‘ í‘œì¤€ì‹œ (ìº˜ë¦¬í¬ë‹ˆì•„ ì‹œê°„) ê¸°ì¤€ìœ¼ë¡œ ëŒ€ëµ 12:00:00 ì˜¤í›„ì— í•´ë‹¹í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">filtered_df = result[result[<span class=\"hljs-string\">\"Name\"</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">\"_\"</span>).<span class=\"hljs-property\">str</span>[<span class=\"hljs-number\">8</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">contains</span>(<span class=\"hljs-string\">\"T18\"</span>) &#x26; result[<span class=\"hljs-string\">\"Name\"</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">\"_\"</span>).<span class=\"hljs-property\">str</span>[<span class=\"hljs-number\">14</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">contains</span>(<span class=\"hljs-string\">\"PS2\"</span>) &#x26; result[<span class=\"hljs-string\">\"Name\"</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">\"_\"</span>).<span class=\"hljs-property\">str</span>[<span class=\"hljs-number\">16</span>].<span class=\"hljs-property\">str</span>.<span class=\"hljs-title function_\">contains</span>(<span class=\"hljs-string\">\"NT\"</span>)]\n\nfiltered_df = filtered_df.<span class=\"hljs-title function_\">reset_index</span>(drop=<span class=\"hljs-title class_\">True</span>)\n\n<span class=\"hljs-title function_\">print</span>(filtered_df[<span class=\"hljs-string\">'Name'</span>])\n</code></pre>\n<pre><code class=\"hljs language-js\">filtered_df.<span class=\"hljs-title function_\">to_csv</span>(<span class=\"hljs-string\">'result_LST_Filtered.csv'</span>, index=<span class=\"hljs-title class_\">False</span>)\n</code></pre>\n<p>í•„í„°ë§ëœ ë°ì´í„°í”„ë ˆì„ì„ ê¸°ë°˜ìœ¼ë¡œ, 2023ë…„ 5ì›” 1ì¼ë¶€í„° 8ì›” 1ì¼ê¹Œì§€ ìº˜ë¦¬í¬ë‹ˆì•„ ìƒê³µì—ì„œ ì´¬ì˜ëœ Sentinel-3ì˜ 53ì¥ì˜ ì´ë¯¸ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_2.png\">\n<p>ì´ë¯¸ì§€ê°€ íë¦¿í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê¸°ì–µí•˜ì„¸ìš”. ì„¼í‹°ë„¬-3 ì´ë¯¸ì§€ë¥¼ êµ¬ë¦„ ë®ê°œë¡œ ê±¸ëŸ¬ë‚´ëŠ” ê²ƒì„ ì œì–´í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p>ë‹¤ìŒ ë‹¨ê³„ëŠ” í•„í„°ë§ëœ ëª©ë¡ì˜ ì œí’ˆ IDë¥¼ ì‚¬ìš©í•˜ì—¬ NetCDF íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ì´ë¯¸ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì˜ ì„¹ì…˜ë“¤(ğŸ“¥ \"NetCDF\" íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ğŸ› ï¸ Geotiffë¡œ ë³€í™˜)ì—ì„œ ì„¤ëª…ëœ ìë£Œì˜ ì¤‘ë³µì„ í”¼í•˜ê¸° ìœ„í•´ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤:</p>\n<h2>ğŸ—ºï¸ ìº˜ë¦¬í¬ë‹ˆì•„ë¥¼ ìœ„í•œ ì´ë¯¸ì§€ í´ë¦¬í•‘ê³¼ NDVI ì§€ë„ í”Œë¡œíŒ…</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ì´ ë‹¨ê³„ë¥¼ ìì„¸íˆ ì„¤ëª…í•˜ê¸° ì „ì— ë‹¤ìŒ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê³  ë¡œë“œí•´ì£¼ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\">pip install matplotlib-scalebar\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">pyplot</span> <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">from</span> matplotlib <span class=\"hljs-keyword\">import</span> colors\n<span class=\"hljs-keyword\">from</span> mpl_toolkits.<span class=\"hljs-property\">axes_grid1</span> <span class=\"hljs-keyword\">import</span> make_axes_locatable\n<span class=\"hljs-keyword\">from</span> mpl_toolkits.<span class=\"hljs-property\">axes_grid1</span>.<span class=\"hljs-property\">inset_locator</span> <span class=\"hljs-keyword\">import</span> inset_axes\n<span class=\"hljs-keyword\">from</span> matplotlib_scalebar.<span class=\"hljs-property\">scalebar</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">ScaleBar</span>\n<span class=\"hljs-keyword\">from</span> matplotlib.<span class=\"hljs-property\">offsetbox</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">OffsetImage</span>, <span class=\"hljs-title class_\">AnnotationBbox</span>\n<span class=\"hljs-keyword\">from</span> datetime <span class=\"hljs-keyword\">import</span> datetime\n<span class=\"hljs-keyword\">import</span> rasterio.<span class=\"hljs-property\">plot</span>\n</code></pre>\n<p>ì´ ë‹¨ê³„ì—ì„œëŠ” Geotiff_reproj í´ë”ì— ì €ì¥ëœ 53ê°œì˜ ë˜ìŠ¤í„° íŒŒì¼ ê°ê°ì„ ì½ì–´ì˜¬ ê²ƒì…ë‹ˆë‹¤. ìº˜ë¦¬í¬ë‹ˆì•„ ì‰ì´í”„íŒŒì¼ íˆ¬ì˜ê³¼ ë˜ìŠ¤í„° íŒŒì¼ ê°„ì˜ ì¼ê´€ì„±ì„ í™•ì¸í•  ê²ƒì…ë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° ì‰ì´í”„íŒŒì¼ì„ ì¬íˆ¬ì˜í•  ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ë˜ìŠ¤í„° íŒŒì¼ì„ ìº˜ë¦¬í¬ë‹ˆì•„ì˜ ê²½ê³„ì— ë§ê²Œ ìë¦…ë‹ˆë‹¤. í•´ë‹¹ í”Œë¡¯ì„ í”Œë¡œíŒ…í•˜ê³  JPEG í´ë”ì— ì €ì¥í•  ê²ƒì…ë‹ˆë‹¤. ìº˜ë¦¬í¬ë‹ˆì•„ ì‰ì´í”„íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´ ë‹¤ìŒ URLì„ ë°©ë¬¸í•˜ì—¬ \"California State Boundry\"ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  Shapefile í´ë”ì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”:</p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><a href=\"https://data.ca.gov/dataset/ca-geographic-boundaries\" rel=\"nofollow\" target=\"_blank\">California Geographic Boundaries</a></p>\n<p><img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_3.png\" alt=\"Image\"></p>\n<p>The following code also requires an image for the north arrow symbol. You can either download one from the internet or, like me, draw it in PowerPoint, save it, and upload it to your main folder.</p>\n<p><img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_4.png\" alt=\"Image\"></p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ë§µì— ì´ ì•„ì´ì½˜ì´ í‘œì‹œë˜ëŠ” ê²ƒì€ ì™„ì „íˆ ì„ íƒ ì‚¬í•­ì…ë‹ˆë‹¤. ë§µì— ë¶ìª½ í™”ì‚´í‘œë¥¼ í‘œì‹œí•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´ í•´ë‹¹ ì„¹ì…˜ì„ ì£¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"># ë””ë ‰í† ë¦¬ ê²½ë¡œ ì„¤ì •\ndirectory = <span class=\"hljs-string\">'/content/Geotiff_reproj_clipped/'</span>\n\n\n# ë””ë ‰í† ë¦¬ ë‚´ ëª¨ë“  íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\nfiles = os.<span class=\"hljs-title function_\">listdir</span>(directory)\n\n# <span class=\"hljs-variable constant_\">NDVI</span> <span class=\"hljs-variable constant_\">TIF</span> íŒŒì¼ë§Œ í¬í•¨í•˜ëŠ” ëª©ë¡ í•„í„°ë§\nndvi_files = [f <span class=\"hljs-keyword\">for</span> f <span class=\"hljs-keyword\">in</span> files <span class=\"hljs-keyword\">if</span> f.<span class=\"hljs-title function_\">endswith</span>(<span class=\"hljs-string\">'.tif'</span>)]\n\n\n# ìƒ‰ìƒ í•œê³„ ì„¤ì •\nvmin = <span class=\"hljs-number\">0</span>\nvmax = <span class=\"hljs-number\">1</span>\nndvi_norm = colors.<span class=\"hljs-title class_\">Normalize</span>(vmin, vmax)\nndvi_cmap = plt.<span class=\"hljs-property\">cm</span>.<span class=\"hljs-property\">RdYlGn</span>\nndvi_cmap.<span class=\"hljs-title function_\">set_bad</span>(color=<span class=\"hljs-string\">'white'</span>)\n\n# ê°ê°ì˜ <span class=\"hljs-variable constant_\">NDVI</span> íŒŒì¼ì„ ë£¨í”„í•˜ì—¬ í”Œë¡¯í•˜ê¸°\n<span class=\"hljs-keyword\">for</span> ndvi_file <span class=\"hljs-keyword\">in</span> <span class=\"hljs-attr\">ndvi_files</span>:\n    <span class=\"hljs-title function_\">print</span>(ndvi_file)\n    date_str = ndvi_file.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">'_'</span>)[<span class=\"hljs-number\">0</span>]\n    date_obj = datetime.<span class=\"hljs-title function_\">strptime</span>(date_str, <span class=\"hljs-string\">\"%Y%m%d\"</span>)\n    formatted_date_str = date_obj.<span class=\"hljs-title function_\">strftime</span>(<span class=\"hljs-string\">\"%Y/%-m/%-d\"</span>)\n\n    # <span class=\"hljs-variable constant_\">NDVI</span> ë˜ìŠ¤í„° ì—´ê¸°\n    <span class=\"hljs-keyword\">with</span> rasterio.<span class=\"hljs-title function_\">open</span>(f<span class=\"hljs-string\">\"/content/Geotiff_reproj_clipped/{ndvi_file}\"</span>) <span class=\"hljs-keyword\">as</span> <span class=\"hljs-attr\">ndvi</span>:\n      # shapefile ì½ê¸°\n      california_shapefile = gpd.<span class=\"hljs-title function_\">read_file</span>(<span class=\"hljs-string\">'/content/Shapefile/CA_State_TIGER2016.shp'</span>)\n\n      ndvi_data = ndvi.<span class=\"hljs-title function_\">read</span>(<span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">astype</span>(float)\n      ndvi_data[ndvi_data&#x3C;=-<span class=\"hljs-number\">1</span>]=np.<span class=\"hljs-property\">nan</span>\n      ndvi_crs = ndvi.<span class=\"hljs-property\">crs</span>\n      extent = rasterio.<span class=\"hljs-property\">plot</span>.<span class=\"hljs-title function_\">plotting_extent</span>(ndvi)\n\n      # shapefileì„ ë˜ìŠ¤í„°ì˜ íˆ¬ì˜ê³¼ ì¼ì¹˜í•˜ë„ë¡ ì¬íˆ¬ì˜\n      california_shapefile = california_shapefile.<span class=\"hljs-title function_\">to_crs</span>(ndvi_crs)\n\n\n    # í”Œë¡¯ ìƒì„±\n    fig, ax = plt.<span class=\"hljs-title function_\">subplots</span>(figsize=(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">6</span>))\n\n    \n    image= rasterio.<span class=\"hljs-property\">plot</span>.<span class=\"hljs-title function_\">show</span>(ndvi_data, ax=ax, extent=extent, alpha=<span class=\"hljs-number\">1</span>, cmap=ndvi_cmap,norm=ndvi_norm,)\n    im = image.<span class=\"hljs-title function_\">get_images</span>()[<span class=\"hljs-number\">0</span>]  # ì»¬ëŸ¬ë°”ì— ëŒ€í•œ íŠ¸ë¦­ (rasterio.<span class=\"hljs-property\">plot</span>.<span class=\"hljs-property\">show</span>ì™€ í˜¸í™˜ë˜ì§€ ì•ŠìŒ)\n    fig.<span class=\"hljs-title function_\">colorbar</span>(im, ax=ax)\n   \n\n    ax.<span class=\"hljs-title function_\">set_title</span>(formatted_date_str, fontsize=<span class=\"hljs-number\">16</span>,fontweight=<span class=\"hljs-string\">'bold'</span>)\n    california_shapefile.<span class=\"hljs-property\">boundary</span>.<span class=\"hljs-title function_\">plot</span>(ax=ax, color=<span class=\"hljs-string\">'k'</span>, linewidth=<span class=\"hljs-number\">1</span>)\n\n    ax.<span class=\"hljs-title function_\">set_xticklabels</span>([])\n    ax.<span class=\"hljs-title function_\">set_yticklabels</span>([])\n\n    # ë¶ìª½ í™”ì‚´í‘œ ì¶”ê°€\n    north_arrow_image = plt.<span class=\"hljs-title function_\">imread</span>(<span class=\"hljs-string\">'North_sign.png'</span>)\n    imagebox = <span class=\"hljs-title class_\">OffsetImage</span>(north_arrow_image, zoom=<span class=\"hljs-number\">0.25</span>)\n    ab = <span class=\"hljs-title class_\">AnnotationBbox</span>(imagebox, (<span class=\"hljs-number\">0.8</span>, <span class=\"hljs-number\">0.99</span>), xycoords=<span class=\"hljs-string\">'axes fraction'</span>, box_alignment=(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>), frameon=<span class=\"hljs-title class_\">False</span>)\n    ax.<span class=\"hljs-title function_\">add_artist</span>(ab)\n\n    # ìŠ¤ì¼€ì¼ ë°” ì¶”ê°€\n    scalebar = <span class=\"hljs-title class_\">ScaleBar</span>(<span class=\"hljs-number\">1000</span>, <span class=\"hljs-string\">'m'</span>, length_fraction=<span class=\"hljs-number\">0.2</span>, location=<span class=\"hljs-string\">'lower right'</span>, font_properties={<span class=\"hljs-string\">'size'</span>:<span class=\"hljs-number\">12</span>})\n    ax.<span class=\"hljs-title function_\">add_artist</span>(scalebar)\n\n    # ë§µ ì£¼ë³€ì— ë„¤ëª¨ ìƒì ë„ê¸°\n    ax.<span class=\"hljs-title function_\">axis</span>(<span class=\"hljs-string\">'off'</span>)\n\n    # í”Œë¡¯ì„ <span class=\"hljs-variable constant_\">JPEG</span> íŒŒì¼ë¡œ ì €ì¥\n    plt.<span class=\"hljs-title function_\">savefig</span>(os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">join</span>(<span class=\"hljs-string\">'/content/JPEG'</span>, ndvi_file.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">'_'</span>)[<span class=\"hljs-number\">0</span>] + <span class=\"hljs-string\">'.jpg'</span>), dpi=<span class=\"hljs-number\">300</span>, bbox_inches=<span class=\"hljs-string\">'tight'</span>)\n\n    # ë©”ëª¨ë¦¬ í•´ì œë¥¼ ìœ„í•´ í”Œë¡¯ ë‹«ê¸°\n    plt.<span class=\"hljs-title function_\">close</span>(fig)\n</code></pre>\n<p>ì´ ë‹¨ê³„ë¥¼ ì™„ë£Œí•˜ë©´ \"JPEG\" í´ë”ì— ì„¼ì‹± ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì €ì¥ëœ 53ê°œì˜ NDVI ì§€ë„ê°€ ìˆê²Œ ë  ê²ƒì…ë‹ˆë‹¤:</p>\n<img src=\"/TIL/assets/img/2024-07-14-ALongPythonScripttoMakeaShortVideoUsingGeospatialBigData_5.png\">\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>ğŸ¥ NDVI ì§€ë„ë¥¼ ë¹„ë””ì˜¤ë¡œ ë‚´ë³´ë‚´ê¸°</h2>\n<p>3ê°œì›” ë™ì•ˆ ì„¼í‹°ë„¬-3ì— ì˜í•´ ì´¬ì˜ëœ 53ê°œì˜ NDVI ì§€ë„(ëŒ€ëµ ë§¤ 2ì¼ë§ˆë‹¤ 1ì¥ì”©)ë¥¼ ì‚¬ìš©í•˜ì—¬, 2023ë…„ ìº˜ë¦¬í¬ë‹ˆì•„ ì§€ì—­ ì „ì²´ì˜ NDVI íŒ¨í„´ê³¼ ë³€í™”ë¥¼ ë³´ì—¬ì£¼ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¹„ë””ì˜¤ë¥¼ ìƒì„±í•˜ë ¤ë©´, ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:</p>\n<pre><code class=\"hljs language-js\">pip install pillow\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> <span class=\"hljs-variable constant_\">PIL</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Image</span>\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> glob\n\n# <span class=\"hljs-string\">'path/to/folder'</span>ë¥¼ ì—¬ëŸ¬ë¶„ì˜ jpg ì´ë¯¸ì§€ê°€ ì €ì¥ëœ í´ë” ê²½ë¡œë¡œ êµì²´í•˜ì„¸ìš”\nfolder_path = <span class=\"hljs-string\">'/content/JPEG'</span>\noutput_gif = os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">join</span>(<span class=\"hljs-string\">'/content/Animation'</span>, <span class=\"hljs-string\">'NDVI_animation.gif'</span>)\n\n# í´ë” ë‚´ ëª¨ë“  jpg íŒŒì¼ì˜ ì •ë ¬ëœ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤\nfile_list = <span class=\"hljs-title function_\">sorted</span>(glob.<span class=\"hljs-title function_\">glob</span>(os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">join</span>(folder_path, <span class=\"hljs-string\">'*.jpg'</span>)))\n\n# ì´ë¯¸ì§€ì˜ ì›í•˜ëŠ” í¬ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤\nwidth, height = <span class=\"hljs-number\">1000</span>, <span class=\"hljs-number\">1000</span>\n\n# ì´ë¯¸ì§€ë¥¼ ì½ì–´ì„œ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥í•©ë‹ˆë‹¤\nframes = []\n<span class=\"hljs-keyword\">for</span> file <span class=\"hljs-keyword\">in</span> <span class=\"hljs-attr\">file_list</span>:\n    frame = <span class=\"hljs-title class_\">Image</span>.<span class=\"hljs-title function_\">open</span>(file)\n\n    # ì´ë¯¸ì§€ í¬ê¸° ì¡°ì •\n    frame = frame.<span class=\"hljs-title function_\">resize</span>((width, height), <span class=\"hljs-title class_\">Image</span>.<span class=\"hljs-property\">ANTIALIAS</span>)\n\n    # ì´ë¯¸ì§€ì— í°ìƒ‰ ë°°ê²½ ì¶”ê°€\n    background = <span class=\"hljs-title class_\">Image</span>.<span class=\"hljs-title function_\">new</span>(<span class=\"hljs-string\">'RGB'</span>, frame.<span class=\"hljs-property\">size</span>, (<span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>))\n    background.<span class=\"hljs-title function_\">paste</span>(frame)\n    frame = background.<span class=\"hljs-title function_\">convert</span>(<span class=\"hljs-string\">'RGB'</span>)\n\n    # ì´ë¯¸ì§€ë¥¼ P ëª¨ë“œë¡œ ë³€í™˜í•˜ê³  ì „ì—­ ìƒ‰ìƒ í…Œì´ë¸”ì„ ì‚¬ìš©í•©ë‹ˆë‹¤\n    frame = frame.<span class=\"hljs-title function_\">convert</span>(<span class=\"hljs-string\">'P'</span>, palette=<span class=\"hljs-title class_\">Image</span>.<span class=\"hljs-property\">ADAPTIVE</span>, colors=<span class=\"hljs-number\">256</span>)\n    frames.<span class=\"hljs-title function_\">append</span>(frame)\n\n# ì• ë‹ˆë©”ì´ì…˜ <span class=\"hljs-variable constant_\">GIF</span>ë¡œ í”„ë ˆì„ì„ ì €ì¥í•©ë‹ˆë‹¤\n<span class=\"hljs-keyword\">if</span> <span class=\"hljs-attr\">frames</span>:\n    frames[<span class=\"hljs-number\">0</span>].<span class=\"hljs-title function_\">save</span>(\n        output_gif,\n        save_all=<span class=\"hljs-title class_\">True</span>,\n        append_images=frames[<span class=\"hljs-number\">1</span>:],\n        duration=<span class=\"hljs-number\">500</span>,  # í”„ë ˆì„ ê°„ ì§€ì† ì‹œê°„(ë°€ë¦¬ì´ˆ)ì„ ì„¤ì •í•©ë‹ˆë‹¤\n        loop=<span class=\"hljs-number\">0</span>,  # ë£¨í”„ íšŸìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤ (<span class=\"hljs-number\">0</span>ì€ ë¬´í•œì„ ì˜ë¯¸í•©ë‹ˆë‹¤)\n        optimize=<span class=\"hljs-title class_\">True</span>,\n    )\n<span class=\"hljs-attr\">else</span>:\n    <span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"jpg íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\"</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ì‘ì—…ì´ ì™„ë£Œë˜ë©´ í™”ë©´ì—ì„œ ë§Œë“¤ì–´ì§„ ì§€í¼ ì˜ìƒì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‹œì²­í•  ìˆ˜ ìˆì–´ìš”!</p>\n<p><img src=\"https://miro.medium.com/v2/resize:fit:1000/1*B8CQ1b8hgqEPrGj33oxrzQ.gif\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>êµ¬ë¦„ì´ ê°€ë ¤ì ¸ ìˆê¸° ë•Œë¬¸ì— ì§€ë„ ë‚´ ëª‡ êµ°ë°ëŠ” í°ìƒ‰ ì˜ì—­ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë˜í•œ íŠ¹ì • ë‚ ì§œì— ìº˜ë¦¬í¬ë‹ˆì•„ì˜ ëª¨ë“  ì˜ì—­ì„ ì»¤ë²„í•˜ì§€ ì•Šì•„ ì¼ë¶€ ì´ë¯¸ì§€ê°€ ì˜ë ¤ ë‚˜ì™€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë ˆì„ì´ ë„ˆë¬´ ë¹¨ë¦¬ ë³€ê²½ë˜ëŠ” ê²ƒ ê°™ë‹¤ë©´, ê° í”„ë ˆì„ ê°„ì˜ ì§€ì† ì‹œê°„ì„ ì¡°ì ˆí•  ìˆ˜ ìˆì–´ìš”. ê¸´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œ í›„ì—ëŠ” ì´ ì•„ë¦„ë‹¤ìš´ ì§§ì€ ì• ë‹ˆë©”ì´ì…˜ì„ ì¦ê¸°ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>\n<h2>ğŸ“ ê²°ë¡ </h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ìš”ì•½í•˜ìë©´, ìƒìƒë ¥ì„ ë°ì´í„° ì‹œê°í™”ì™€ ì½”ë”©ì„ í†µí•´ í˜„ì‹¤í™”í•˜ëŠ” ê²ƒì€ ë•Œë¡œëŠ” ê½¤ ë§ì€ ì‹œê°„ì„ ì†Œìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì´ì•¼ê¸°ì—ì„œëŠ” 50ì´ˆì§œë¦¬ ë¹„ë””ì˜¤ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ 300ì¤„ ì´ìƒì˜ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ìƒë‹¹í•œ ì‹œê°„ íˆ¬ìì—ë„ ë¶ˆêµ¬í•˜ê³ , ê·¸ ë…¸ë ¥ì€ ê°€ì¹˜ê°€ ìˆë‹¤ê³  ë¯¿ìŠµë‹ˆë‹¤. ì§€ë„ì˜ ìˆœì°¨ì ì¸ í‘œí˜„ì€ ìˆ¨ê²¨ì§„ íŒ¨í„´ê³¼ ë™ì  ë³€í™”ë¥¼ ë“œëŸ¬ë‚´ë©° ë” ë§ì€ íƒêµ¬ë¥¼ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ ì´ì•¼ê¸°ì—ì„œëŠ” 6ì›” ì´ì „ì˜ NDVI ë³€ë™ì„± ê´€ì¸¡ê³¼ 6ì›” ì¤‘ìˆœë¶€í„° 7ì›”ê¹Œì§€ ì•ˆì •í™”ëœ ëª¨ìŠµì´ ìš°ë¦¬ì—ê²Œ ì¶”ê°€ì ì¸ ì§ˆë¬¸ì„ ë˜ì§€ë©° ë” ë§ì€ ì¡°ì‚¬ì™€ ë‹µì„ ë°œê²¬í•˜ë„ë¡ ë™ê¸°ë¶€ì—¬í•©ë‹ˆë‹¤.</p>\n<h2>ğŸ“š ì°¸ê³  ìë£Œ</h2>\n<p><a href=\"https://documentation.dataspace.copernicus.eu/APIs/OData.html\" rel=\"nofollow\" target=\"_blank\">https://documentation.dataspace.copernicus.eu/APIs/OData.html</a></p>\n<ul>\n<li>ğŸ“± ë” ë§ì€ ìƒí˜¸ì‘ìš©ì´ ìˆëŠ” ì½˜í…ì¸ ë¥¼ ìœ„í•´ ë‹¤ë¥¸ í”Œë«í¼ì—ì„œ ì €ì™€ ì—°ê²°í•˜ì„¸ìš”! LinkedIn, ResearchGate, Github, ê·¸ë¦¬ê³  Twitter.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>í•´ë‹¹ ë§í¬ë¥¼ í†µí•´ ê´€ë ¨ ê²Œì‹œë¬¼ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n</body>\n</html>\n"},"__N_SSG":true}