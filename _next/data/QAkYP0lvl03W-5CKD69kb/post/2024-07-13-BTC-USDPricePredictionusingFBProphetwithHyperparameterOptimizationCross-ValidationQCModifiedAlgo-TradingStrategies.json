{"pageProps":{"post":{"title":"FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ","description":"","date":"2024-07-13 19:54","slug":"2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies","content":"\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png\" />\n\n- ë³¸ ê¸€ì€ ì´ì „ ì—°êµ¬ë¥¼ ì´ì–´ê°€ë©°, Pythonì—ì„œ Facebookì˜ Prophetì„ í™œìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡ì— ëŒ€í•œ ìì„¸í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤ [1â€“5] (ì°¸ê³  ë¬¸í—Œ).\n- í˜„ì¬ì˜ ë¹„êµ ë¶„ì„ì€ ì‹œê°„ ì‹œë¦¬ì¦ˆ êµì°¨ ê²€ì¦ QCë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ì¸¡ì •í•˜ëŠ” HPO ë˜ëŠ” ëª¨ë¸ íŠœë‹ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë´…ë‹ˆë‹¤.\n- ì‹œë®¬ë ˆì´ì…˜ëœ BTC ì˜ˆì¸¡ì— ì¶”ê°€ë˜ì–´, FB Prophetì„ ì‚¬ìš©í•˜ì—¬ í¬ë¦½í†  ì•Œê³ íŠ¸ë ˆì´ë”© ì „ëµì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ Buy & Hold ê¸°ì¤€ê³¼ ë¹„êµí•˜ì—¬ ì„¤ëª…í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.\n\n## ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤\n\n- ì ì ˆí•œ ì•”í˜¸í™”í ì˜ˆì¸¡ì€ í¬ë¦½í†  íŠ¸ë ˆì´ë”ë“¤ì—ê²Œ í° ì´ìµì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆìœ¼ë©° íš¨ê³¼ì ì¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ìµœê·¼ BTCëŠ” ë§ì€ ê°€ê²© ì˜ˆì¸¡ì˜ ì£¼ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n- CoinCodex: BTCì˜ ì—­ì‚¬ì ì¸ ê°€ê²© ë³€ë™ê³¼ BTC í•˜í”„ ì‚¬ì´í´ì„ ê¸°ë°˜ìœ¼ë¡œ, BTCê°€ ìƒí•œ ê°€ê²© ëŒ€ìƒì— ë„ë‹¬í•œë‹¤ë©´ 2025ë…„ê¹Œì§€ 201.59%ì˜ ì´ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œí¸, BTCì˜ ê°€ê²©ì€ ë‚´ë…„ì— $173,833ê¹Œì§€ ìƒìŠ¹í•  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.\n- í•˜ì§€ë§Œ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ 2030ë…„ê¹Œì§€ 1ë°±ë§Œ ë‹¬ëŸ¬ì— ë„ë‹¬í• ê¹Œìš”?\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## FB Prophetì— ëŒ€í•´\n\n- FB Prophetì€ ì¶”ì„¸/ê³„ì ˆì„± ëª¨ë¸ë§ê³¼ ë² ì´ì§€ì•ˆ ì¶”ë¡ ì— ê¸°ì´ˆí•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ì ˆì°¨ì…ë‹ˆë‹¤.\n- ê°•í•œ ê³„ì ˆ íš¨ê³¼ê°€ ìˆëŠ” ì‹œê³„ì—´ì— ê°€ì¥ ì í•©í•˜ë©°, ëˆ„ë½ ëœ ë°ì´í„°, ì´ìƒì¹˜ ë° ì¶”ì„¸ ë³€ë™ì— ê²¬ê³ í•©ë‹ˆë‹¤.\n- ì˜ˆì¸¡ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: ì¶”ì„¸(ì¥ê¸°ê°„ ë™ì•ˆì˜ ë³€í™”), ê³„ì ˆì„±(ì£¼ê¸°ì  ë˜ëŠ” ë‹¨ê¸° ë³€í™”), íœ´ì¼ ë° íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ì—ë§Œ í•´ë‹¹ë˜ëŠ” ì¡°ê±´ë¶€ ë³€ê²½ ì‚¬í•­.\n- ìƒˆë¡œìš´ ì‚¬ìš©ìì—ê²Œ íŠ¹íˆ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„±ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.\n- ì¶”ê°€ì ì¸ íšŒê·€ ë³€ìˆ˜, ê³±ì…ˆ ê³„ì ˆì„±, ë¹„ì¼ì¼ ë°ì´í„°, ë¶ˆí™•ì‹¤ì„± ì¸¡ì • ë° ì§„ë‹¨ì´ í¬í•¨ë©ë‹ˆë‹¤.\n\nì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²© ì˜ˆì¸¡ì˜ êµ¬ì²´ì  ë‚´ìš©ì„ ì‚´í´ë´…ì‹œë‹¤.\n\n## ì£¼ìš” ì„¤ì¹˜ ë°©ë²•\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- pipì€ ì €í¬ê°€ ì„ í˜¸í•˜ëŠ” ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Python 3.4ë¶€í„° Python ì´ì§„ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n- Jupyter Notebookì„ ì‹¤í–‰í•˜ê³  í•„ìˆ˜ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n\n```python\n!pip install statsmodels, math, yfinance, prophet, plotly,matplotlib, itertools\n```\n\n## Imports & Settings\n\n- ì½”ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì´ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nimport pandas as pd\nimport plotly.express as px\nimport requests\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom math import floor\nfrom termcolor import colored as cl\nimport yfinance as yf\nimport datetime\nfrom datetime import date, timedelta\n\n# Prophet ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°\nfrom prophet import Prophet\n\nplt.rcParams['figure.figsize'] = (12, 6)\nplt.style.use('fivethirtyeight')\n\nimport os\nos.chdir('ì‘ì—…ê²½ë¡œ')    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •\nos.getcwd()\n```\n\n## ì£¼ì‹ ë°ì´í„° ì…ë ¥\n\n- 730ì¼ì˜ BTC-USD ì´ë ¥ ë°ì´í„° ì…ë ¥\n\n```js\ntoday = date.today()\n\nd1 = today.strftime(\"%Y-%m-%d\")\nend_date = d1\nd2 = date.today() - timedelta(days=730)\nd2 = d2.strftime(\"%Y-%m-%d\")\nstart_date = d2\n\ndata = yf.download('BTC-USD', \n                      start=start_date, \n                      end=end_date, \n                      progress=False)\ndata[\"Date\"] = data.index\ndata = data[[\"Date\", \"Open\", \"High\", \"Low\", \"Close\", \"Adj Close\", \"Volume\"]]\ndata.reset_index(drop=True, inplace=True)\ndata.tail()\n\n|   Date    |    Open    |    High    |   Low    |   Close    |  Adj Close  |   Volume      |\n|----------|------------|------------|---------|------------|-------------|--------------|\n|2024-07-02| 62,844.41  | 63,203.36  | 61,752.75|   62,029.02 |  62,029.02  |  20151616992  |\n|2024-07-03| 62,034.33  | 62,187.70  | 59,419.39|   60,173.92 |  60,173.92  |  29756701685  |\n|2024-07-04| 60,147.14  | 60,399.68  | 56,777.80|   56,977.70 |  56,977.70  |  41149609230  |\n|2024-07-05| 57,022.81  | 57,497.15  | 53,717.38|   56,662.38 |  56,662.38  |  55417544033  |\n|2024-07-06| 56,659.07  | 58,472.55  | 56,038.96|   58,303.54 |  58,303.54  |  20610320577  |\n```   \n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ì¢…ê°€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n```js\nplt.plot(data['Date'], data['Close'])\nplt.xlabel('ë‚ ì§œ')\nplt.ylabel('ì¢…ê°€(USD)')\nplt.title('BTC-USD ì¢…ê°€')\n```\n\n![BTC-USD Close Price](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_1.png)\n\n## ë°ì´í„° ì¤€ë¹„\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- Box Cox ë³€í™˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì •ê·œì ì¸ ì¢…ì† ë³€ìˆ˜ì¸ Close ê°€ê²©ì„ ì •ê·œë¶„í¬ í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.\n\n```js\n### Box Cox ë³€í™˜\nfrom statsmodels.base.transform import BoxCox\n\nbc = BoxCox()\ndata[\"Close\"], lmbda = bc.transform_boxcox(data[\"Close\"])\n```\n\n- Prophetì— ì…ë ¥ ë°ì´í„° ë§Œë“¤ê¸°\n\n```js\ndata1 = data[[\"Date\", \"Close\"]]\ndata1.columns = [\"ds\", \"y\"]\n\ndata1.tail()\n\n    ds          y\n725 2024-07-02 42.381398\n726 2024-07-03 42.086488\n727 2024-07-04 41.560999\n728 2024-07-05 41.507898\n729 2024-07-06 41.781750\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- Prophetì— ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒì€ í•­ìƒ dsì™€ y ë‘ ê°œì˜ ì—´ì´ ìˆëŠ” ë°ì´í„°í”„ë ˆì„ì…ë‹ˆë‹¤. ds (ë‚ ì§œ) ì—´ì€ Pandasì—ì„œ ì˜ˆìƒí•˜ëŠ” í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‚ ì§œì˜ ê²½ìš° YYYY-MM-DDì´ê³ , íƒ€ì„ìŠ¤íƒ¬í”„ì˜ ê²½ìš° YYYY-MM-DD HH:MM:SSì…ë‹ˆë‹¤. y ì—´ì€ ìˆ«ìì´ì–´ì•¼ í•˜ë©°, ì˜ˆì¸¡í•˜ë ¤ëŠ” ì¸¡ì • ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n## Max Capê³¼ 5% í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•œ Prophet\n\n- ë§¤ë…„ ê³±ì…ˆ ê³„ì ˆì„±ê³¼ ë¡œì§€ìŠ¤í‹± ì„±ì¥ì´ ìˆëŠ” ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n```js\nmodel_param = {\n    \"daily_seasonality\": False,\n    \"weekly_seasonality\": False,\n    \"yearly_seasonality\": True,\n    \"seasonality_mode\": \"multiplicative\",\n    \"growth\": \"logistic\"\n}\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ê°€ë²• ê³„ì ˆì„± ëª¨ë¸ì„ ì í•©ì‹œí‚¤ë©°, ê³„ì ˆì„±ì˜ ì˜í–¥ì´ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì¶”ì„¸ì— ë”í•´ì§‘ë‹ˆë‹¤. ìœ„ ëª¨ë¸ì—ì„œ ê³„ì ˆì„±ì€ Prophetì´ ê°€ì •í•œ ê²ƒì²˜ëŸ¼ ì¼ì •í•œ ê°€ë²•ì  ìš”ì†Œê°€ ì•„ë‹ˆë¼ ì¶”ì„¸ì™€ í•¨ê»˜ ì¦ê°€í•˜ëŠ” ë‹¤ì¤‘ ê³„ì ˆì„±ì…ë‹ˆë‹¤.\n- ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ì˜ˆì¸¡ì„ ìœ„í•´ ì„ í˜• ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ì¥ì„ ì˜ˆì¸¡í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ì •í•œ ìµœëŒ€ ë‹¬ì„± ê°€ëŠ¥ ì§€ì ì´ ìˆìŠµë‹ˆë‹¤: ì´ ì‹œì¥ ê·œëª¨ ë“±. ì´ë¥¼ ìš´ë°˜ ìš©ëŸ‰ì´ë¼ê³ í•˜ë©°, ì˜ˆì¸¡ì€ ì´ ì§€ì ì—ì„œ í¬í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Prophetì€ ì§€ì •ëœ ìš´ë°˜ ìš©ëŸ‰ì„ ê°–ì¶˜ ë¡œì§€ìŠ¤í‹± ì„±ì¥ íŠ¸ë Œë“œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ëª¨ë¸ ì‹¤í–‰\n\n```js\nmodel = Prophet(**model_param)\n```\n\n- ë¡œì§€ìŠ¤í‹± ì„±ì¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— ëŒ€í•œ ìƒí•œì„  ë˜ëŠ” ìƒí•œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ìƒí•œê°’ì€ ê°€ê²©ì˜ ìµœëŒ€ê°’ì— í‘œì¤€í¸ì°¨ì˜ 5%ë¥¼ ë”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n```js\ndata1['cap'] = data1[\"y\"].max() + data1[\"y\"].std() * 0.05\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ëª¨ë¸ì„ ë§ì¶”ëŠ” ì¤‘\n\n```js\nmodel.fit(data1)\n```\n\n- ìœ„ì˜ ìº¡ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë‚´ë¶€ ë° 1ë…„ ì¥ê¸° ì˜ˆì¸¡ ìƒì„±\n\n```js\nfuture= model.make_future_dataframe(periods=365)\n\nfuture['cap'] = data1['cap'].max()\n\nforecast= model.predict(future)\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ (ds-y) ë„ë©”ì¸ ì˜ˆì¸¡ì„ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.\n\n```js\nmodel.plot(forecast,figsize=(14, 8))\n```\n\n![BTC-USD ê°€ê²© ì˜ˆì¸¡](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_2.png)\n\n```js\nmodel.plot_components(forecast,figsize=(16, 10));\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì´ì „ì— ì‚¬ìš©í•˜ë˜ table tagë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.\n\n## Prophet with Monthly/Quarterly Seasonality & US Holidays\n\n- Prophetë¥¼ ì›”ë³„/ë¶„ê¸°ë³„ ê³„ì ˆì„± ë° ë¯¸êµ­ ê³µíœ´ì¼ê³¼ í•¨ê»˜ ì‹¤í–‰ ì¤‘\n\n```js\nmodel = Prophet(**model_param)\n\nmodel.add_seasonality(name=\"monthly\", period=30, fourier_order=10)\nmodel.add_seasonality(name=\"quarterly\", period=92.25, fourier_order=10)\n\nmodel.add_country_holidays(\"US\")\n\nmodel.fit(data1)\n\n# ë¯¸ë˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±\nfuture = model.make_future_dataframe(periods=365)\nfuture['cap'] = data1['cap'].max()\n\nforecast = model.predict(future)\n\nfrom prophet.plot import plot\n\nplot(model, forecast, figsize=(14, 8))\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nfrom prophet.plot import plot_components\n\nplot_components(model, forecast, figsize=(10, 12))\n```\n\nìœ„ì˜ ì½”ë“œ ë¸”ë¡ì€ Prophet ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡í•œ ë°ì´í„°ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹œê°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”! ğŸš€\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤\n\n```js\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])\n```\n\n![BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7.png)\n\n- ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ cutoffë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì˜ ëª‡ ê°€ì§€ ìœ ìš©í•œ í†µê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nfrom prophet.diagnostics import cross_validation, performance_metrics\nfrom prophet.plot import plot_cross_validation_metric\ndf_cv = cross_validation(model, initial=\"600 days\", period=\"30 days\", horizon=\"90 days\")\ncutoffs = pd.to_datetime(['2022-09-01', '2023-05-01', '2024-03-01'])\ndf_cv2 = cross_validation(model, cutoffs=cutoffs, horizon='90 days')\nfig = plot_cross_validation_metric(df_cv2, metric='rmse')\n```\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_8.png\" />\n\n- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìš”ì•½ ì •ë³´ ì¶œë ¥\n\n```js\ndf_p = performance_metrics(df_cv2)\ndf_p.head()\n\n    horizon mse      rmse       mae       mape     mdape   smape coverage\n0 9 days 3805.462369 61.688430 29.520999 0.893692 0.118312 0.355870 0.0\n1 10 days 5382.793620 73.367524 37.768231 1.140719 0.168333 0.425770 0.0\n2 11 days 6754.735216 82.187196 45.409934 1.368028 0.286148 0.491224 0.0\n3 12 days 7678.053041 87.624500 51.465541 1.551664 0.352840 0.546114 0.0\n4 13 days 8071.329465 89.840578 55.027843 1.658574 0.426625 0.584601 0.0\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- MAPE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mape')\n```\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_9.png\" />\n\n- MAE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mae')\n```\n\n![BTC-USD Price Prediction using FB Prophet with Hyperparameter Optimization Cross-Validation QC Modified Algorithm Trading Strategies](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_10.png)\n\n## Hyperparameter Optimization (HPO)\n\n- Running HPO by adding monthly/quarterly seasonality and US holidays\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nrmses = list()\n\n# ê° ì¡°í•©ì„ ìˆœíšŒí•©ë‹ˆë‹¤.\nfor params in all_params:\n    m = Prophet(**params)\n    \n    m = m.add_seasonality(name='monthly', period=30, fourier_order=5)\n    m = m.add_seasonality(name='quarterly', period=92.25, fourier_order=10)\n\n    m.add_country_holidays(country_name='US')\n    \n    m.fit(data1)\n    \n    df_cv = cross_validation(m, initial='500 days', period='180 days', horizon='90 days')\n    \n    df_p = performance_metrics(df_cv, rolling_window=1)\n    \n    rmses.append(df_p['rmse'].values[0])\n    \n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\nbest_params = all_params[np.argmin(rmses)]\n    \nprint(\"\\nìµœì ì˜ ë§¤ê°œë³€ìˆ˜ëŠ”:\", best_params)\n```\n\n- ìµœì í™”ëœ ëª¨ë¸ì„ í”¼íŒ…í•˜ê³  í•´ë‹¹í•˜ëŠ” ì˜ˆì¸¡ ìƒì„±\n\n```js\nmodel_param1 = {\n    'daily_seasonality': False,\n    'weekly_seasonality': False,\n    'yearly_seasonality': True,\n    'seasonality_mode': 'multiplicative',\n    'growth': 'logistic',\n    'seasonality_prior_scale': 0.1,\n    'changepoint_prior_scale': 0.01\n}\n\nmodel1 = Prophet(**model_param1)\n\nmodel1.add_country_holidays('US')\n\nmodel1.fit(data1)\n\n# í–¥í›„ ë°ì´í„° í”„ë ˆì„ ìƒì„±\nfuture = model1.make_future_dataframe(periods=365)\nfuture['cap'] = data1['cap'].max()\n\nforecast = model1.predict(future)\n```\n\n- ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n js\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])\n\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_11.png\" />\n\n- ìˆ˜ë™ cutoffë¡œ êµì°¨ ê²€ì¦ QC ì‹¤í–‰ ì¤‘\n\n```js\ncutoffs = pd.to_datetime(['2022-09-01', '2023-05-01', '2024-03-01'])\ndf_cv2 = cross_validation(model1, cutoffs=cutoffs, horizon='90 days')\nfig = plot_cross_validation_metric(df_cv2, metric='rmse')\n``` \n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_12.png)\n\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mape')\n```\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_13.png)\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mae')\n``` \n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n\n![BTC-USD Price Prediction](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_14.png)\n\n## 2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ BTC-USD ì—­ì‚¬ì  ë°ì´í„° ì¤€ë¹„\n\n- ë°•ìŠ¤-ì½•ìŠ¤(Box-Cox) ë³€í™˜ì„ í•˜ì§€ ì•Šê³  2020ë…„ 01ì›” 01ì¼ë¶€í„° 2024ë…„ 07ì›” 07ì¼ê¹Œì§€ì˜ BTC-USD ì—­ì‚¬ì  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.\n\n```js\nimport pandas as pd\nimport numpy as np\nfrom prophet import Prophet\nimport matplotlib.pyplot as plt\nfrom functools import reduce\n\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\npd.options.display.float_format = \"{:,.2f}\".format\n\nimport yfinance as yf\n\nticker = 'BTC-USD'\nstart_date = '2020-01-01'\n\nstock_price = yf.download(ticker, start=start_date)\nstock_price[\"ë‚ ì§œ\"] = stock_price.index\nstock_price.tail()\n\n           Open      High      Low       Close    Adj Close   Volume      ë‚ ì§œ\nDate       \n2024-07-03 62,034.33 62,187.70 59,419.39 60,173.92 60,173.92 29756701685 2024-07-03\n2024-07-04 60,147.14 60,399.68 56,777.80 56,977.70 56,977.70 41149609230 2024-07-04\n2024-07-05 57,022.81 57,497.15 53,717.38 56,662.38 56,662.38 55417544033 2024-07-05\n2024-07-06 56,659.07 58,472.55 56,038.96 58,303.54 58,303.54 20610320577 2024-07-06\n2024-07-07 58,239.43 58,367.18 56,644.89 57,198.04 57,198.04 19585976320 2024-07-07\n\nstock_price = stock_price[['ë‚ ì§œ','Adj Close']]\n\nstock_price.columns = ['ds', 'y']\nstock_price.tail()\n\n           ds          y\nDate  \n2024-07-03 2024-07-03 60,173.92\n2024-07-04 2024-07-04 56,977.70\n2024-07-05 2024-07-05 56,662.38\n2024-07-06 2024-07-06 58,303.54\n2024-07-07 2024-07-07 57,198.04\n```\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ê¸°ë³¸ Prophet ëª¨ë¸ì„ ì í•©ì‹œí‚¤ê³  2027ë…„ 7ì›” 7ì¼ê¹Œì§€ì˜ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n```js\nmodel = Prophet()\nmodel.fit(stock_price)\nfuture = model.make_future_dataframe(1095, freq='d')\n\nfuture_boolean = future['ds'].map(lambda x : True if x.weekday() in range(0, 5) else False)\nfuture = future[future_boolean] \n\nfuture.tail()\nds\n2738 2027-07-01\n2739 2027-07-02\n2742 2027-07-05\n2743 2027-07-06\n2744 2027-07-07\n\nforecast = model.predict(future)\n#forecast.tail()\n\nmodel.plot(forecast);\r\n```\n\n![BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15.png)\n\n- ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n\nmodel.plot_components(forecast);\n\n\n![Forecast Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_16.png)\n\n- ì›ë˜ ê°€ê²©ê³¼ ì˜ˆì¸¡ì„ ì‹ ë¢° êµ¬ê°„ê³¼ í•¨ê»˜ ê·¸ë˜í”½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.\n\n```python\nstock_price_forecast = forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']]\ndf = pd.merge(stock_price, stock_price_forecast, on='ds', how='right')\ndf.set_index('ds').plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True);\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_17.png)\n\n- Date ì—´ì„ 3 ë¶€ë¶„(ì—°/ì›”/ì¼)ìœ¼ë¡œ ë¶„í• í•˜ê³  Prophet ëª¨ë¸ì„ fittingí•©ë‹ˆë‹¤.\n\n```python\nstock_price['dayname'] = stock_price['ds'].dt.day_name()\nstock_price['month'] = stock_price['ds'].dt.month\nstock_price['year'] = stock_price['ds'].dt.year\nstock_price['month/year'] = stock_price['month'].map(str) + '/' + stock_price['year'].map(str) \n\nstock_price = pd.merge(stock_price, \n                       stock_price['month/year'].drop_duplicates().reset_index(drop=True).reset_index(),\n                       on='month/year',\n                       how='left')\n\nstock_price = stock_price.rename(columns={'index':'month/year_index'})\n\nloop_list = stock_price['month/year'].unique().tolist()\nmax_num = len(loop_list) - 1\nforecast_frames = []\n\nfor num, item in enumerate(loop_list):\n\n    if  num == max_num:\n        pass\n    else:\n        df = stock_price.set_index('ds')[\n             stock_price[stock_price['month/year'] == loop_list[0]]['ds'].min():\\\n             stock_price[stock_price['month/year'] == item]['ds'].max()]\n        \n        df = df.reset_index()[['ds', 'y']]\n        \n        model = Prophet()\n        model.fit(df)\n        \n        future = stock_price[stock_price['month/year_index'] == (num + 1)][['ds']]\n\n        forecast = model.predict(future)\n        forecast_frames.append(forecast)\n```\n\n- In-sample forecastì™€ ì›ë˜ ê°€ê²©ì„ ë¹„êµí•˜ëŠ” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```python\nì£¼ê°€ ì˜ˆì¸¡ = reduce(lambda top, bottom: pd.concat([top, bottom], sort=False), ì˜ˆì¸¡_í”„ë ˆì„)\nì£¼ê°€ ì˜ˆì¸¡ = ì£¼ê°€ ì˜ˆì¸¡[['ì¼ì', 'ì˜ˆì¸¡ê°’', 'ì˜ˆì¸¡ê°’_í•˜í•œ', 'ì˜ˆì¸¡ê°’_ìƒí•œ']]\n\në°ì´í„°í”„ë ˆì„ = pd.merge(ì£¼ê°€[['ì¼ì','ì‹¤ì œê°€ê²©', 'ì›”/ì—°ë„_ì¸ë±ìŠ¤']], ì£¼ê°€ ì˜ˆì¸¡, on='ì¼ì')\në°ì´í„°í”„ë ˆì„['ë³€ë™ë¥ '] = ë°ì´í„°í”„ë ˆì„['ì‹¤ì œê°€ê²©'].pct_change()\në°ì´í„°í”„ë ˆì„.set_index('ì¼ì')[['ì‹¤ì œê°€ê²©', 'ì˜ˆì¸¡ê°’', 'ì˜ˆì¸¡ê°’_í•˜í•œ', 'ì˜ˆì¸¡ê°’_ìƒí•œ']].plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True)\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_18.png)\n\n- êµì°¨ ê²€ì¦ ìˆ˜í–‰ ì¤‘\n\n```python\nfrom prophet.diagnostics import performance_metrics\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤ = performance_metrics(df_cv)\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤.head()\n\n  horizon  mse          rmse      mae     mape mdape smape coverage\n0 37 ì¼    40,821,715.40 6,389.19 4,890.31 0.18 0.12 0.22 0.55\n1 38 ì¼    41,109,990.95 6,411.71 4,913.96 0.18 0.12 0.22 0.55\n2 39 ì¼    41,311,288.83 6,427.39 4,922.43 0.19 0.12 0.22 0.55\n3 40 ì¼    41,641,137.72 6,452.99 4,943.99 0.19 0.12 0.22 0.55\n4 41 ì¼    42,299,834.63 6,503.83 5,003.53 0.19 0.12 0.23 0.54\n\nfrom prophet.plot import plot_cross_validation_metric\nê·¸ë˜í”„ = plot_cross_validation_metric(df_cv, metric='rmse')\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n\n![Plotting MAPE](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_19.png)\n\n- MAPE í”Œë¡œíŒ…\n\n```js\nfig = plot_cross_validation_metric(df_cv, metric='mape')\n```\n\n![MAPE Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_20.png)\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- MAE ê·¸ë˜í”„ í”Œë¡œíŒ…í•˜ê¸°\n\n```js\nfig = plot_cross_validation_metric(df_cv, metric='mae')\n```\n\n![MAE Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_21.png)\n\n- ê·¸ë¦¬ë“œ ê²€ìƒ‰ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” êµ¬í˜„ ë° MAEë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í‰ê°€í•˜ê¸°\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\n# í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì •ì˜\nfrom sklearn.metrics import mean_absolute_error\nparam_grid = {\n    'seasonality_mode': ['additive', 'multiplicative'],\n    'changepoint_prior_scale': [0.01, 0.1, 1, 10],\n    'seasonality_prior_scale': [0.01, 0.1, 1, 10],\n}\n\n# ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë„ìš°ë¯¸ í•¨ìˆ˜\ndef evaluate_model(model, metric_func):\n    df_cv = cross_validation(model, initial='1125 days', period='180 days', horizon='365 days')\n    return metric_func(df_cv['y'], df_cv['yhat'])\n\n# ê·¸ë¦¬ë“œ ì„œì¹˜\nbest_params = {}\nbest_score = float('inf')\n\nfor mode in param_grid['seasonality_mode']:\n    for cps in param_grid['changepoint_prior_scale']:\n        for sps in param_grid['seasonality_prior_scale']:\n            # í˜„ì¬ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ìƒì„±\n            m = Prophet(seasonality_mode=mode, changepoint_prior_scale=cps, seasonality_prior_scale=sps)\n            m.fit(stock_price)\n\n            # í‰ê°€ ì§€í‘œë¡œ í‰ê°€ ëª¨ë¸(Mean Absolute Error ì‚¬ìš©)\n            score = evaluate_model(m, mean_absolute_error)\n\n            # í•„ìš” ì‹œ ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ ì—…ë°ì´íŠ¸\n            if score < best_score:\n                best_score = score\n                best_params = {\n                    'seasonality_mode': mode,\n                    'changepoint_prior_scale': cps,\n                    'seasonality_prior_scale': sps\n                }\n\nprint(best_params)\n\n{'seasonality_mode': 'additive', 'changepoint_prior_scale': 0.1, 'seasonality_prior_scale': 10}\n\nprint(best_score)\n8675.430008099349\n```\n\n- ìµœì í™”ëœ ëª¨ë¸ì„ ì í•©í•˜ê³  1ë…„ ì˜ˆì¸¡ ìƒì„±\n\n```js\n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ ìƒì„±\nm_best = Prophet(seasonality_mode='additive', changepoint_prior_scale=0.1, seasonality_prior_scale=10)\nm_best.fit(stock_price)\n\n# 365ì¼ì„ í¬í•¨í•œ ì˜ˆì¸¡ì„ ìœ„í•œ ë°ì´í„°í”„ë ˆì„\nfuture_best = m_best.make_future_dataframe(periods=365)\nforecast_best = m_best.predict(future_best)\n\n# ì˜ˆì¸¡ ë°ì´í„°ì™€ í•¨ê»˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\nfig1 = m.plot(forecast_best)\nax = fig1.gca()\nax.set_title(\"BTC-USD ì£¼ê°€ ì˜ˆì¸¡\", size=25)\nax.set_xlabel(\"ë‚ ì§œ\", size=15)\nax.set_ylabel(\"ê°€ê²©\", size=15)\n```\n\n![BTC-USD Stock Price Forecast](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_22.png)\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- scikit-learnê³¼ Prophet ì§€í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ QC ìˆ˜í–‰ ì¤‘\n\n```js\n# êµì°¨ ê²€ì¦ ì‹¤í–‰\nfrom sklearn.metrics import mean_squared_error\ndf_cv = cross_validation(m_best, initial='1125 days', period='180 days', horizon='365 days')\n\n# ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°\ndf_metrics = performance_metrics(df_cv)\n\n# MAE, MSE ë° RMSE ê³„ì‚°\nmae = mean_absolute_error(df_cv['y'], df_cv['yhat'])\nmse = mean_squared_error(df_cv['y'], df_cv['yhat'])\nrmse = np.sqrt(mse)\n\nprint(f'í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: {mae:.2f}')\nprint(f'í‰ê·  ì œê³± ì˜¤ì°¨: {mse:.2f}')\nprint(f'ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: {rmse:.2f}')\n\ní‰ê·  ì ˆëŒ€ ì˜¤ì°¨: 8675.43\ní‰ê·  ì œê³± ì˜¤ì°¨: 107375840.73\nì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: 10362.23\n\nfrom prophet.plot import plot_cross_validation_metric\ndf_cv = cross_validation(m_best, initial='1125 days', period='180 days', horizon='365 days')\nfig = plot_cross_validation_metric(df_cv, metric='rmse')\r\n```\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_23.png\" />\n\n- MAPE í”Œë¡œíŒ…í•˜ê¸°\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```python\nfig = plot_cross_validation_metric(df_cv, metric='mape')\n```\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_24.png)\n\n- MAE ê·¸ë¦¬ê¸°\n\n```python\nfig = plot_cross_validation_metric(df_cv, metric='mae')\n```\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_25.png\" />\n\n- In-Sample ë° Out-of-Sample 1ë…„ Prophet ì˜ˆì¸¡ê³¼ ì‹ ë¢° êµ¬ê°„ì„ ë™ì‹œì— í”Œë¡œíŒ…í•©ë‹ˆë‹¤ (ì›ë˜ ìŠ¤ì¼€ì¼)\n\n```js\nloop_list = stock_price['month/year'].unique().tolist()\nmax_num = len(loop_list) - 1\nforecast_frames = []\n\nfor num, item in enumerate(loop_list):\n\n    if num == max_num:\n        pass\n    else:\n        df = stock_price.set_index('ds')[\n             stock_price[stock_price['month/year'] == loop_list[0]]['ds'].min():\\\n             stock_price[stock_price['month/year'] == item]['ds'].max()]\n        \n        df = df.reset_index()[['ds', 'y']]\n        \n        future = stock_price[stock_price['month/year_index'] == (num + 1)][['ds']]\n\n        forecast = m_best.predict(future)\n        forecast_frames.append(forecast)\n\nstock_price_forecast1 = reduce(lambda top, bottom: pd.concat([top, bottom], sort=False), forecast_frames)\nstock_price_forecast1 = stock_price_forecast1[['ds', 'yhat', 'yhat_lower', 'yhat_upper']]\n\ndf1 = pd.merge(stock_price[['ds','y', 'month/year_index']], stock_price_forecast1, on='ds')\ndf1['Percent Change'] = df1['y'].pct_change()\ndf1.set_index('ds')[['y', 'yhat', 'yhat_lower', 'yhat_upper']].plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True)\n```\n\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_26.png\" />\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## ìˆ˜ì •ëœ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµ\n\n- ë‹¤ìŒê³¼ ê°™ì´ Prophetë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ ìˆ˜ì •í•©ì‹œë‹¤.\n\n```js\n#íŠ¸ë ˆì´ë”© ì•Œê³ ë¦¬ì¦˜\ndf=df1.copy()\ndf['Hold'] = (df['Percent Change'] + 1).cumprod()\ndf['Prophet'] = ((df['yhat'].shift(-1) > df['yhat']).shift(1) * (df['Percent Change']) + 1).cumprod()\ndf['Prophet Thresh'] = ((df['y'] < df['yhat_upper']).shift(1) * (df['Percent Change']) + 1).cumprod()\ndf['Seasonality'] = ((~df['ds'].dt.month.isin([8,9])).shift(1) * (df['Percent Change']) + 1).cumprod()\n\n(df.dropna().set_index('ds')[['Hold', 'Prophet', 'Prophet Thresh','Seasonality']] * 1000).plot(figsize=(16,8), grid=True)\n\nprint(f\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\")\nprint(f\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\")\nprint(f\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\")\nprint(f\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\")\n\nHold = 6,090\nProphet = 87,595\nProphet Thresh = 18,681\nSeasonality = 7,172\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_27.png)\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- ì—¬ê¸°ì—ì„œ Prophet Thresh df['y']` df['yhat_lower'] ë¥¼ ì¡°ê±´ df['y']` df['yhat_upper'] ë¡œ ë°”ê¿” ë” ë†’ì€ ì˜ˆìƒ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.\n- ìœ„ì˜ Prophet ì„ê³„ê°’ì„ ìµœì í™”í•´ ë´…ì‹œë‹¤.\n\n```js\nperformance = {}\n\nfor x in np.linspace(.9,.99,10):\n    y = ((df['y'] < df['yhat_upper']*x).shift(1)* (df['í¼ì„¼íŠ¸ ë³€í™”']) + 1).cumprod()\n    performance[x] = y\n    \nbest_yhat = pd.DataFrame(performance).max().idxmax()\npd.DataFrame(performance).plot(figsize=(16,8), grid=True);\nf'ìµœì ì˜ Yhat = {best_yhat:,.2f}'\n\n'ìµœì ì˜ Yhat = 0.92'\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_28.png)\n\n- Best Yhat = 0.92ë¡œ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\r\ndf['Optimized Prophet Thresh'] = ((df['y'] < df['yhat_upper'] * best_yhat).shift(1) * \r\n                                  (df['Percent Change']) + 1).cumprod()\r\n\r\n(df.dropna().set_index('ds')[['Hold', 'Prophet', 'Prophet Thresh', \r\n                              'Seasonality', 'Optimized Prophet Thresh']] * 1000).plot(figsize=(16,8), grid=True)\r\n\r\nprint(f\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Optimized Prophet Thresh = {df['Optimized Prophet Thresh'].iloc[-1]*1000:,.0f}\")\r\n\r\nHold = 6,090\r\nProphet = 87,595\r\nProphet Thresh = 18,681\r\nSeasonality = 7,172\r\nOptimized Prophet Thresh = 36,769\r\n```\r\n\r\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_29.png\" />\r\n\r\n- ìš”ì•½:\r\n    - ROI(Prophet)/ROI(Optimized Prophet Thresh) ì•½ 2.4ë°°\r\n    - ROI(Prophet)/ROI(Hold) ì•½ 14.0ë°°\r\n    - ROI(Optimized Prophet Thresh)/ROI(Prophet Thresh) ì•½ 2.0ë°°\r\n    - ROI(Prophet Thresh)/ROI(Seasonality) ì•½ 2.5ë°°\r\n    - ROI(Seasonality)/ROI(Hold) ì•½ 1.0ë°°\r\n\r\n## í”„ë¡œí• í”Œë¡¯ë¦¬ ì‹œê°í™”ì™€ ë³€ê²½ ì§€ì ë“¤\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- Prophet Plotly ì‹œê°í™” ì˜µì…˜ì„ ì‚´í´ë´…ì‹œë‹¤.\n\n```js\nmydf=stock_price[['ds','y']]\nmm = Prophet()\nmm.fit(mydf)\nfuture = mm.make_future_dataframe(periods=365)\nforecast = mm.predict(future)\nfrom prophet.plot import plot_plotly\n\nplot_plotly(mm, forecast)\n```\n\n![Prophet Plotly Visualization](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_30.png)\n\n- Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ê°’ê³¼ ë³€í™”ì ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nfrom prophet.plot import plot_plotly\n\nplot_plotly(mm, forecast, changepoints=True)\n```\n\n![BTC-USD Price Prediction](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_31.png)\n\n## ê²°ë¡ \n\n- ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Prophet (Facebookì˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.\n- Yahoo Finance Pythonì„ ì‚¬ìš©í•˜ì—¬ 2 ê°œì˜ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤: (1) 2024-07-06ê¹Œì§€ 730 ì¼ ë™ì•ˆ; (2) 2020-01-01ë¶€í„° 2024-07-07ê¹Œì§€.\n- ë°ì´í„° ì„¸íŠ¸ 1ì„ ì‚¬ìš©í•˜ì—¬ Box-Cox ë³€í™˜ê³¼ ë¯¸êµ­ì˜ íœ´ì¼ì„ ê³ ë ¤í•œ HPOë¥¼ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.\n- ë°ì´í„° ì„¸íŠ¸ 2ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ Prophet HPO ì˜ˆì¸¡ì„ 3 ë¶€ë¶„(ì—°ë„, ì›”, ì¼)ìœ¼ë¡œ ë¶„í•  í•œ í›„ ë£¨í”„ë¥¼ í†µí•´ ë‹¤ì¤‘ ê³„ì ˆì„± ì²˜ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\n- Prophet êµì°¨ ê²€ì¦ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ íƒêµ¬í•˜ì—¬ ë‘ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ RMSE, MAPE ë° MAEì™€ ê°™ì€ ì—¬ëŸ¬ ì£¼ìš” ì§€í‘œë¥¼ ë¹„êµí–ˆìŠµë‹ˆë‹¤.\n- ë°ì´í„° ì„¸íŠ¸ 2: ìµœì¢… ì¸ìƒ˜í”Œ Prophet ì˜¤ë¥˜ ì§€í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nMean Absolute Error: 8675.43\nMean Squared Error: 107375840.73\nRoot Mean Squared Error: 10362.23\n```\n\n- ë°ì´í„° ì§‘í•© 2: 350ì¼ ì£¼ê¸°ì˜ ì™¸ë¶€ ìƒ˜í”Œ Prophet HPO ì˜¤ë¥˜ ë©”íŠ¸ë¦­\n\n```js\nMAPE ì•½ 0.2-0.4, (MAE, RMSE) ì•½ 10k-15k\n```\n\n- Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ ì‹œì ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¹˜ë¥¼ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.\n- ë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„° ì§‘í•© 2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìœ ìš©í•œ Prophet ê¸°ë°˜ ë°±í…ŒìŠ¤íŒ… ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ Hold ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.\n- ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ëŠ” ROI(Prophet)/ROI(Hold) ì•½ 14.0ì„ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\n- í…ŒìŠ¤íŠ¸ ê²°ê³¼, Prophet ì¶”ì„¸ê°€ ì™¸ë¶€ ë°ì´í„° ì—†ì´ë„ ì •í™•íˆ ì¶”ì •ë  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì‹œê³„ì—´ì´ ê°•ë ¥í•œ ê³„ì ˆì  ì‚¬ì—…ì£¼ê¸°ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ê³ ë ¤í•  ë•Œ, Prophetê°€ ìƒë‹¹íˆ ì˜ ì‘ë™í•œë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.\n- Prophetì˜ ë‹¤ë¥¸ í†µê³„ ëª¨ë¸ ë° ê¸°ê³„ í•™ìŠµë³´ë‹¤ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í•´ì„ ê°€ëŠ¥ì„±ì…ë‹ˆë‹¤. Prophetì€ ì‹œê°„ ê¸°ëŠ¥ì„ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ì¢‹ì€ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.\n- ì „ë°˜ì ìœ¼ë¡œ, ì‹œê³„ì—´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ê¸°ë¥¼ ë”°ë¼ê°„ë‹¤ë©´ Prophetë¥¼ ê¸°ì¤€ ëª¨ë¸ë¡œ ì‚¬ìš©í•  ê°€ì¹˜ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤ (ì°¸ê³  ìë£Œ ì°¸ì¡°).\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## ì°¸ê³  ìë£Œ\n\n- Facebook Prophetë¥¼ ì‚¬ìš©í•œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡\n- Prophet ì§„ë‹¨\n- Facebook Prophet ì‹œì‘í•˜ê¸°\n- Facebook Prophetë¡œ ì‹œê³„ì—´ ì˜ˆì¸¡\n- FB Prophetë¥¼ ì‚¬ìš©í•œ BTC ê°€ê²© ì˜ˆì¸¡\n\n## ì—°ë½ì²˜\n\n- ì›¹ì‚¬ì´íŠ¸\n- GitHub\n- Facebook\n- X/Twitter\n- Pinterest\n- Mastodon\n- Tumblr\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## ê³ ì§€ì‚¬í•­\n\n- ë‹¤ìŒ ê³ ì§€ëŠ” ë³¸ ê¸€ì˜ ì •ë³´ê°€ êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë˜ì—ˆìŒì„ ëª…í™•íˆí•˜ë©°, ì¬ì • ë˜ëŠ” íˆ¬ì ìë¬¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ëœë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•©ë‹ˆë‹¤.\n- ì œê³µëœ ì •ë³´ëŠ” ê·€í•˜ ê°œì¸ì˜ ì¬ì • ìƒí™©, ëª©í‘œ ë˜ëŠ” ë¦¬ìŠ¤í¬ í—ˆìš©ë„ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n- ê·€í•˜ê°€ ì·¨í•˜ëŠ” íˆ¬ì ê²°ì •ì´ë‚˜ ì¡°ì¹˜ëŠ” ì „ì ìœ¼ë¡œ ê·€í•˜ì˜ ì±…ì„ì…ë‹ˆë‹¤.\n- ì¬ì • ëª©í‘œ, ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ë° íˆ¬ì ê¸°ê°„ì— ë”°ë¼ ì–´ë– í•œ íˆ¬ìì˜ ì í•©ì„±ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•´ì•¼ í•©ë‹ˆë‹¤.\n- íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ë§ì¶¤ ê°€ì´ë“œ ì œê³µì´ ê°€ëŠ¥í•œ ìê²©ì„ ê°–ì¶˜ ì¬ë¬´ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ êµ¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.\n- ì œê³µëœ ë„êµ¬, ë°ì´í„°, ì½˜í…ì¸ , ì •ë³´ëŠ” ë§ì¶¤í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©° ì–´ë–¤ ê°œì¸ì˜ íˆ¬ì ìš”êµ¬ ì‚¬í•­ì— ë¶€í•©í•˜ë„ë¡ ì œê³µëœ ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì •ë³´ ë° êµìœ¡ ëª©ì ë§Œì„ ìœ„í•´ ì œê³µë©ë‹ˆë‹¤.\n\n## ìë£Œ\n\nhttps://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet ë‚˜ì¨\n\n<!-- TIL ìˆ˜í‰ -->\n<ins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nhttps://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting í˜ì´ì§€ë¥¼ ë°©ë¬¸í•´ ë³´ì„¸ìš”! í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ì£¼ì‹ ê°€ê²© ë¶„ì„ ë° ì˜ˆì¸¡ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!","ogImage":{"url":"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png"},"coverImage":"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png","tag":["Tech"],"readingTime":39},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png\">\n<ul>\n<li>ë³¸ ê¸€ì€ ì´ì „ ì—°êµ¬ë¥¼ ì´ì–´ê°€ë©°, Pythonì—ì„œ Facebookì˜ Prophetì„ í™œìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡ì— ëŒ€í•œ ìì„¸í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤ [1â€“5] (ì°¸ê³  ë¬¸í—Œ).</li>\n<li>í˜„ì¬ì˜ ë¹„êµ ë¶„ì„ì€ ì‹œê°„ ì‹œë¦¬ì¦ˆ êµì°¨ ê²€ì¦ QCë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ì¸¡ì •í•˜ëŠ” HPO ë˜ëŠ” ëª¨ë¸ íŠœë‹ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë´…ë‹ˆë‹¤.</li>\n<li>ì‹œë®¬ë ˆì´ì…˜ëœ BTC ì˜ˆì¸¡ì— ì¶”ê°€ë˜ì–´, FB Prophetì„ ì‚¬ìš©í•˜ì—¬ í¬ë¦½í†  ì•Œê³ íŠ¸ë ˆì´ë”© ì „ëµì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ Buy &#x26; Hold ê¸°ì¤€ê³¼ ë¹„êµí•˜ì—¬ ì„¤ëª…í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</li>\n</ul>\n<h2>ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤</h2>\n<ul>\n<li>ì ì ˆí•œ ì•”í˜¸í™”í ì˜ˆì¸¡ì€ í¬ë¦½í†  íŠ¸ë ˆì´ë”ë“¤ì—ê²Œ í° ì´ìµì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆìœ¼ë©° íš¨ê³¼ì ì¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li>ìµœê·¼ BTCëŠ” ë§ì€ ê°€ê²© ì˜ˆì¸¡ì˜ ì£¼ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</li>\n<li>CoinCodex: BTCì˜ ì—­ì‚¬ì ì¸ ê°€ê²© ë³€ë™ê³¼ BTC í•˜í”„ ì‚¬ì´í´ì„ ê¸°ë°˜ìœ¼ë¡œ, BTCê°€ ìƒí•œ ê°€ê²© ëŒ€ìƒì— ë„ë‹¬í•œë‹¤ë©´ 2025ë…„ê¹Œì§€ 201.59%ì˜ ì´ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œí¸, BTCì˜ ê°€ê²©ì€ ë‚´ë…„ì— $173,833ê¹Œì§€ ìƒìŠ¹í•  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.</li>\n<li>í•˜ì§€ë§Œ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ 2030ë…„ê¹Œì§€ 1ë°±ë§Œ ë‹¬ëŸ¬ì— ë„ë‹¬í• ê¹Œìš”?</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>FB Prophetì— ëŒ€í•´</h2>\n<ul>\n<li>FB Prophetì€ ì¶”ì„¸/ê³„ì ˆì„± ëª¨ë¸ë§ê³¼ ë² ì´ì§€ì•ˆ ì¶”ë¡ ì— ê¸°ì´ˆí•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ì ˆì°¨ì…ë‹ˆë‹¤.</li>\n<li>ê°•í•œ ê³„ì ˆ íš¨ê³¼ê°€ ìˆëŠ” ì‹œê³„ì—´ì— ê°€ì¥ ì í•©í•˜ë©°, ëˆ„ë½ ëœ ë°ì´í„°, ì´ìƒì¹˜ ë° ì¶”ì„¸ ë³€ë™ì— ê²¬ê³ í•©ë‹ˆë‹¤.</li>\n<li>ì˜ˆì¸¡ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: ì¶”ì„¸(ì¥ê¸°ê°„ ë™ì•ˆì˜ ë³€í™”), ê³„ì ˆì„±(ì£¼ê¸°ì  ë˜ëŠ” ë‹¨ê¸° ë³€í™”), íœ´ì¼ ë° íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ì—ë§Œ í•´ë‹¹ë˜ëŠ” ì¡°ê±´ë¶€ ë³€ê²½ ì‚¬í•­.</li>\n<li>ìƒˆë¡œìš´ ì‚¬ìš©ìì—ê²Œ íŠ¹íˆ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„±ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.</li>\n<li>ì¶”ê°€ì ì¸ íšŒê·€ ë³€ìˆ˜, ê³±ì…ˆ ê³„ì ˆì„±, ë¹„ì¼ì¼ ë°ì´í„°, ë¶ˆí™•ì‹¤ì„± ì¸¡ì • ë° ì§„ë‹¨ì´ í¬í•¨ë©ë‹ˆë‹¤.</li>\n</ul>\n<p>ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²© ì˜ˆì¸¡ì˜ êµ¬ì²´ì  ë‚´ìš©ì„ ì‚´í´ë´…ì‹œë‹¤.</p>\n<h2>ì£¼ìš” ì„¤ì¹˜ ë°©ë²•</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>pipì€ ì €í¬ê°€ ì„ í˜¸í•˜ëŠ” ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Python 3.4ë¶€í„° Python ì´ì§„ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>\n<li>Jupyter Notebookì„ ì‹¤í–‰í•˜ê³  í•„ìˆ˜ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-python\">!pip install statsmodels, math, yfinance, prophet, plotly,matplotlib, itertools\n</code></pre>\n<h2>Imports &#x26; Settings</h2>\n<ul>\n<li>ì½”ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì´ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n<span class=\"hljs-keyword\">import</span> plotly.<span class=\"hljs-property\">express</span> <span class=\"hljs-keyword\">as</span> px\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">pyplot</span> <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">from</span> math <span class=\"hljs-keyword\">import</span> floor\n<span class=\"hljs-keyword\">from</span> termcolor <span class=\"hljs-keyword\">import</span> colored <span class=\"hljs-keyword\">as</span> cl\n<span class=\"hljs-keyword\">import</span> yfinance <span class=\"hljs-keyword\">as</span> yf\n<span class=\"hljs-keyword\">import</span> datetime\n<span class=\"hljs-keyword\">from</span> datetime <span class=\"hljs-keyword\">import</span> date, timedelta\n\n# <span class=\"hljs-title class_\">Prophet</span> ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°\n<span class=\"hljs-keyword\">from</span> prophet <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Prophet</span>\n\nplt.<span class=\"hljs-property\">rcParams</span>[<span class=\"hljs-string\">'figure.figsize'</span>] = (<span class=\"hljs-number\">12</span>, <span class=\"hljs-number\">6</span>)\nplt.<span class=\"hljs-property\">style</span>.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">'fivethirtyeight'</span>)\n\n<span class=\"hljs-keyword\">import</span> os\nos.<span class=\"hljs-title function_\">chdir</span>(<span class=\"hljs-string\">'ì‘ì—…ê²½ë¡œ'</span>)    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •\nos.<span class=\"hljs-title function_\">getcwd</span>()\n</code></pre>\n<h2>ì£¼ì‹ ë°ì´í„° ì…ë ¥</h2>\n<ul>\n<li>730ì¼ì˜ BTC-USD ì´ë ¥ ë°ì´í„° ì…ë ¥</li>\n</ul>\n<pre><code class=\"hljs language-js\">today = date.<span class=\"hljs-title function_\">today</span>()\n\nd1 = today.<span class=\"hljs-title function_\">strftime</span>(<span class=\"hljs-string\">\"%Y-%m-%d\"</span>)\nend_date = d1\nd2 = date.<span class=\"hljs-title function_\">today</span>() - <span class=\"hljs-title function_\">timedelta</span>(days=<span class=\"hljs-number\">730</span>)\nd2 = d2.<span class=\"hljs-title function_\">strftime</span>(<span class=\"hljs-string\">\"%Y-%m-%d\"</span>)\nstart_date = d2\n\ndata = yf.<span class=\"hljs-title function_\">download</span>(<span class=\"hljs-string\">'BTC-USD'</span>, \n                      start=start_date, \n                      end=end_date, \n                      progress=<span class=\"hljs-title class_\">False</span>)\ndata[<span class=\"hljs-string\">\"Date\"</span>] = data.<span class=\"hljs-property\">index</span>\ndata = data[[<span class=\"hljs-string\">\"Date\"</span>, <span class=\"hljs-string\">\"Open\"</span>, <span class=\"hljs-string\">\"High\"</span>, <span class=\"hljs-string\">\"Low\"</span>, <span class=\"hljs-string\">\"Close\"</span>, <span class=\"hljs-string\">\"Adj Close\"</span>, <span class=\"hljs-string\">\"Volume\"</span>]]\ndata.<span class=\"hljs-title function_\">reset_index</span>(drop=<span class=\"hljs-title class_\">True</span>, inplace=<span class=\"hljs-title class_\">True</span>)\ndata.<span class=\"hljs-title function_\">tail</span>()\n\n|   <span class=\"hljs-title class_\">Date</span>    |    <span class=\"hljs-title class_\">Open</span>    |    <span class=\"hljs-title class_\">High</span>    |   <span class=\"hljs-title class_\">Low</span>    |   <span class=\"hljs-title class_\">Close</span>    |  <span class=\"hljs-title class_\">Adj</span> <span class=\"hljs-title class_\">Close</span>  |   <span class=\"hljs-title class_\">Volume</span>      |\n|----------|------------|------------|---------|------------|-------------|--------------|\n|<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">02</span>| <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">844.41</span>  | <span class=\"hljs-number\">63</span>,<span class=\"hljs-number\">203.36</span>  | <span class=\"hljs-number\">61</span>,<span class=\"hljs-number\">752.75</span>|   <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">029.02</span> |  <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">029.02</span>  |  <span class=\"hljs-number\">20151616992</span>  |\n|<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span>| <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">034</span><span class=\"hljs-number\">.33</span>  | <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">187.70</span>  | <span class=\"hljs-number\">59</span>,<span class=\"hljs-number\">419.39</span>|   <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">173.92</span> |  <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">173.92</span>  |  <span class=\"hljs-number\">29756701685</span>  |\n|<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span>| <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">147.14</span>  | <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">399.68</span>  | <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">777.80</span>|   <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">977.70</span> |  <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">977.70</span>  |  <span class=\"hljs-number\">41149609230</span>  |\n|<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span>| <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">022</span><span class=\"hljs-number\">.81</span>  | <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">497.15</span>  | <span class=\"hljs-number\">53</span>,<span class=\"hljs-number\">717.38</span>|   <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">662.38</span> |  <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">662.38</span>  |  <span class=\"hljs-number\">55417544033</span>  |\n|<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span>| <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">659.07</span>  | <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">472.55</span>  | <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">038.96</span>|   <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">303.54</span> |  <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">303.54</span>  |  <span class=\"hljs-number\">20610320577</span>  |\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ì¢…ê°€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>\n</ul>\n<pre><code class=\"hljs language-js\">plt.<span class=\"hljs-title function_\">plot</span>(data[<span class=\"hljs-string\">'Date'</span>], data[<span class=\"hljs-string\">'Close'</span>])\nplt.<span class=\"hljs-title function_\">xlabel</span>(<span class=\"hljs-string\">'ë‚ ì§œ'</span>)\nplt.<span class=\"hljs-title function_\">ylabel</span>(<span class=\"hljs-string\">'ì¢…ê°€(USD)'</span>)\nplt.<span class=\"hljs-title function_\">title</span>(<span class=\"hljs-string\">'BTC-USD ì¢…ê°€'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_1.png\" alt=\"BTC-USD Close Price\"></p>\n<h2>ë°ì´í„° ì¤€ë¹„</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>Box Cox ë³€í™˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì •ê·œì ì¸ ì¢…ì† ë³€ìˆ˜ì¸ Close ê°€ê²©ì„ ì •ê·œë¶„í¬ í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">### <span class=\"hljs-title class_\">Box</span> <span class=\"hljs-title class_\">Cox</span> ë³€í™˜\n<span class=\"hljs-keyword\">from</span> statsmodels.<span class=\"hljs-property\">base</span>.<span class=\"hljs-property\">transform</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">BoxCox</span>\n\nbc = <span class=\"hljs-title class_\">BoxCox</span>()\ndata[<span class=\"hljs-string\">\"Close\"</span>], lmbda = bc.<span class=\"hljs-title function_\">transform_boxcox</span>(data[<span class=\"hljs-string\">\"Close\"</span>])\n</code></pre>\n<ul>\n<li>Prophetì— ì…ë ¥ ë°ì´í„° ë§Œë“¤ê¸°</li>\n</ul>\n<pre><code class=\"hljs language-js\">data1 = data[[<span class=\"hljs-string\">\"Date\"</span>, <span class=\"hljs-string\">\"Close\"</span>]]\ndata1.<span class=\"hljs-property\">columns</span> = [<span class=\"hljs-string\">\"ds\"</span>, <span class=\"hljs-string\">\"y\"</span>]\n\ndata1.<span class=\"hljs-title function_\">tail</span>()\n\n    ds          y\n<span class=\"hljs-number\">725</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">02</span> <span class=\"hljs-number\">42.381398</span>\n<span class=\"hljs-number\">726</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span> <span class=\"hljs-number\">42.086488</span>\n<span class=\"hljs-number\">727</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span> <span class=\"hljs-number\">41.560999</span>\n<span class=\"hljs-number\">728</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span> <span class=\"hljs-number\">41.507898</span>\n<span class=\"hljs-number\">729</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span> <span class=\"hljs-number\">41.781750</span>\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>Prophetì— ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒì€ í•­ìƒ dsì™€ y ë‘ ê°œì˜ ì—´ì´ ìˆëŠ” ë°ì´í„°í”„ë ˆì„ì…ë‹ˆë‹¤. ds (ë‚ ì§œ) ì—´ì€ Pandasì—ì„œ ì˜ˆìƒí•˜ëŠ” í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‚ ì§œì˜ ê²½ìš° YYYY-MM-DDì´ê³ , íƒ€ì„ìŠ¤íƒ¬í”„ì˜ ê²½ìš° YYYY-MM-DD HH:MM:SSì…ë‹ˆë‹¤. y ì—´ì€ ìˆ«ìì´ì–´ì•¼ í•˜ë©°, ì˜ˆì¸¡í•˜ë ¤ëŠ” ì¸¡ì • ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>\n</ul>\n<h2>Max Capê³¼ 5% í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•œ Prophet</h2>\n<ul>\n<li>ë§¤ë…„ ê³±ì…ˆ ê³„ì ˆì„±ê³¼ ë¡œì§€ìŠ¤í‹± ì„±ì¥ì´ ìˆëŠ” ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">model_param = {\n    <span class=\"hljs-string\">\"daily_seasonality\"</span>: <span class=\"hljs-title class_\">False</span>,\n    <span class=\"hljs-string\">\"weekly_seasonality\"</span>: <span class=\"hljs-title class_\">False</span>,\n    <span class=\"hljs-string\">\"yearly_seasonality\"</span>: <span class=\"hljs-title class_\">True</span>,\n    <span class=\"hljs-string\">\"seasonality_mode\"</span>: <span class=\"hljs-string\">\"multiplicative\"</span>,\n    <span class=\"hljs-string\">\"growth\"</span>: <span class=\"hljs-string\">\"logistic\"</span>\n}\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ê°€ë²• ê³„ì ˆì„± ëª¨ë¸ì„ ì í•©ì‹œí‚¤ë©°, ê³„ì ˆì„±ì˜ ì˜í–¥ì´ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì¶”ì„¸ì— ë”í•´ì§‘ë‹ˆë‹¤. ìœ„ ëª¨ë¸ì—ì„œ ê³„ì ˆì„±ì€ Prophetì´ ê°€ì •í•œ ê²ƒì²˜ëŸ¼ ì¼ì •í•œ ê°€ë²•ì  ìš”ì†Œê°€ ì•„ë‹ˆë¼ ì¶”ì„¸ì™€ í•¨ê»˜ ì¦ê°€í•˜ëŠ” ë‹¤ì¤‘ ê³„ì ˆì„±ì…ë‹ˆë‹¤.</li>\n<li>ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ì˜ˆì¸¡ì„ ìœ„í•´ ì„ í˜• ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ì¥ì„ ì˜ˆì¸¡í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ì •í•œ ìµœëŒ€ ë‹¬ì„± ê°€ëŠ¥ ì§€ì ì´ ìˆìŠµë‹ˆë‹¤: ì´ ì‹œì¥ ê·œëª¨ ë“±. ì´ë¥¼ ìš´ë°˜ ìš©ëŸ‰ì´ë¼ê³ í•˜ë©°, ì˜ˆì¸¡ì€ ì´ ì§€ì ì—ì„œ í¬í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Prophetì€ ì§€ì •ëœ ìš´ë°˜ ìš©ëŸ‰ì„ ê°–ì¶˜ ë¡œì§€ìŠ¤í‹± ì„±ì¥ íŠ¸ë Œë“œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li>ëª¨ë¸ ì‹¤í–‰</li>\n</ul>\n<pre><code class=\"hljs language-js\">model = <span class=\"hljs-title class_\">Prophet</span>(**model_param)\n</code></pre>\n<ul>\n<li>ë¡œì§€ìŠ¤í‹± ì„±ì¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— ëŒ€í•œ ìƒí•œì„  ë˜ëŠ” ìƒí•œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ìƒí•œê°’ì€ ê°€ê²©ì˜ ìµœëŒ€ê°’ì— í‘œì¤€í¸ì°¨ì˜ 5%ë¥¼ ë”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">data1[<span class=\"hljs-string\">'cap'</span>] = data1[<span class=\"hljs-string\">\"y\"</span>].<span class=\"hljs-title function_\">max</span>() + data1[<span class=\"hljs-string\">\"y\"</span>].<span class=\"hljs-title function_\">std</span>() * <span class=\"hljs-number\">0.05</span>\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ëª¨ë¸ì„ ë§ì¶”ëŠ” ì¤‘</li>\n</ul>\n<pre><code class=\"hljs language-js\">model.<span class=\"hljs-title function_\">fit</span>(data1)\n</code></pre>\n<ul>\n<li>ìœ„ì˜ ìº¡ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë‚´ë¶€ ë° 1ë…„ ì¥ê¸° ì˜ˆì¸¡ ìƒì„±</li>\n</ul>\n<pre><code class=\"hljs language-js\">future= model.<span class=\"hljs-title function_\">make_future_dataframe</span>(periods=<span class=\"hljs-number\">365</span>)\n\nfuture[<span class=\"hljs-string\">'cap'</span>] = data1[<span class=\"hljs-string\">'cap'</span>].<span class=\"hljs-title function_\">max</span>()\n\nforecast= model.<span class=\"hljs-title function_\">predict</span>(future)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ (ds-y) ë„ë©”ì¸ ì˜ˆì¸¡ì„ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">model.<span class=\"hljs-title function_\">plot</span>(forecast,figsize=(<span class=\"hljs-number\">14</span>, <span class=\"hljs-number\">8</span>))\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_2.png\" alt=\"BTC-USD ê°€ê²© ì˜ˆì¸¡\"></p>\n<pre><code class=\"hljs language-js\">model.<span class=\"hljs-title function_\">plot_components</span>(forecast,figsize=(<span class=\"hljs-number\">16</span>, <span class=\"hljs-number\">10</span>));\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>ì´ì „ì— ì‚¬ìš©í•˜ë˜ table tagë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.</p>\n<h2>Prophet with Monthly/Quarterly Seasonality &#x26; US Holidays</h2>\n<ul>\n<li>Prophetë¥¼ ì›”ë³„/ë¶„ê¸°ë³„ ê³„ì ˆì„± ë° ë¯¸êµ­ ê³µíœ´ì¼ê³¼ í•¨ê»˜ ì‹¤í–‰ ì¤‘</li>\n</ul>\n<pre><code class=\"hljs language-js\">model = <span class=\"hljs-title class_\">Prophet</span>(**model_param)\n\nmodel.<span class=\"hljs-title function_\">add_seasonality</span>(name=<span class=\"hljs-string\">\"monthly\"</span>, period=<span class=\"hljs-number\">30</span>, fourier_order=<span class=\"hljs-number\">10</span>)\nmodel.<span class=\"hljs-title function_\">add_seasonality</span>(name=<span class=\"hljs-string\">\"quarterly\"</span>, period=<span class=\"hljs-number\">92.25</span>, fourier_order=<span class=\"hljs-number\">10</span>)\n\nmodel.<span class=\"hljs-title function_\">add_country_holidays</span>(<span class=\"hljs-string\">\"US\"</span>)\n\nmodel.<span class=\"hljs-title function_\">fit</span>(data1)\n\n# ë¯¸ë˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±\nfuture = model.<span class=\"hljs-title function_\">make_future_dataframe</span>(periods=<span class=\"hljs-number\">365</span>)\nfuture[<span class=\"hljs-string\">'cap'</span>] = data1[<span class=\"hljs-string\">'cap'</span>].<span class=\"hljs-title function_\">max</span>()\n\nforecast = model.<span class=\"hljs-title function_\">predict</span>(future)\n\n<span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot\n\n<span class=\"hljs-title function_\">plot</span>(model, forecast, figsize=(<span class=\"hljs-number\">14</span>, <span class=\"hljs-number\">8</span>))\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot_components\n\n<span class=\"hljs-title function_\">plot_components</span>(model, forecast, figsize=(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">12</span>))\n</code></pre>\n<p>ìœ„ì˜ ì½”ë“œ ë¸”ë¡ì€ Prophet ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡í•œ ë°ì´í„°ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹œê°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”! ğŸš€</p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤</li>\n</ul>\n<pre><code class=\"hljs language-js\">forecast[<span class=\"hljs-string\">\"yhat\"</span>]=bc.<span class=\"hljs-title function_\">untransform_boxcox</span>(x=forecast[<span class=\"hljs-string\">\"yhat\"</span>], lmbda=lmbda)\nforecast[<span class=\"hljs-string\">\"yhat_lower\"</span>]=bc.<span class=\"hljs-title function_\">untransform_boxcox</span>(x=forecast[<span class=\"hljs-string\">\"yhat_lower\"</span>], lmbda=lmbda)\nforecast[<span class=\"hljs-string\">\"yhat_upper\"</span>]=bc.<span class=\"hljs-title function_\">untransform_boxcox</span>(x=forecast[<span class=\"hljs-string\">\"yhat_upper\"</span>], lmbda=lmbda)\nforecast.<span class=\"hljs-title function_\">plot</span>(x=<span class=\"hljs-string\">\"ds\"</span>, y=[<span class=\"hljs-string\">\"yhat_lower\"</span>, <span class=\"hljs-string\">\"yhat\"</span>, <span class=\"hljs-string\">\"yhat_upper\"</span>])\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7.png\" alt=\"BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7\"></p>\n<ul>\n<li>ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ cutoffë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì˜ ëª‡ ê°€ì§€ ìœ ìš©í•œ í†µê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">diagnostics</span> <span class=\"hljs-keyword\">import</span> cross_validation, performance_metrics\n<span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot_cross_validation_metric\ndf_cv = <span class=\"hljs-title function_\">cross_validation</span>(model, initial=<span class=\"hljs-string\">\"600 days\"</span>, period=<span class=\"hljs-string\">\"30 days\"</span>, horizon=<span class=\"hljs-string\">\"90 days\"</span>)\ncutoffs = pd.<span class=\"hljs-title function_\">to_datetime</span>([<span class=\"hljs-string\">'2022-09-01'</span>, <span class=\"hljs-string\">'2023-05-01'</span>, <span class=\"hljs-string\">'2024-03-01'</span>])\ndf_cv2 = <span class=\"hljs-title function_\">cross_validation</span>(model, cutoffs=cutoffs, horizon=<span class=\"hljs-string\">'90 days'</span>)\nfig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'rmse'</span>)\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_8.png\">\n<ul>\n<li>ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìš”ì•½ ì •ë³´ ì¶œë ¥</li>\n</ul>\n<pre><code class=\"hljs language-js\">df_p = <span class=\"hljs-title function_\">performance_metrics</span>(df_cv2)\ndf_p.<span class=\"hljs-title function_\">head</span>()\n\n    horizon mse      rmse       mae       mape     mdape   smape coverage\n<span class=\"hljs-number\">0</span> <span class=\"hljs-number\">9</span> days <span class=\"hljs-number\">3805.462369</span> <span class=\"hljs-number\">61.688430</span> <span class=\"hljs-number\">29.520999</span> <span class=\"hljs-number\">0.893692</span> <span class=\"hljs-number\">0.118312</span> <span class=\"hljs-number\">0.355870</span> <span class=\"hljs-number\">0.0</span>\n<span class=\"hljs-number\">1</span> <span class=\"hljs-number\">10</span> days <span class=\"hljs-number\">5382.793620</span> <span class=\"hljs-number\">73.367524</span> <span class=\"hljs-number\">37.768231</span> <span class=\"hljs-number\">1.140719</span> <span class=\"hljs-number\">0.168333</span> <span class=\"hljs-number\">0.425770</span> <span class=\"hljs-number\">0.0</span>\n<span class=\"hljs-number\">2</span> <span class=\"hljs-number\">11</span> days <span class=\"hljs-number\">6754.735216</span> <span class=\"hljs-number\">82.187196</span> <span class=\"hljs-number\">45.409934</span> <span class=\"hljs-number\">1.368028</span> <span class=\"hljs-number\">0.286148</span> <span class=\"hljs-number\">0.491224</span> <span class=\"hljs-number\">0.0</span>\n<span class=\"hljs-number\">3</span> <span class=\"hljs-number\">12</span> days <span class=\"hljs-number\">7678.053041</span> <span class=\"hljs-number\">87.624500</span> <span class=\"hljs-number\">51.465541</span> <span class=\"hljs-number\">1.551664</span> <span class=\"hljs-number\">0.352840</span> <span class=\"hljs-number\">0.546114</span> <span class=\"hljs-number\">0.0</span>\n<span class=\"hljs-number\">4</span> <span class=\"hljs-number\">13</span> days <span class=\"hljs-number\">8071.329465</span> <span class=\"hljs-number\">89.840578</span> <span class=\"hljs-number\">55.027843</span> <span class=\"hljs-number\">1.658574</span> <span class=\"hljs-number\">0.426625</span> <span class=\"hljs-number\">0.584601</span> <span class=\"hljs-number\">0.0</span>\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>MAPE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>\n</ul>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'mape'</span>)\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_9.png\">\n<ul>\n<li>MAE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'mae'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_10.png\" alt=\"BTC-USD Price Prediction using FB Prophet with Hyperparameter Optimization Cross-Validation QC Modified Algorithm Trading Strategies\"></p>\n<h2>Hyperparameter Optimization (HPO)</h2>\n<ul>\n<li>Running HPO by adding monthly/quarterly seasonality and US holidays</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\">rmses = <span class=\"hljs-title function_\">list</span>()\n\n# ê° ì¡°í•©ì„ ìˆœíšŒí•©ë‹ˆë‹¤.\n<span class=\"hljs-keyword\">for</span> params <span class=\"hljs-keyword\">in</span> <span class=\"hljs-attr\">all_params</span>:\n    m = <span class=\"hljs-title class_\">Prophet</span>(**params)\n    \n    m = m.<span class=\"hljs-title function_\">add_seasonality</span>(name=<span class=\"hljs-string\">'monthly'</span>, period=<span class=\"hljs-number\">30</span>, fourier_order=<span class=\"hljs-number\">5</span>)\n    m = m.<span class=\"hljs-title function_\">add_seasonality</span>(name=<span class=\"hljs-string\">'quarterly'</span>, period=<span class=\"hljs-number\">92.25</span>, fourier_order=<span class=\"hljs-number\">10</span>)\n\n    m.<span class=\"hljs-title function_\">add_country_holidays</span>(country_name=<span class=\"hljs-string\">'US'</span>)\n    \n    m.<span class=\"hljs-title function_\">fit</span>(data1)\n    \n    df_cv = <span class=\"hljs-title function_\">cross_validation</span>(m, initial=<span class=\"hljs-string\">'500 days'</span>, period=<span class=\"hljs-string\">'180 days'</span>, horizon=<span class=\"hljs-string\">'90 days'</span>)\n    \n    df_p = <span class=\"hljs-title function_\">performance_metrics</span>(df_cv, rolling_window=<span class=\"hljs-number\">1</span>)\n    \n    rmses.<span class=\"hljs-title function_\">append</span>(df_p[<span class=\"hljs-string\">'rmse'</span>].<span class=\"hljs-property\">values</span>[<span class=\"hljs-number\">0</span>])\n    \n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\nbest_params = all_params[np.<span class=\"hljs-title function_\">argmin</span>(rmses)]\n    \n<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"\\nìµœì ì˜ ë§¤ê°œë³€ìˆ˜ëŠ”:\"</span>, best_params)\n</code></pre>\n<ul>\n<li>ìµœì í™”ëœ ëª¨ë¸ì„ í”¼íŒ…í•˜ê³  í•´ë‹¹í•˜ëŠ” ì˜ˆì¸¡ ìƒì„±</li>\n</ul>\n<pre><code class=\"hljs language-js\">model_param1 = {\n    <span class=\"hljs-string\">'daily_seasonality'</span>: <span class=\"hljs-title class_\">False</span>,\n    <span class=\"hljs-string\">'weekly_seasonality'</span>: <span class=\"hljs-title class_\">False</span>,\n    <span class=\"hljs-string\">'yearly_seasonality'</span>: <span class=\"hljs-title class_\">True</span>,\n    <span class=\"hljs-string\">'seasonality_mode'</span>: <span class=\"hljs-string\">'multiplicative'</span>,\n    <span class=\"hljs-string\">'growth'</span>: <span class=\"hljs-string\">'logistic'</span>,\n    <span class=\"hljs-string\">'seasonality_prior_scale'</span>: <span class=\"hljs-number\">0.1</span>,\n    <span class=\"hljs-string\">'changepoint_prior_scale'</span>: <span class=\"hljs-number\">0.01</span>\n}\n\nmodel1 = <span class=\"hljs-title class_\">Prophet</span>(**model_param1)\n\nmodel1.<span class=\"hljs-title function_\">add_country_holidays</span>(<span class=\"hljs-string\">'US'</span>)\n\nmodel1.<span class=\"hljs-title function_\">fit</span>(data1)\n\n# í–¥í›„ ë°ì´í„° í”„ë ˆì„ ìƒì„±\nfuture = model1.<span class=\"hljs-title function_\">make_future_dataframe</span>(periods=<span class=\"hljs-number\">365</span>)\nfuture[<span class=\"hljs-string\">'cap'</span>] = data1[<span class=\"hljs-string\">'cap'</span>].<span class=\"hljs-title function_\">max</span>()\n\nforecast = model1.<span class=\"hljs-title function_\">predict</span>(future)\n</code></pre>\n<ul>\n<li>ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>js\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])</p>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_11.png\">\n<ul>\n<li>ìˆ˜ë™ cutoffë¡œ êµì°¨ ê²€ì¦ QC ì‹¤í–‰ ì¤‘</li>\n</ul>\n<pre><code class=\"hljs language-js\">cutoffs = pd.<span class=\"hljs-title function_\">to_datetime</span>([<span class=\"hljs-string\">'2022-09-01'</span>, <span class=\"hljs-string\">'2023-05-01'</span>, <span class=\"hljs-string\">'2024-03-01'</span>])\ndf_cv2 = <span class=\"hljs-title function_\">cross_validation</span>(model1, cutoffs=cutoffs, horizon=<span class=\"hljs-string\">'90 days'</span>)\nfig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'rmse'</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_12.png\" alt=\"image\"></p>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'mape'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_13.png\" alt=\"image\"></p>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv2, metric=<span class=\"hljs-string\">'mae'</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_14.png\" alt=\"BTC-USD Price Prediction\"></p>\n<h2>2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ BTC-USD ì—­ì‚¬ì  ë°ì´í„° ì¤€ë¹„</h2>\n<ul>\n<li>ë°•ìŠ¤-ì½•ìŠ¤(Box-Cox) ë³€í™˜ì„ í•˜ì§€ ì•Šê³  2020ë…„ 01ì›” 01ì¼ë¶€í„° 2024ë…„ 07ì›” 07ì¼ê¹Œì§€ì˜ BTC-USD ì—­ì‚¬ì  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> prophet <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Prophet</span>\n<span class=\"hljs-keyword\">import</span> matplotlib.<span class=\"hljs-property\">pyplot</span> <span class=\"hljs-keyword\">as</span> plt\n<span class=\"hljs-keyword\">from</span> functools <span class=\"hljs-keyword\">import</span> reduce\n\n%matplotlib inline\n<span class=\"hljs-keyword\">import</span> warnings\nwarnings.<span class=\"hljs-title function_\">filterwarnings</span>(<span class=\"hljs-string\">'ignore'</span>)\n\npd.<span class=\"hljs-property\">options</span>.<span class=\"hljs-property\">display</span>.<span class=\"hljs-property\">float_format</span> = <span class=\"hljs-string\">\"{:,.2f}\"</span>.<span class=\"hljs-property\">format</span>\n\n<span class=\"hljs-keyword\">import</span> yfinance <span class=\"hljs-keyword\">as</span> yf\n\nticker = <span class=\"hljs-string\">'BTC-USD'</span>\nstart_date = <span class=\"hljs-string\">'2020-01-01'</span>\n\nstock_price = yf.<span class=\"hljs-title function_\">download</span>(ticker, start=start_date)\nstock_price[<span class=\"hljs-string\">\"ë‚ ì§œ\"</span>] = stock_price.<span class=\"hljs-property\">index</span>\nstock_price.<span class=\"hljs-title function_\">tail</span>()\n\n           <span class=\"hljs-title class_\">Open</span>      <span class=\"hljs-title class_\">High</span>      <span class=\"hljs-title class_\">Low</span>       <span class=\"hljs-title class_\">Close</span>    <span class=\"hljs-title class_\">Adj</span> <span class=\"hljs-title class_\">Close</span>   <span class=\"hljs-title class_\">Volume</span>      ë‚ ì§œ\n<span class=\"hljs-title class_\">Date</span>       \n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span> <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">034</span><span class=\"hljs-number\">.33</span> <span class=\"hljs-number\">62</span>,<span class=\"hljs-number\">187.70</span> <span class=\"hljs-number\">59</span>,<span class=\"hljs-number\">419.39</span> <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">173.92</span> <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">173.92</span> <span class=\"hljs-number\">29756701685</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span> <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">147.14</span> <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">399.68</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">777.80</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">977.70</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">977.70</span> <span class=\"hljs-number\">41149609230</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span> <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">022</span><span class=\"hljs-number\">.81</span> <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">497.15</span> <span class=\"hljs-number\">53</span>,<span class=\"hljs-number\">717.38</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">662.38</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">662.38</span> <span class=\"hljs-number\">55417544033</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">659.07</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">472.55</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">038.96</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">303.54</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">303.54</span> <span class=\"hljs-number\">20610320577</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">07</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">239.43</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">367.18</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">644.89</span> <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">198.04</span> <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">198.04</span> <span class=\"hljs-number\">19585976320</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">07</span>\n\nstock_price = stock_price[[<span class=\"hljs-string\">'ë‚ ì§œ'</span>,<span class=\"hljs-string\">'Adj Close'</span>]]\n\nstock_price.<span class=\"hljs-property\">columns</span> = [<span class=\"hljs-string\">'ds'</span>, <span class=\"hljs-string\">'y'</span>]\nstock_price.<span class=\"hljs-title function_\">tail</span>()\n\n           ds          y\n<span class=\"hljs-title class_\">Date</span>  \n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">03</span> <span class=\"hljs-number\">60</span>,<span class=\"hljs-number\">173.92</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">04</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">977.70</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span> <span class=\"hljs-number\">56</span>,<span class=\"hljs-number\">662.38</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span> <span class=\"hljs-number\">58</span>,<span class=\"hljs-number\">303.54</span>\n<span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">07</span> <span class=\"hljs-number\">2024</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">07</span> <span class=\"hljs-number\">57</span>,<span class=\"hljs-number\">198.04</span>\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ê¸°ë³¸ Prophet ëª¨ë¸ì„ ì í•©ì‹œí‚¤ê³  2027ë…„ 7ì›” 7ì¼ê¹Œì§€ì˜ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">model = <span class=\"hljs-title class_\">Prophet</span>()\nmodel.<span class=\"hljs-title function_\">fit</span>(stock_price)\nfuture = model.<span class=\"hljs-title function_\">make_future_dataframe</span>(<span class=\"hljs-number\">1095</span>, freq=<span class=\"hljs-string\">'d'</span>)\n\nfuture_boolean = future[<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-title function_\">map</span>(lambda x : <span class=\"hljs-title class_\">True</span> <span class=\"hljs-keyword\">if</span> x.<span class=\"hljs-title function_\">weekday</span>() <span class=\"hljs-keyword\">in</span> <span class=\"hljs-title function_\">range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">5</span>) <span class=\"hljs-keyword\">else</span> <span class=\"hljs-title class_\">False</span>)\nfuture = future[future_boolean] \n\nfuture.<span class=\"hljs-title function_\">tail</span>()\nds\n<span class=\"hljs-number\">2738</span> <span class=\"hljs-number\">2027</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">01</span>\n<span class=\"hljs-number\">2739</span> <span class=\"hljs-number\">2027</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">02</span>\n<span class=\"hljs-number\">2742</span> <span class=\"hljs-number\">2027</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">05</span>\n<span class=\"hljs-number\">2743</span> <span class=\"hljs-number\">2027</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">06</span>\n<span class=\"hljs-number\">2744</span> <span class=\"hljs-number\">2027</span>-<span class=\"hljs-number\">07</span>-<span class=\"hljs-number\">07</span>\n\nforecast = model.<span class=\"hljs-title function_\">predict</span>(future)\n#forecast.<span class=\"hljs-title function_\">tail</span>()\n\nmodel.<span class=\"hljs-title function_\">plot</span>(forecast);\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15.png\" alt=\"BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15\"></p>\n<ul>\n<li>ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>model.plot_components(forecast);</p>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_16.png\" alt=\"Forecast Plot\"></p>\n<ul>\n<li>ì›ë˜ ê°€ê²©ê³¼ ì˜ˆì¸¡ì„ ì‹ ë¢° êµ¬ê°„ê³¼ í•¨ê»˜ ê·¸ë˜í”½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-python\">stock_price_forecast = forecast[[<span class=\"hljs-string\">'ds'</span>, <span class=\"hljs-string\">'yhat'</span>, <span class=\"hljs-string\">'yhat_lower'</span>, <span class=\"hljs-string\">'yhat_upper'</span>]]\ndf = pd.merge(stock_price, stock_price_forecast, on=<span class=\"hljs-string\">'ds'</span>, how=<span class=\"hljs-string\">'right'</span>)\ndf.set_index(<span class=\"hljs-string\">'ds'</span>).plot(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), color=[<span class=\"hljs-string\">'royalblue'</span>, <span class=\"hljs-string\">\"#34495e\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>], grid=<span class=\"hljs-literal\">True</span>);\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_17.png\" alt=\"image\"></p>\n<ul>\n<li>Date ì—´ì„ 3 ë¶€ë¶„(ì—°/ì›”/ì¼)ìœ¼ë¡œ ë¶„í• í•˜ê³  Prophet ëª¨ë¸ì„ fittingí•©ë‹ˆë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-python\">stock_price[<span class=\"hljs-string\">'dayname'</span>] = stock_price[<span class=\"hljs-string\">'ds'</span>].dt.day_name()\nstock_price[<span class=\"hljs-string\">'month'</span>] = stock_price[<span class=\"hljs-string\">'ds'</span>].dt.month\nstock_price[<span class=\"hljs-string\">'year'</span>] = stock_price[<span class=\"hljs-string\">'ds'</span>].dt.year\nstock_price[<span class=\"hljs-string\">'month/year'</span>] = stock_price[<span class=\"hljs-string\">'month'</span>].<span class=\"hljs-built_in\">map</span>(<span class=\"hljs-built_in\">str</span>) + <span class=\"hljs-string\">'/'</span> + stock_price[<span class=\"hljs-string\">'year'</span>].<span class=\"hljs-built_in\">map</span>(<span class=\"hljs-built_in\">str</span>) \n\nstock_price = pd.merge(stock_price, \n                       stock_price[<span class=\"hljs-string\">'month/year'</span>].drop_duplicates().reset_index(drop=<span class=\"hljs-literal\">True</span>).reset_index(),\n                       on=<span class=\"hljs-string\">'month/year'</span>,\n                       how=<span class=\"hljs-string\">'left'</span>)\n\nstock_price = stock_price.rename(columns={<span class=\"hljs-string\">'index'</span>:<span class=\"hljs-string\">'month/year_index'</span>})\n\nloop_list = stock_price[<span class=\"hljs-string\">'month/year'</span>].unique().tolist()\nmax_num = <span class=\"hljs-built_in\">len</span>(loop_list) - <span class=\"hljs-number\">1</span>\nforecast_frames = []\n\n<span class=\"hljs-keyword\">for</span> num, item <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">enumerate</span>(loop_list):\n\n    <span class=\"hljs-keyword\">if</span>  num == max_num:\n        <span class=\"hljs-keyword\">pass</span>\n    <span class=\"hljs-keyword\">else</span>:\n        df = stock_price.set_index(<span class=\"hljs-string\">'ds'</span>)[\n             stock_price[stock_price[<span class=\"hljs-string\">'month/year'</span>] == loop_list[<span class=\"hljs-number\">0</span>]][<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-built_in\">min</span>():\\\n             stock_price[stock_price[<span class=\"hljs-string\">'month/year'</span>] == item][<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-built_in\">max</span>()]\n        \n        df = df.reset_index()[[<span class=\"hljs-string\">'ds'</span>, <span class=\"hljs-string\">'y'</span>]]\n        \n        model = Prophet()\n        model.fit(df)\n        \n        future = stock_price[stock_price[<span class=\"hljs-string\">'month/year_index'</span>] == (num + <span class=\"hljs-number\">1</span>)][[<span class=\"hljs-string\">'ds'</span>]]\n\n        forecast = model.predict(future)\n        forecast_frames.append(forecast)\n</code></pre>\n<ul>\n<li>In-sample forecastì™€ ì›ë˜ ê°€ê²©ì„ ë¹„êµí•˜ëŠ” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-python\">ì£¼ê°€ ì˜ˆì¸¡ = reduce(<span class=\"hljs-keyword\">lambda</span> top, bottom: pd.concat([top, bottom], sort=<span class=\"hljs-literal\">False</span>), ì˜ˆì¸¡_í”„ë ˆì„)\nì£¼ê°€ ì˜ˆì¸¡ = ì£¼ê°€ ì˜ˆì¸¡[[<span class=\"hljs-string\">'ì¼ì'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’_í•˜í•œ'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’_ìƒí•œ'</span>]]\n\në°ì´í„°í”„ë ˆì„ = pd.merge(ì£¼ê°€[[<span class=\"hljs-string\">'ì¼ì'</span>,<span class=\"hljs-string\">'ì‹¤ì œê°€ê²©'</span>, <span class=\"hljs-string\">'ì›”/ì—°ë„_ì¸ë±ìŠ¤'</span>]], ì£¼ê°€ ì˜ˆì¸¡, on=<span class=\"hljs-string\">'ì¼ì'</span>)\në°ì´í„°í”„ë ˆì„[<span class=\"hljs-string\">'ë³€ë™ë¥ '</span>] = ë°ì´í„°í”„ë ˆì„[<span class=\"hljs-string\">'ì‹¤ì œê°€ê²©'</span>].pct_change()\në°ì´í„°í”„ë ˆì„.set_index(<span class=\"hljs-string\">'ì¼ì'</span>)[[<span class=\"hljs-string\">'ì‹¤ì œê°€ê²©'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’_í•˜í•œ'</span>, <span class=\"hljs-string\">'ì˜ˆì¸¡ê°’_ìƒí•œ'</span>]].plot(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), color=[<span class=\"hljs-string\">'royalblue'</span>, <span class=\"hljs-string\">\"#34495e\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>], grid=<span class=\"hljs-literal\">True</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_18.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<ul>\n<li>êµì°¨ ê²€ì¦ ìˆ˜í–‰ ì¤‘</li>\n</ul>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-keyword\">from</span> prophet.diagnostics <span class=\"hljs-keyword\">import</span> performance_metrics\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤ = performance_metrics(df_cv)\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤.head()\n\n  horizon  mse          rmse      mae     mape mdape smape coverage\n<span class=\"hljs-number\">0</span> <span class=\"hljs-number\">37</span> ì¼    <span class=\"hljs-number\">40</span>,<span class=\"hljs-number\">821</span>,<span class=\"hljs-number\">715.40</span> <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">389.19</span> <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">890.31</span> <span class=\"hljs-number\">0.18</span> <span class=\"hljs-number\">0.12</span> <span class=\"hljs-number\">0.22</span> <span class=\"hljs-number\">0.55</span>\n<span class=\"hljs-number\">1</span> <span class=\"hljs-number\">38</span> ì¼    <span class=\"hljs-number\">41</span>,<span class=\"hljs-number\">109</span>,<span class=\"hljs-number\">990.95</span> <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">411.71</span> <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">913.96</span> <span class=\"hljs-number\">0.18</span> <span class=\"hljs-number\">0.12</span> <span class=\"hljs-number\">0.22</span> <span class=\"hljs-number\">0.55</span>\n<span class=\"hljs-number\">2</span> <span class=\"hljs-number\">39</span> ì¼    <span class=\"hljs-number\">41</span>,<span class=\"hljs-number\">311</span>,<span class=\"hljs-number\">288.83</span> <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">427.39</span> <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">922.43</span> <span class=\"hljs-number\">0.19</span> <span class=\"hljs-number\">0.12</span> <span class=\"hljs-number\">0.22</span> <span class=\"hljs-number\">0.55</span>\n<span class=\"hljs-number\">3</span> <span class=\"hljs-number\">40</span> ì¼    <span class=\"hljs-number\">41</span>,<span class=\"hljs-number\">641</span>,<span class=\"hljs-number\">137.72</span> <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">452.99</span> <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">943.99</span> <span class=\"hljs-number\">0.19</span> <span class=\"hljs-number\">0.12</span> <span class=\"hljs-number\">0.22</span> <span class=\"hljs-number\">0.55</span>\n<span class=\"hljs-number\">4</span> <span class=\"hljs-number\">41</span> ì¼    <span class=\"hljs-number\">42</span>,<span class=\"hljs-number\">299</span>,<span class=\"hljs-number\">834.63</span> <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">503.83</span> <span class=\"hljs-number\">5</span>,<span class=\"hljs-number\">003.53</span> <span class=\"hljs-number\">0.19</span> <span class=\"hljs-number\">0.12</span> <span class=\"hljs-number\">0.23</span> <span class=\"hljs-number\">0.54</span>\n\n<span class=\"hljs-keyword\">from</span> prophet.plot <span class=\"hljs-keyword\">import</span> plot_cross_validation_metric\nê·¸ë˜í”„ = plot_cross_validation_metric(df_cv, metric=<span class=\"hljs-string\">'rmse'</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_19.png\" alt=\"Plotting MAPE\"></p>\n<ul>\n<li>MAPE í”Œë¡œíŒ…</li>\n</ul>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv, metric=<span class=\"hljs-string\">'mape'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_20.png\" alt=\"MAPE Plot\"></p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>MAE ê·¸ë˜í”„ í”Œë¡œíŒ…í•˜ê¸°</li>\n</ul>\n<pre><code class=\"hljs language-js\">fig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv, metric=<span class=\"hljs-string\">'mae'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_21.png\" alt=\"MAE Plot\"></p>\n<ul>\n<li>ê·¸ë¦¬ë“œ ê²€ìƒ‰ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” êµ¬í˜„ ë° MAEë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í‰ê°€í•˜ê¸°</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"># í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì •ì˜\n<span class=\"hljs-keyword\">from</span> sklearn.<span class=\"hljs-property\">metrics</span> <span class=\"hljs-keyword\">import</span> mean_absolute_error\nparam_grid = {\n    <span class=\"hljs-string\">'seasonality_mode'</span>: [<span class=\"hljs-string\">'additive'</span>, <span class=\"hljs-string\">'multiplicative'</span>],\n    <span class=\"hljs-string\">'changepoint_prior_scale'</span>: [<span class=\"hljs-number\">0.01</span>, <span class=\"hljs-number\">0.1</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">10</span>],\n    <span class=\"hljs-string\">'seasonality_prior_scale'</span>: [<span class=\"hljs-number\">0.01</span>, <span class=\"hljs-number\">0.1</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">10</span>],\n}\n\n# ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë„ìš°ë¯¸ í•¨ìˆ˜\ndef evaluate_model(model, metric_func):\n    df_cv = <span class=\"hljs-title function_\">cross_validation</span>(model, initial=<span class=\"hljs-string\">'1125 days'</span>, period=<span class=\"hljs-string\">'180 days'</span>, horizon=<span class=\"hljs-string\">'365 days'</span>)\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">metric_func</span>(df_cv[<span class=\"hljs-string\">'y'</span>], df_cv[<span class=\"hljs-string\">'yhat'</span>])\n\n# ê·¸ë¦¬ë“œ ì„œì¹˜\nbest_params = {}\nbest_score = <span class=\"hljs-title function_\">float</span>(<span class=\"hljs-string\">'inf'</span>)\n\n<span class=\"hljs-keyword\">for</span> mode <span class=\"hljs-keyword\">in</span> param_grid[<span class=\"hljs-string\">'seasonality_mode'</span>]:\n    <span class=\"hljs-keyword\">for</span> cps <span class=\"hljs-keyword\">in</span> param_grid[<span class=\"hljs-string\">'changepoint_prior_scale'</span>]:\n        <span class=\"hljs-keyword\">for</span> sps <span class=\"hljs-keyword\">in</span> param_grid[<span class=\"hljs-string\">'seasonality_prior_scale'</span>]:\n            # í˜„ì¬ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ìƒì„±\n            m = <span class=\"hljs-title class_\">Prophet</span>(seasonality_mode=mode, changepoint_prior_scale=cps, seasonality_prior_scale=sps)\n            m.<span class=\"hljs-title function_\">fit</span>(stock_price)\n\n            # í‰ê°€ ì§€í‘œë¡œ í‰ê°€ ëª¨ë¸(<span class=\"hljs-title class_\">Mean</span> <span class=\"hljs-title class_\">Absolute</span> <span class=\"hljs-title class_\">Error</span> ì‚¬ìš©)\n            score = evaluate_model(m, mean_absolute_error)\n\n            # í•„ìš” ì‹œ ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ ì—…ë°ì´íŠ¸\n            <span class=\"hljs-keyword\">if</span> score &#x3C; <span class=\"hljs-attr\">best_score</span>:\n                best_score = score\n                best_params = {\n                    <span class=\"hljs-string\">'seasonality_mode'</span>: mode,\n                    <span class=\"hljs-string\">'changepoint_prior_scale'</span>: cps,\n                    <span class=\"hljs-string\">'seasonality_prior_scale'</span>: sps\n                }\n\n<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-params\">best_params</span>)\n\n{<span class=\"hljs-string\">'seasonality_mode'</span>: <span class=\"hljs-string\">'additive'</span>, <span class=\"hljs-string\">'changepoint_prior_scale'</span>: <span class=\"hljs-number\">0.1</span>, <span class=\"hljs-string\">'seasonality_prior_scale'</span>: <span class=\"hljs-number\">10</span>}\n\n<span class=\"hljs-title function_\">print</span>(best_score)\n<span class=\"hljs-number\">8675.430008099349</span>\n</code></pre>\n<ul>\n<li>ìµœì í™”ëœ ëª¨ë¸ì„ ì í•©í•˜ê³  1ë…„ ì˜ˆì¸¡ ìƒì„±</li>\n</ul>\n<pre><code class=\"hljs language-js\"># ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ ìƒì„±\nm_best = <span class=\"hljs-title class_\">Prophet</span>(seasonality_mode=<span class=\"hljs-string\">'additive'</span>, changepoint_prior_scale=<span class=\"hljs-number\">0.1</span>, seasonality_prior_scale=<span class=\"hljs-number\">10</span>)\nm_best.<span class=\"hljs-title function_\">fit</span>(stock_price)\n\n# <span class=\"hljs-number\">365</span>ì¼ì„ í¬í•¨í•œ ì˜ˆì¸¡ì„ ìœ„í•œ ë°ì´í„°í”„ë ˆì„\nfuture_best = m_best.<span class=\"hljs-title function_\">make_future_dataframe</span>(periods=<span class=\"hljs-number\">365</span>)\nforecast_best = m_best.<span class=\"hljs-title function_\">predict</span>(future_best)\n\n# ì˜ˆì¸¡ ë°ì´í„°ì™€ í•¨ê»˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\nfig1 = m.<span class=\"hljs-title function_\">plot</span>(forecast_best)\nax = fig1.<span class=\"hljs-title function_\">gca</span>()\nax.<span class=\"hljs-title function_\">set_title</span>(<span class=\"hljs-string\">\"BTC-USD ì£¼ê°€ ì˜ˆì¸¡\"</span>, size=<span class=\"hljs-number\">25</span>)\nax.<span class=\"hljs-title function_\">set_xlabel</span>(<span class=\"hljs-string\">\"ë‚ ì§œ\"</span>, size=<span class=\"hljs-number\">15</span>)\nax.<span class=\"hljs-title function_\">set_ylabel</span>(<span class=\"hljs-string\">\"ê°€ê²©\"</span>, size=<span class=\"hljs-number\">15</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_22.png\" alt=\"BTC-USD Stock Price Forecast\"></p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>scikit-learnê³¼ Prophet ì§€í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ QC ìˆ˜í–‰ ì¤‘</li>\n</ul>\n<pre><code class=\"hljs language-js\"># êµì°¨ ê²€ì¦ ì‹¤í–‰\n<span class=\"hljs-keyword\">from</span> sklearn.<span class=\"hljs-property\">metrics</span> <span class=\"hljs-keyword\">import</span> mean_squared_error\ndf_cv = <span class=\"hljs-title function_\">cross_validation</span>(m_best, initial=<span class=\"hljs-string\">'1125 days'</span>, period=<span class=\"hljs-string\">'180 days'</span>, horizon=<span class=\"hljs-string\">'365 days'</span>)\n\n# ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°\ndf_metrics = <span class=\"hljs-title function_\">performance_metrics</span>(df_cv)\n\n# <span class=\"hljs-variable constant_\">MAE</span>, <span class=\"hljs-variable constant_\">MSE</span> ë° <span class=\"hljs-variable constant_\">RMSE</span> ê³„ì‚°\nmae = <span class=\"hljs-title function_\">mean_absolute_error</span>(df_cv[<span class=\"hljs-string\">'y'</span>], df_cv[<span class=\"hljs-string\">'yhat'</span>])\nmse = <span class=\"hljs-title function_\">mean_squared_error</span>(df_cv[<span class=\"hljs-string\">'y'</span>], df_cv[<span class=\"hljs-string\">'yhat'</span>])\nrmse = np.<span class=\"hljs-title function_\">sqrt</span>(mse)\n\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">'í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: {mae:.2f}'</span>)\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">'í‰ê·  ì œê³± ì˜¤ì°¨: {mse:.2f}'</span>)\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">'ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: {rmse:.2f}'</span>)\n\ní‰ê·  ì ˆëŒ€ ì˜¤ì°¨: <span class=\"hljs-number\">8675.43</span>\ní‰ê·  ì œê³± ì˜¤ì°¨: <span class=\"hljs-number\">107375840.73</span>\nì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: <span class=\"hljs-number\">10362.23</span>\n\n<span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot_cross_validation_metric\ndf_cv = <span class=\"hljs-title function_\">cross_validation</span>(m_best, initial=<span class=\"hljs-string\">'1125 days'</span>, period=<span class=\"hljs-string\">'180 days'</span>, horizon=<span class=\"hljs-string\">'365 days'</span>)\nfig = <span class=\"hljs-title function_\">plot_cross_validation_metric</span>(df_cv, metric=<span class=\"hljs-string\">'rmse'</span>)\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_23.png\">\n<ul>\n<li>MAPE í”Œë¡œíŒ…í•˜ê¸°</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-python\">fig = plot_cross_validation_metric(df_cv, metric=<span class=\"hljs-string\">'mape'</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_24.png\" alt=\"image\"></p>\n<ul>\n<li>MAE ê·¸ë¦¬ê¸°</li>\n</ul>\n<pre><code class=\"hljs language-python\">fig = plot_cross_validation_metric(df_cv, metric=<span class=\"hljs-string\">'mae'</span>)\n</code></pre>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_25.png\">\n<ul>\n<li>In-Sample ë° Out-of-Sample 1ë…„ Prophet ì˜ˆì¸¡ê³¼ ì‹ ë¢° êµ¬ê°„ì„ ë™ì‹œì— í”Œë¡œíŒ…í•©ë‹ˆë‹¤ (ì›ë˜ ìŠ¤ì¼€ì¼)</li>\n</ul>\n<pre><code class=\"hljs language-js\">loop_list = stock_price[<span class=\"hljs-string\">'month/year'</span>].<span class=\"hljs-title function_\">unique</span>().<span class=\"hljs-title function_\">tolist</span>()\nmax_num = <span class=\"hljs-title function_\">len</span>(loop_list) - <span class=\"hljs-number\">1</span>\nforecast_frames = []\n\n<span class=\"hljs-keyword\">for</span> num, item <span class=\"hljs-keyword\">in</span> <span class=\"hljs-title function_\">enumerate</span>(loop_list):\n\n    <span class=\"hljs-keyword\">if</span> num == <span class=\"hljs-attr\">max_num</span>:\n        pass\n    <span class=\"hljs-attr\">else</span>:\n        df = stock_price.<span class=\"hljs-title function_\">set_index</span>(<span class=\"hljs-string\">'ds'</span>)[\n             stock_price[stock_price[<span class=\"hljs-string\">'month/year'</span>] == loop_list[<span class=\"hljs-number\">0</span>]][<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-title function_\">min</span>():\\\n             stock_price[stock_price[<span class=\"hljs-string\">'month/year'</span>] == item][<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-title function_\">max</span>()]\n        \n        df = df.<span class=\"hljs-title function_\">reset_index</span>()[[<span class=\"hljs-string\">'ds'</span>, <span class=\"hljs-string\">'y'</span>]]\n        \n        future = stock_price[stock_price[<span class=\"hljs-string\">'month/year_index'</span>] == (num + <span class=\"hljs-number\">1</span>)][[<span class=\"hljs-string\">'ds'</span>]]\n\n        forecast = m_best.<span class=\"hljs-title function_\">predict</span>(future)\n        forecast_frames.<span class=\"hljs-title function_\">append</span>(forecast)\n\nstock_price_forecast1 = <span class=\"hljs-title function_\">reduce</span>(lambda top, <span class=\"hljs-attr\">bottom</span>: pd.<span class=\"hljs-title function_\">concat</span>([top, bottom], sort=<span class=\"hljs-title class_\">False</span>), forecast_frames)\nstock_price_forecast1 = stock_price_forecast1[[<span class=\"hljs-string\">'ds'</span>, <span class=\"hljs-string\">'yhat'</span>, <span class=\"hljs-string\">'yhat_lower'</span>, <span class=\"hljs-string\">'yhat_upper'</span>]]\n\ndf1 = pd.<span class=\"hljs-title function_\">merge</span>(stock_price[[<span class=\"hljs-string\">'ds'</span>,<span class=\"hljs-string\">'y'</span>, <span class=\"hljs-string\">'month/year_index'</span>]], stock_price_forecast1, on=<span class=\"hljs-string\">'ds'</span>)\ndf1[<span class=\"hljs-string\">'Percent Change'</span>] = df1[<span class=\"hljs-string\">'y'</span>].<span class=\"hljs-title function_\">pct_change</span>()\ndf1.<span class=\"hljs-title function_\">set_index</span>(<span class=\"hljs-string\">'ds'</span>)[[<span class=\"hljs-string\">'y'</span>, <span class=\"hljs-string\">'yhat'</span>, <span class=\"hljs-string\">'yhat_lower'</span>, <span class=\"hljs-string\">'yhat_upper'</span>]].<span class=\"hljs-title function_\">plot</span>(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), color=[<span class=\"hljs-string\">'royalblue'</span>, <span class=\"hljs-string\">\"#34495e\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>, <span class=\"hljs-string\">\"#e74c3c\"</span>], grid=<span class=\"hljs-title class_\">True</span>)\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_26.png\">\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>ìˆ˜ì •ëœ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµ</h2>\n<ul>\n<li>ë‹¤ìŒê³¼ ê°™ì´ Prophetë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ ìˆ˜ì •í•©ì‹œë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">#íŠ¸ë ˆì´ë”© ì•Œê³ ë¦¬ì¦˜\ndf=df1.<span class=\"hljs-title function_\">copy</span>()\ndf[<span class=\"hljs-string\">'Hold'</span>] = (df[<span class=\"hljs-string\">'Percent Change'</span>] + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\ndf[<span class=\"hljs-string\">'Prophet'</span>] = ((df[<span class=\"hljs-string\">'yhat'</span>].<span class=\"hljs-title function_\">shift</span>(-<span class=\"hljs-number\">1</span>) > df[<span class=\"hljs-string\">'yhat'</span>]).<span class=\"hljs-title function_\">shift</span>(<span class=\"hljs-number\">1</span>) * (df[<span class=\"hljs-string\">'Percent Change'</span>]) + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\ndf[<span class=\"hljs-string\">'Prophet Thresh'</span>] = ((df[<span class=\"hljs-string\">'y'</span>] &#x3C; df[<span class=\"hljs-string\">'yhat_upper'</span>]).<span class=\"hljs-title function_\">shift</span>(<span class=\"hljs-number\">1</span>) * (df[<span class=\"hljs-string\">'Percent Change'</span>]) + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\ndf[<span class=\"hljs-string\">'Seasonality'</span>] = ((~df[<span class=\"hljs-string\">'ds'</span>].<span class=\"hljs-property\">dt</span>.<span class=\"hljs-property\">month</span>.<span class=\"hljs-title function_\">isin</span>([<span class=\"hljs-number\">8</span>,<span class=\"hljs-number\">9</span>])).<span class=\"hljs-title function_\">shift</span>(<span class=\"hljs-number\">1</span>) * (df[<span class=\"hljs-string\">'Percent Change'</span>]) + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\n\n(df.<span class=\"hljs-title function_\">dropna</span>().<span class=\"hljs-title function_\">set_index</span>(<span class=\"hljs-string\">'ds'</span>)[[<span class=\"hljs-string\">'Hold'</span>, <span class=\"hljs-string\">'Prophet'</span>, <span class=\"hljs-string\">'Prophet Thresh'</span>,<span class=\"hljs-string\">'Seasonality'</span>]] * <span class=\"hljs-number\">1000</span>).<span class=\"hljs-title function_\">plot</span>(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), grid=<span class=\"hljs-title class_\">True</span>)\n\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\"</span>)\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\"</span>)\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\"</span>)\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\"</span>)\n\n<span class=\"hljs-title class_\">Hold</span> = <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">090</span>\n<span class=\"hljs-title class_\">Prophet</span> = <span class=\"hljs-number\">87</span>,<span class=\"hljs-number\">595</span>\n<span class=\"hljs-title class_\">Prophet</span> <span class=\"hljs-title class_\">Thresh</span> = <span class=\"hljs-number\">18</span>,<span class=\"hljs-number\">681</span>\n<span class=\"hljs-title class_\">Seasonality</span> = <span class=\"hljs-number\">7</span>,<span class=\"hljs-number\">172</span>\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_27.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>ì—¬ê¸°ì—ì„œ Prophet Thresh df['y']<code> df['yhat_lower'] ë¥¼ ì¡°ê±´ df['y']</code> df['yhat_upper'] ë¡œ ë°”ê¿” ë” ë†’ì€ ì˜ˆìƒ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</li>\n<li>ìœ„ì˜ Prophet ì„ê³„ê°’ì„ ìµœì í™”í•´ ë´…ì‹œë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">performance = {}\n\n<span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> np.<span class=\"hljs-title function_\">linspace</span>(<span class=\"hljs-number\">.9</span>,<span class=\"hljs-number\">.99</span>,<span class=\"hljs-number\">10</span>):\n    y = ((df[<span class=\"hljs-string\">'y'</span>] &#x3C; df[<span class=\"hljs-string\">'yhat_upper'</span>]*x).<span class=\"hljs-title function_\">shift</span>(<span class=\"hljs-number\">1</span>)* (df[<span class=\"hljs-string\">'í¼ì„¼íŠ¸ ë³€í™”'</span>]) + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\n    performance[x] = y\n    \nbest_yhat = pd.<span class=\"hljs-title class_\">DataFrame</span>(performance).<span class=\"hljs-title function_\">max</span>().<span class=\"hljs-title function_\">idxmax</span>()\npd.<span class=\"hljs-title class_\">DataFrame</span>(performance).<span class=\"hljs-title function_\">plot</span>(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), grid=<span class=\"hljs-title class_\">True</span>);\nf<span class=\"hljs-string\">'ìµœì ì˜ Yhat = {best_yhat:,.2f}'</span>\n\n<span class=\"hljs-string\">'ìµœì ì˜ Yhat = 0.92'</span>\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_28.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<ul>\n<li>Best Yhat = 0.92ë¡œ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\">df[<span class=\"hljs-string\">'Optimized Prophet Thresh'</span>] = ((df[<span class=\"hljs-string\">'y'</span>] &#x3C; df[<span class=\"hljs-string\">'yhat_upper'</span>] * best_yhat).<span class=\"hljs-title function_\">shift</span>(<span class=\"hljs-number\">1</span>) * \r\n                                  (df[<span class=\"hljs-string\">'Percent Change'</span>]) + <span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">cumprod</span>()\r\n\r\n(df.<span class=\"hljs-title function_\">dropna</span>().<span class=\"hljs-title function_\">set_index</span>(<span class=\"hljs-string\">'ds'</span>)[[<span class=\"hljs-string\">'Hold'</span>, <span class=\"hljs-string\">'Prophet'</span>, <span class=\"hljs-string\">'Prophet Thresh'</span>, \r\n                              <span class=\"hljs-string\">'Seasonality'</span>, <span class=\"hljs-string\">'Optimized Prophet Thresh'</span>]] * <span class=\"hljs-number\">1000</span>).<span class=\"hljs-title function_\">plot</span>(figsize=(<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">8</span>), grid=<span class=\"hljs-title class_\">True</span>)\r\n\r\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\"</span>)\r\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\"</span>)\r\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\"</span>)\r\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\"</span>)\r\n<span class=\"hljs-title function_\">print</span>(f<span class=\"hljs-string\">\"Optimized Prophet Thresh = {df['Optimized Prophet Thresh'].iloc[-1]*1000:,.0f}\"</span>)\r\n\r\n<span class=\"hljs-title class_\">Hold</span> = <span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">090</span>\r\n<span class=\"hljs-title class_\">Prophet</span> = <span class=\"hljs-number\">87</span>,<span class=\"hljs-number\">595</span>\r\n<span class=\"hljs-title class_\">Prophet</span> <span class=\"hljs-title class_\">Thresh</span> = <span class=\"hljs-number\">18</span>,<span class=\"hljs-number\">681</span>\r\n<span class=\"hljs-title class_\">Seasonality</span> = <span class=\"hljs-number\">7</span>,<span class=\"hljs-number\">172</span>\r\n<span class=\"hljs-title class_\">Optimized</span> <span class=\"hljs-title class_\">Prophet</span> <span class=\"hljs-title class_\">Thresh</span> = <span class=\"hljs-number\">36</span>,<span class=\"hljs-number\">769</span>\n</code></pre>\n<img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_29.png\">\n<ul>\n<li>ìš”ì•½:\n<ul>\n<li>ROI(Prophet)/ROI(Optimized Prophet Thresh) ì•½ 2.4ë°°</li>\n<li>ROI(Prophet)/ROI(Hold) ì•½ 14.0ë°°</li>\n<li>ROI(Optimized Prophet Thresh)/ROI(Prophet Thresh) ì•½ 2.0ë°°</li>\n<li>ROI(Prophet Thresh)/ROI(Seasonality) ì•½ 2.5ë°°</li>\n<li>ROI(Seasonality)/ROI(Hold) ì•½ 1.0ë°°</li>\n</ul>\n</li>\n</ul>\n<h2>í”„ë¡œí• í”Œë¡¯ë¦¬ ì‹œê°í™”ì™€ ë³€ê²½ ì§€ì ë“¤</h2>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>Prophet Plotly ì‹œê°í™” ì˜µì…˜ì„ ì‚´í´ë´…ì‹œë‹¤.</li>\n</ul>\n<pre><code class=\"hljs language-js\">mydf=stock_price[[<span class=\"hljs-string\">'ds'</span>,<span class=\"hljs-string\">'y'</span>]]\nmm = <span class=\"hljs-title class_\">Prophet</span>()\nmm.<span class=\"hljs-title function_\">fit</span>(mydf)\nfuture = mm.<span class=\"hljs-title function_\">make_future_dataframe</span>(periods=<span class=\"hljs-number\">365</span>)\nforecast = mm.<span class=\"hljs-title function_\">predict</span>(future)\n<span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot_plotly\n\n<span class=\"hljs-title function_\">plot_plotly</span>(mm, forecast)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_30.png\" alt=\"Prophet Plotly Visualization\"></p>\n<ul>\n<li>Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ê°’ê³¼ ë³€í™”ì ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> prophet.<span class=\"hljs-property\">plot</span> <span class=\"hljs-keyword\">import</span> plot_plotly\n\n<span class=\"hljs-title function_\">plot_plotly</span>(mm, forecast, changepoints=<span class=\"hljs-title class_\">True</span>)\n</code></pre>\n<p><img src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_31.png\" alt=\"BTC-USD Price Prediction\"></p>\n<h2>ê²°ë¡ </h2>\n<ul>\n<li>ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Prophet (Facebookì˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.</li>\n<li>Yahoo Finance Pythonì„ ì‚¬ìš©í•˜ì—¬ 2 ê°œì˜ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤: (1) 2024-07-06ê¹Œì§€ 730 ì¼ ë™ì•ˆ; (2) 2020-01-01ë¶€í„° 2024-07-07ê¹Œì§€.</li>\n<li>ë°ì´í„° ì„¸íŠ¸ 1ì„ ì‚¬ìš©í•˜ì—¬ Box-Cox ë³€í™˜ê³¼ ë¯¸êµ­ì˜ íœ´ì¼ì„ ê³ ë ¤í•œ HPOë¥¼ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.</li>\n<li>ë°ì´í„° ì„¸íŠ¸ 2ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ Prophet HPO ì˜ˆì¸¡ì„ 3 ë¶€ë¶„(ì—°ë„, ì›”, ì¼)ìœ¼ë¡œ ë¶„í•  í•œ í›„ ë£¨í”„ë¥¼ í†µí•´ ë‹¤ì¤‘ ê³„ì ˆì„± ì²˜ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.</li>\n<li>Prophet êµì°¨ ê²€ì¦ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ íƒêµ¬í•˜ì—¬ ë‘ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ RMSE, MAPE ë° MAEì™€ ê°™ì€ ì—¬ëŸ¬ ì£¼ìš” ì§€í‘œë¥¼ ë¹„êµí–ˆìŠµë‹ˆë‹¤.</li>\n<li>ë°ì´í„° ì„¸íŠ¸ 2: ìµœì¢… ì¸ìƒ˜í”Œ Prophet ì˜¤ë¥˜ ì§€í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">Mean</span> <span class=\"hljs-title class_\">Absolute</span> <span class=\"hljs-title class_\">Error</span>: <span class=\"hljs-number\">8675.43</span>\n<span class=\"hljs-title class_\">Mean</span> <span class=\"hljs-title class_\">Squared</span> <span class=\"hljs-title class_\">Error</span>: <span class=\"hljs-number\">107375840.73</span>\n<span class=\"hljs-title class_\">Root</span> <span class=\"hljs-title class_\">Mean</span> <span class=\"hljs-title class_\">Squared</span> <span class=\"hljs-title class_\">Error</span>: <span class=\"hljs-number\">10362.23</span>\n</code></pre>\n<ul>\n<li>ë°ì´í„° ì§‘í•© 2: 350ì¼ ì£¼ê¸°ì˜ ì™¸ë¶€ ìƒ˜í”Œ Prophet HPO ì˜¤ë¥˜ ë©”íŠ¸ë¦­</li>\n</ul>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-variable constant_\">MAPE</span> ì•½ <span class=\"hljs-number\">0.2</span>-<span class=\"hljs-number\">0.4</span>, (<span class=\"hljs-variable constant_\">MAE</span>, <span class=\"hljs-variable constant_\">RMSE</span>) ì•½ 10k-15k\n</code></pre>\n<ul>\n<li>Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ ì‹œì ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¹˜ë¥¼ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.</li>\n<li>ë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„° ì§‘í•© 2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìœ ìš©í•œ Prophet ê¸°ë°˜ ë°±í…ŒìŠ¤íŒ… ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ Hold ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.</li>\n<li>ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ëŠ” ROI(Prophet)/ROI(Hold) ì•½ 14.0ì„ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.</li>\n<li>í…ŒìŠ¤íŠ¸ ê²°ê³¼, Prophet ì¶”ì„¸ê°€ ì™¸ë¶€ ë°ì´í„° ì—†ì´ë„ ì •í™•íˆ ì¶”ì •ë  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì‹œê³„ì—´ì´ ê°•ë ¥í•œ ê³„ì ˆì  ì‚¬ì—…ì£¼ê¸°ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ê³ ë ¤í•  ë•Œ, Prophetê°€ ìƒë‹¹íˆ ì˜ ì‘ë™í•œë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.</li>\n<li>Prophetì˜ ë‹¤ë¥¸ í†µê³„ ëª¨ë¸ ë° ê¸°ê³„ í•™ìŠµë³´ë‹¤ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í•´ì„ ê°€ëŠ¥ì„±ì…ë‹ˆë‹¤. Prophetì€ ì‹œê°„ ê¸°ëŠ¥ì„ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ì¢‹ì€ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.</li>\n<li>ì „ë°˜ì ìœ¼ë¡œ, ì‹œê³„ì—´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ê¸°ë¥¼ ë”°ë¼ê°„ë‹¤ë©´ Prophetë¥¼ ê¸°ì¤€ ëª¨ë¸ë¡œ ì‚¬ìš©í•  ê°€ì¹˜ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤ (ì°¸ê³  ìë£Œ ì°¸ì¡°).</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>ì°¸ê³  ìë£Œ</h2>\n<ul>\n<li>Facebook Prophetë¥¼ ì‚¬ìš©í•œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡</li>\n<li>Prophet ì§„ë‹¨</li>\n<li>Facebook Prophet ì‹œì‘í•˜ê¸°</li>\n<li>Facebook Prophetë¡œ ì‹œê³„ì—´ ì˜ˆì¸¡</li>\n<li>FB Prophetë¥¼ ì‚¬ìš©í•œ BTC ê°€ê²© ì˜ˆì¸¡</li>\n</ul>\n<h2>ì—°ë½ì²˜</h2>\n<ul>\n<li>ì›¹ì‚¬ì´íŠ¸</li>\n<li>GitHub</li>\n<li>Facebook</li>\n<li>X/Twitter</li>\n<li>Pinterest</li>\n<li>Mastodon</li>\n<li>Tumblr</li>\n</ul>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>ê³ ì§€ì‚¬í•­</h2>\n<ul>\n<li>ë‹¤ìŒ ê³ ì§€ëŠ” ë³¸ ê¸€ì˜ ì •ë³´ê°€ êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë˜ì—ˆìŒì„ ëª…í™•íˆí•˜ë©°, ì¬ì • ë˜ëŠ” íˆ¬ì ìë¬¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ëœë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•©ë‹ˆë‹¤.</li>\n<li>ì œê³µëœ ì •ë³´ëŠ” ê·€í•˜ ê°œì¸ì˜ ì¬ì • ìƒí™©, ëª©í‘œ ë˜ëŠ” ë¦¬ìŠ¤í¬ í—ˆìš©ë„ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>\n<li>ê·€í•˜ê°€ ì·¨í•˜ëŠ” íˆ¬ì ê²°ì •ì´ë‚˜ ì¡°ì¹˜ëŠ” ì „ì ìœ¼ë¡œ ê·€í•˜ì˜ ì±…ì„ì…ë‹ˆë‹¤.</li>\n<li>ì¬ì • ëª©í‘œ, ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ë° íˆ¬ì ê¸°ê°„ì— ë”°ë¼ ì–´ë– í•œ íˆ¬ìì˜ ì í•©ì„±ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•´ì•¼ í•©ë‹ˆë‹¤.</li>\n<li>íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ë§ì¶¤ ê°€ì´ë“œ ì œê³µì´ ê°€ëŠ¥í•œ ìê²©ì„ ê°–ì¶˜ ì¬ë¬´ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ êµ¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.</li>\n<li>ì œê³µëœ ë„êµ¬, ë°ì´í„°, ì½˜í…ì¸ , ì •ë³´ëŠ” ë§ì¶¤í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©° ì–´ë–¤ ê°œì¸ì˜ íˆ¬ì ìš”êµ¬ ì‚¬í•­ì— ë¶€í•©í•˜ë„ë¡ ì œê³µëœ ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì •ë³´ ë° êµìœ¡ ëª©ì ë§Œì„ ìœ„í•´ ì œê³µë©ë‹ˆë‹¤.</li>\n</ul>\n<h2>ìë£Œ</h2>\n<p><a href=\"https://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet\" rel=\"nofollow\" target=\"_blank\">https://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet</a> ë‚˜ì¨</p>\n<!-- TIL ìˆ˜í‰ -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><a href=\"https://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting\" rel=\"nofollow\" target=\"_blank\">https://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting</a> í˜ì´ì§€ë¥¼ ë°©ë¬¸í•´ ë³´ì„¸ìš”! í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ì£¼ì‹ ê°€ê²© ë¶„ì„ ë° ì˜ˆì¸¡ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!</p>\n</body>\n</html>\n"},"__N_SSG":true}