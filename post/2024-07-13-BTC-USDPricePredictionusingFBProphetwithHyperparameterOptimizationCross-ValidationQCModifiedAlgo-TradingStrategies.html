<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ | TIL</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://13akstjq.github.io/TIL//post/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ | TIL" data-gatsby-head="true"/><meta property="og:title" content="FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ | TIL" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://TIL.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://13akstjq.github.io/TIL//post/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies" data-gatsby-head="true"/><meta name="twitter:title" content="FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ | TIL" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | TIL" data-gatsby-head="true"/><meta name="article:published_time" content="2024-07-13 19:54" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/TIL/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/TIL/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/TIL/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/TIL/favicons/favicon-96x96.png"/><link rel="icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/TIL/favicons/browserconfig.xml"/><link rel="preload" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/TIL/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/TIL/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/TIL/_next/static/chunks/webpack-21ffe88bdca56cba.js" defer=""></script><script src="/TIL/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/TIL/_next/static/chunks/main-a5eeabb286676ce6.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/TIL/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/TIL/_next/static/chunks/463-925361deb4cec4b1.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/post/%5Bslug%5D-9d7ebbd29b9e08ce.js" defer=""></script><script src="/TIL/_next/static/FuXRqV9h16krA5Mvtd6Dn/_buildManifest.js" defer=""></script><script src="/TIL/_next/static/FuXRqV9h16krA5Mvtd6Dn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/TIL">TIL</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/TIL/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/TIL/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">TIL</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jul 13, 2024</span><span class="posts_reading_time__f7YPP">39<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png">
<ul>
<li>ë³¸ ê¸€ì€ ì´ì „ ì—°êµ¬ë¥¼ ì´ì–´ê°€ë©°, Pythonì—ì„œ Facebookì˜ Prophetì„ í™œìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡ì— ëŒ€í•œ ìì„¸í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤ [1â€“5] (ì°¸ê³  ë¬¸í—Œ).</li>
<li>í˜„ì¬ì˜ ë¹„êµ ë¶„ì„ì€ ì‹œê°„ ì‹œë¦¬ì¦ˆ êµì°¨ ê²€ì¦ QCë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ì¸¡ì •í•˜ëŠ” HPO ë˜ëŠ” ëª¨ë¸ íŠœë‹ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë´…ë‹ˆë‹¤.</li>
<li>ì‹œë®¬ë ˆì´ì…˜ëœ BTC ì˜ˆì¸¡ì— ì¶”ê°€ë˜ì–´, FB Prophetì„ ì‚¬ìš©í•˜ì—¬ í¬ë¦½í†  ì•Œê³ íŠ¸ë ˆì´ë”© ì „ëµì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ Buy &#x26; Hold ê¸°ì¤€ê³¼ ë¹„êµí•˜ì—¬ ì„¤ëª…í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</li>
</ul>
<h2>ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤</h2>
<ul>
<li>ì ì ˆí•œ ì•”í˜¸í™”í ì˜ˆì¸¡ì€ í¬ë¦½í†  íŠ¸ë ˆì´ë”ë“¤ì—ê²Œ í° ì´ìµì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆìœ¼ë©° íš¨ê³¼ì ì¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>ìµœê·¼ BTCëŠ” ë§ì€ ê°€ê²© ì˜ˆì¸¡ì˜ ì£¼ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</li>
<li>CoinCodex: BTCì˜ ì—­ì‚¬ì ì¸ ê°€ê²© ë³€ë™ê³¼ BTC í•˜í”„ ì‚¬ì´í´ì„ ê¸°ë°˜ìœ¼ë¡œ, BTCê°€ ìƒí•œ ê°€ê²© ëŒ€ìƒì— ë„ë‹¬í•œë‹¤ë©´ 2025ë…„ê¹Œì§€ 201.59%ì˜ ì´ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œí¸, BTCì˜ ê°€ê²©ì€ ë‚´ë…„ì— $173,833ê¹Œì§€ ìƒìŠ¹í•  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.</li>
<li>í•˜ì§€ë§Œ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ 2030ë…„ê¹Œì§€ 1ë°±ë§Œ ë‹¬ëŸ¬ì— ë„ë‹¬í• ê¹Œìš”?</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>FB Prophetì— ëŒ€í•´</h2>
<ul>
<li>FB Prophetì€ ì¶”ì„¸/ê³„ì ˆì„± ëª¨ë¸ë§ê³¼ ë² ì´ì§€ì•ˆ ì¶”ë¡ ì— ê¸°ì´ˆí•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ì ˆì°¨ì…ë‹ˆë‹¤.</li>
<li>ê°•í•œ ê³„ì ˆ íš¨ê³¼ê°€ ìˆëŠ” ì‹œê³„ì—´ì— ê°€ì¥ ì í•©í•˜ë©°, ëˆ„ë½ ëœ ë°ì´í„°, ì´ìƒì¹˜ ë° ì¶”ì„¸ ë³€ë™ì— ê²¬ê³ í•©ë‹ˆë‹¤.</li>
<li>ì˜ˆì¸¡ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: ì¶”ì„¸(ì¥ê¸°ê°„ ë™ì•ˆì˜ ë³€í™”), ê³„ì ˆì„±(ì£¼ê¸°ì  ë˜ëŠ” ë‹¨ê¸° ë³€í™”), íœ´ì¼ ë° íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ì—ë§Œ í•´ë‹¹ë˜ëŠ” ì¡°ê±´ë¶€ ë³€ê²½ ì‚¬í•­.</li>
<li>ìƒˆë¡œìš´ ì‚¬ìš©ìì—ê²Œ íŠ¹íˆ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„±ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.</li>
<li>ì¶”ê°€ì ì¸ íšŒê·€ ë³€ìˆ˜, ê³±ì…ˆ ê³„ì ˆì„±, ë¹„ì¼ì¼ ë°ì´í„°, ë¶ˆí™•ì‹¤ì„± ì¸¡ì • ë° ì§„ë‹¨ì´ í¬í•¨ë©ë‹ˆë‹¤.</li>
</ul>
<p>ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²© ì˜ˆì¸¡ì˜ êµ¬ì²´ì  ë‚´ìš©ì„ ì‚´í´ë´…ì‹œë‹¤.</p>
<h2>ì£¼ìš” ì„¤ì¹˜ ë°©ë²•</h2>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>pipì€ ì €í¬ê°€ ì„ í˜¸í•˜ëŠ” ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Python 3.4ë¶€í„° Python ì´ì§„ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
<li>Jupyter Notebookì„ ì‹¤í–‰í•˜ê³  í•„ìˆ˜ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-python">!pip install statsmodels, math, yfinance, prophet, plotly,matplotlib, itertools
</code></pre>
<h2>Imports &#x26; Settings</h2>
<ul>
<li>ì½”ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì´ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> plotly.<span class="hljs-property">express</span> <span class="hljs-keyword">as</span> px
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.<span class="hljs-property">pyplot</span> <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> floor
<span class="hljs-keyword">from</span> termcolor <span class="hljs-keyword">import</span> colored <span class="hljs-keyword">as</span> cl
<span class="hljs-keyword">import</span> yfinance <span class="hljs-keyword">as</span> yf
<span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> date, timedelta

# <span class="hljs-title class_">Prophet</span> ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
<span class="hljs-keyword">from</span> prophet <span class="hljs-keyword">import</span> <span class="hljs-title class_">Prophet</span>

plt.<span class="hljs-property">rcParams</span>[<span class="hljs-string">'figure.figsize'</span>] = (<span class="hljs-number">12</span>, <span class="hljs-number">6</span>)
plt.<span class="hljs-property">style</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">'fivethirtyeight'</span>)

<span class="hljs-keyword">import</span> os
os.<span class="hljs-title function_">chdir</span>(<span class="hljs-string">'ì‘ì—…ê²½ë¡œ'</span>)    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
os.<span class="hljs-title function_">getcwd</span>()
</code></pre>
<h2>ì£¼ì‹ ë°ì´í„° ì…ë ¥</h2>
<ul>
<li>730ì¼ì˜ BTC-USD ì´ë ¥ ë°ì´í„° ì…ë ¥</li>
</ul>
<pre><code class="hljs language-js">today = date.<span class="hljs-title function_">today</span>()

d1 = today.<span class="hljs-title function_">strftime</span>(<span class="hljs-string">"%Y-%m-%d"</span>)
end_date = d1
d2 = date.<span class="hljs-title function_">today</span>() - <span class="hljs-title function_">timedelta</span>(days=<span class="hljs-number">730</span>)
d2 = d2.<span class="hljs-title function_">strftime</span>(<span class="hljs-string">"%Y-%m-%d"</span>)
start_date = d2

data = yf.<span class="hljs-title function_">download</span>(<span class="hljs-string">'BTC-USD'</span>, 
                      start=start_date, 
                      end=end_date, 
                      progress=<span class="hljs-title class_">False</span>)
data[<span class="hljs-string">"Date"</span>] = data.<span class="hljs-property">index</span>
data = data[[<span class="hljs-string">"Date"</span>, <span class="hljs-string">"Open"</span>, <span class="hljs-string">"High"</span>, <span class="hljs-string">"Low"</span>, <span class="hljs-string">"Close"</span>, <span class="hljs-string">"Adj Close"</span>, <span class="hljs-string">"Volume"</span>]]
data.<span class="hljs-title function_">reset_index</span>(drop=<span class="hljs-title class_">True</span>, inplace=<span class="hljs-title class_">True</span>)
data.<span class="hljs-title function_">tail</span>()

|   <span class="hljs-title class_">Date</span>    |    <span class="hljs-title class_">Open</span>    |    <span class="hljs-title class_">High</span>    |   <span class="hljs-title class_">Low</span>    |   <span class="hljs-title class_">Close</span>    |  <span class="hljs-title class_">Adj</span> <span class="hljs-title class_">Close</span>  |   <span class="hljs-title class_">Volume</span>      |
|----------|------------|------------|---------|------------|-------------|--------------|
|<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">02</span>| <span class="hljs-number">62</span>,<span class="hljs-number">844.41</span>  | <span class="hljs-number">63</span>,<span class="hljs-number">203.36</span>  | <span class="hljs-number">61</span>,<span class="hljs-number">752.75</span>|   <span class="hljs-number">62</span>,<span class="hljs-number">029.02</span> |  <span class="hljs-number">62</span>,<span class="hljs-number">029.02</span>  |  <span class="hljs-number">20151616992</span>  |
|<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span>| <span class="hljs-number">62</span>,<span class="hljs-number">034</span><span class="hljs-number">.33</span>  | <span class="hljs-number">62</span>,<span class="hljs-number">187.70</span>  | <span class="hljs-number">59</span>,<span class="hljs-number">419.39</span>|   <span class="hljs-number">60</span>,<span class="hljs-number">173.92</span> |  <span class="hljs-number">60</span>,<span class="hljs-number">173.92</span>  |  <span class="hljs-number">29756701685</span>  |
|<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span>| <span class="hljs-number">60</span>,<span class="hljs-number">147.14</span>  | <span class="hljs-number">60</span>,<span class="hljs-number">399.68</span>  | <span class="hljs-number">56</span>,<span class="hljs-number">777.80</span>|   <span class="hljs-number">56</span>,<span class="hljs-number">977.70</span> |  <span class="hljs-number">56</span>,<span class="hljs-number">977.70</span>  |  <span class="hljs-number">41149609230</span>  |
|<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span>| <span class="hljs-number">57</span>,<span class="hljs-number">022</span><span class="hljs-number">.81</span>  | <span class="hljs-number">57</span>,<span class="hljs-number">497.15</span>  | <span class="hljs-number">53</span>,<span class="hljs-number">717.38</span>|   <span class="hljs-number">56</span>,<span class="hljs-number">662.38</span> |  <span class="hljs-number">56</span>,<span class="hljs-number">662.38</span>  |  <span class="hljs-number">55417544033</span>  |
|<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span>| <span class="hljs-number">56</span>,<span class="hljs-number">659.07</span>  | <span class="hljs-number">58</span>,<span class="hljs-number">472.55</span>  | <span class="hljs-number">56</span>,<span class="hljs-number">038.96</span>|   <span class="hljs-number">58</span>,<span class="hljs-number">303.54</span> |  <span class="hljs-number">58</span>,<span class="hljs-number">303.54</span>  |  <span class="hljs-number">20610320577</span>  |
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì¢…ê°€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>
</ul>
<pre><code class="hljs language-js">plt.<span class="hljs-title function_">plot</span>(data[<span class="hljs-string">'Date'</span>], data[<span class="hljs-string">'Close'</span>])
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">'ë‚ ì§œ'</span>)
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">'ì¢…ê°€(USD)'</span>)
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">'BTC-USD ì¢…ê°€'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_1.png" alt="BTC-USD Close Price"></p>
<h2>ë°ì´í„° ì¤€ë¹„</h2>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>Box Cox ë³€í™˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì •ê·œì ì¸ ì¢…ì† ë³€ìˆ˜ì¸ Close ê°€ê²©ì„ ì •ê·œë¶„í¬ í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js">### <span class="hljs-title class_">Box</span> <span class="hljs-title class_">Cox</span> ë³€í™˜
<span class="hljs-keyword">from</span> statsmodels.<span class="hljs-property">base</span>.<span class="hljs-property">transform</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">BoxCox</span>

bc = <span class="hljs-title class_">BoxCox</span>()
data[<span class="hljs-string">"Close"</span>], lmbda = bc.<span class="hljs-title function_">transform_boxcox</span>(data[<span class="hljs-string">"Close"</span>])
</code></pre>
<ul>
<li>Prophetì— ì…ë ¥ ë°ì´í„° ë§Œë“¤ê¸°</li>
</ul>
<pre><code class="hljs language-js">data1 = data[[<span class="hljs-string">"Date"</span>, <span class="hljs-string">"Close"</span>]]
data1.<span class="hljs-property">columns</span> = [<span class="hljs-string">"ds"</span>, <span class="hljs-string">"y"</span>]

data1.<span class="hljs-title function_">tail</span>()

    ds          y
<span class="hljs-number">725</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">02</span> <span class="hljs-number">42.381398</span>
<span class="hljs-number">726</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span> <span class="hljs-number">42.086488</span>
<span class="hljs-number">727</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span> <span class="hljs-number">41.560999</span>
<span class="hljs-number">728</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span> <span class="hljs-number">41.507898</span>
<span class="hljs-number">729</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span> <span class="hljs-number">41.781750</span>
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>Prophetì— ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒì€ í•­ìƒ dsì™€ y ë‘ ê°œì˜ ì—´ì´ ìˆëŠ” ë°ì´í„°í”„ë ˆì„ì…ë‹ˆë‹¤. ds (ë‚ ì§œ) ì—´ì€ Pandasì—ì„œ ì˜ˆìƒí•˜ëŠ” í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‚ ì§œì˜ ê²½ìš° YYYY-MM-DDì´ê³ , íƒ€ì„ìŠ¤íƒ¬í”„ì˜ ê²½ìš° YYYY-MM-DD HH:MM:SSì…ë‹ˆë‹¤. y ì—´ì€ ìˆ«ìì´ì–´ì•¼ í•˜ë©°, ì˜ˆì¸¡í•˜ë ¤ëŠ” ì¸¡ì • ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
</ul>
<h2>Max Capê³¼ 5% í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•œ Prophet</h2>
<ul>
<li>ë§¤ë…„ ê³±ì…ˆ ê³„ì ˆì„±ê³¼ ë¡œì§€ìŠ¤í‹± ì„±ì¥ì´ ìˆëŠ” ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js">model_param = {
    <span class="hljs-string">"daily_seasonality"</span>: <span class="hljs-title class_">False</span>,
    <span class="hljs-string">"weekly_seasonality"</span>: <span class="hljs-title class_">False</span>,
    <span class="hljs-string">"yearly_seasonality"</span>: <span class="hljs-title class_">True</span>,
    <span class="hljs-string">"seasonality_mode"</span>: <span class="hljs-string">"multiplicative"</span>,
    <span class="hljs-string">"growth"</span>: <span class="hljs-string">"logistic"</span>
}
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ê°€ë²• ê³„ì ˆì„± ëª¨ë¸ì„ ì í•©ì‹œí‚¤ë©°, ê³„ì ˆì„±ì˜ ì˜í–¥ì´ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì¶”ì„¸ì— ë”í•´ì§‘ë‹ˆë‹¤. ìœ„ ëª¨ë¸ì—ì„œ ê³„ì ˆì„±ì€ Prophetì´ ê°€ì •í•œ ê²ƒì²˜ëŸ¼ ì¼ì •í•œ ê°€ë²•ì  ìš”ì†Œê°€ ì•„ë‹ˆë¼ ì¶”ì„¸ì™€ í•¨ê»˜ ì¦ê°€í•˜ëŠ” ë‹¤ì¤‘ ê³„ì ˆì„±ì…ë‹ˆë‹¤.</li>
<li>ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ì˜ˆì¸¡ì„ ìœ„í•´ ì„ í˜• ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ì¥ì„ ì˜ˆì¸¡í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ì •í•œ ìµœëŒ€ ë‹¬ì„± ê°€ëŠ¥ ì§€ì ì´ ìˆìŠµë‹ˆë‹¤: ì´ ì‹œì¥ ê·œëª¨ ë“±. ì´ë¥¼ ìš´ë°˜ ìš©ëŸ‰ì´ë¼ê³ í•˜ë©°, ì˜ˆì¸¡ì€ ì´ ì§€ì ì—ì„œ í¬í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Prophetì€ ì§€ì •ëœ ìš´ë°˜ ìš©ëŸ‰ì„ ê°–ì¶˜ ë¡œì§€ìŠ¤í‹± ì„±ì¥ íŠ¸ë Œë“œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>ëª¨ë¸ ì‹¤í–‰</li>
</ul>
<pre><code class="hljs language-js">model = <span class="hljs-title class_">Prophet</span>(**model_param)
</code></pre>
<ul>
<li>ë¡œì§€ìŠ¤í‹± ì„±ì¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— ëŒ€í•œ ìƒí•œì„  ë˜ëŠ” ìƒí•œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ìƒí•œê°’ì€ ê°€ê²©ì˜ ìµœëŒ€ê°’ì— í‘œì¤€í¸ì°¨ì˜ 5%ë¥¼ ë”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js">data1[<span class="hljs-string">'cap'</span>] = data1[<span class="hljs-string">"y"</span>].<span class="hljs-title function_">max</span>() + data1[<span class="hljs-string">"y"</span>].<span class="hljs-title function_">std</span>() * <span class="hljs-number">0.05</span>
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ëª¨ë¸ì„ ë§ì¶”ëŠ” ì¤‘</li>
</ul>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">fit</span>(data1)
</code></pre>
<ul>
<li>ìœ„ì˜ ìº¡ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë‚´ë¶€ ë° 1ë…„ ì¥ê¸° ì˜ˆì¸¡ ìƒì„±</li>
</ul>
<pre><code class="hljs language-js">future= model.<span class="hljs-title function_">make_future_dataframe</span>(periods=<span class="hljs-number">365</span>)

future[<span class="hljs-string">'cap'</span>] = data1[<span class="hljs-string">'cap'</span>].<span class="hljs-title function_">max</span>()

forecast= model.<span class="hljs-title function_">predict</span>(future)
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ (ds-y) ë„ë©”ì¸ ì˜ˆì¸¡ì„ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">plot</span>(forecast,figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">8</span>))
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_2.png" alt="BTC-USD ê°€ê²© ì˜ˆì¸¡"></p>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">plot_components</span>(forecast,figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>));
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì´ì „ì— ì‚¬ìš©í•˜ë˜ table tagë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.</p>
<h2>Prophet with Monthly/Quarterly Seasonality &#x26; US Holidays</h2>
<ul>
<li>Prophetë¥¼ ì›”ë³„/ë¶„ê¸°ë³„ ê³„ì ˆì„± ë° ë¯¸êµ­ ê³µíœ´ì¼ê³¼ í•¨ê»˜ ì‹¤í–‰ ì¤‘</li>
</ul>
<pre><code class="hljs language-js">model = <span class="hljs-title class_">Prophet</span>(**model_param)

model.<span class="hljs-title function_">add_seasonality</span>(name=<span class="hljs-string">"monthly"</span>, period=<span class="hljs-number">30</span>, fourier_order=<span class="hljs-number">10</span>)
model.<span class="hljs-title function_">add_seasonality</span>(name=<span class="hljs-string">"quarterly"</span>, period=<span class="hljs-number">92.25</span>, fourier_order=<span class="hljs-number">10</span>)

model.<span class="hljs-title function_">add_country_holidays</span>(<span class="hljs-string">"US"</span>)

model.<span class="hljs-title function_">fit</span>(data1)

# ë¯¸ë˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±
future = model.<span class="hljs-title function_">make_future_dataframe</span>(periods=<span class="hljs-number">365</span>)
future[<span class="hljs-string">'cap'</span>] = data1[<span class="hljs-string">'cap'</span>].<span class="hljs-title function_">max</span>()

forecast = model.<span class="hljs-title function_">predict</span>(future)

<span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot

<span class="hljs-title function_">plot</span>(model, forecast, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">8</span>))
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot_components

<span class="hljs-title function_">plot_components</span>(model, forecast, figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">12</span>))
</code></pre>
<p>ìœ„ì˜ ì½”ë“œ ë¸”ë¡ì€ Prophet ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡í•œ ë°ì´í„°ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹œê°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”! ğŸš€</p>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤</li>
</ul>
<pre><code class="hljs language-js">forecast[<span class="hljs-string">"yhat"</span>]=bc.<span class="hljs-title function_">untransform_boxcox</span>(x=forecast[<span class="hljs-string">"yhat"</span>], lmbda=lmbda)
forecast[<span class="hljs-string">"yhat_lower"</span>]=bc.<span class="hljs-title function_">untransform_boxcox</span>(x=forecast[<span class="hljs-string">"yhat_lower"</span>], lmbda=lmbda)
forecast[<span class="hljs-string">"yhat_upper"</span>]=bc.<span class="hljs-title function_">untransform_boxcox</span>(x=forecast[<span class="hljs-string">"yhat_upper"</span>], lmbda=lmbda)
forecast.<span class="hljs-title function_">plot</span>(x=<span class="hljs-string">"ds"</span>, y=[<span class="hljs-string">"yhat_lower"</span>, <span class="hljs-string">"yhat"</span>, <span class="hljs-string">"yhat_upper"</span>])
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7.png" alt="BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7"></p>
<ul>
<li>ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ cutoffë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì˜ ëª‡ ê°€ì§€ ìœ ìš©í•œ í†µê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> prophet.<span class="hljs-property">diagnostics</span> <span class="hljs-keyword">import</span> cross_validation, performance_metrics
<span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot_cross_validation_metric
df_cv = <span class="hljs-title function_">cross_validation</span>(model, initial=<span class="hljs-string">"600 days"</span>, period=<span class="hljs-string">"30 days"</span>, horizon=<span class="hljs-string">"90 days"</span>)
cutoffs = pd.<span class="hljs-title function_">to_datetime</span>([<span class="hljs-string">'2022-09-01'</span>, <span class="hljs-string">'2023-05-01'</span>, <span class="hljs-string">'2024-03-01'</span>])
df_cv2 = <span class="hljs-title function_">cross_validation</span>(model, cutoffs=cutoffs, horizon=<span class="hljs-string">'90 days'</span>)
fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'rmse'</span>)
</code></pre>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_8.png">
<ul>
<li>ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìš”ì•½ ì •ë³´ ì¶œë ¥</li>
</ul>
<pre><code class="hljs language-js">df_p = <span class="hljs-title function_">performance_metrics</span>(df_cv2)
df_p.<span class="hljs-title function_">head</span>()

    horizon mse      rmse       mae       mape     mdape   smape coverage
<span class="hljs-number">0</span> <span class="hljs-number">9</span> days <span class="hljs-number">3805.462369</span> <span class="hljs-number">61.688430</span> <span class="hljs-number">29.520999</span> <span class="hljs-number">0.893692</span> <span class="hljs-number">0.118312</span> <span class="hljs-number">0.355870</span> <span class="hljs-number">0.0</span>
<span class="hljs-number">1</span> <span class="hljs-number">10</span> days <span class="hljs-number">5382.793620</span> <span class="hljs-number">73.367524</span> <span class="hljs-number">37.768231</span> <span class="hljs-number">1.140719</span> <span class="hljs-number">0.168333</span> <span class="hljs-number">0.425770</span> <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span> <span class="hljs-number">11</span> days <span class="hljs-number">6754.735216</span> <span class="hljs-number">82.187196</span> <span class="hljs-number">45.409934</span> <span class="hljs-number">1.368028</span> <span class="hljs-number">0.286148</span> <span class="hljs-number">0.491224</span> <span class="hljs-number">0.0</span>
<span class="hljs-number">3</span> <span class="hljs-number">12</span> days <span class="hljs-number">7678.053041</span> <span class="hljs-number">87.624500</span> <span class="hljs-number">51.465541</span> <span class="hljs-number">1.551664</span> <span class="hljs-number">0.352840</span> <span class="hljs-number">0.546114</span> <span class="hljs-number">0.0</span>
<span class="hljs-number">4</span> <span class="hljs-number">13</span> days <span class="hljs-number">8071.329465</span> <span class="hljs-number">89.840578</span> <span class="hljs-number">55.027843</span> <span class="hljs-number">1.658574</span> <span class="hljs-number">0.426625</span> <span class="hljs-number">0.584601</span> <span class="hljs-number">0.0</span>
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>MAPE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>
</ul>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'mape'</span>)
</code></pre>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_9.png">
<ul>
<li>MAE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'mae'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_10.png" alt="BTC-USD Price Prediction using FB Prophet with Hyperparameter Optimization Cross-Validation QC Modified Algorithm Trading Strategies"></p>
<h2>Hyperparameter Optimization (HPO)</h2>
<ul>
<li>Running HPO by adding monthly/quarterly seasonality and US holidays</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">rmses = <span class="hljs-title function_">list</span>()

# ê° ì¡°í•©ì„ ìˆœíšŒí•©ë‹ˆë‹¤.
<span class="hljs-keyword">for</span> params <span class="hljs-keyword">in</span> <span class="hljs-attr">all_params</span>:
    m = <span class="hljs-title class_">Prophet</span>(**params)
    
    m = m.<span class="hljs-title function_">add_seasonality</span>(name=<span class="hljs-string">'monthly'</span>, period=<span class="hljs-number">30</span>, fourier_order=<span class="hljs-number">5</span>)
    m = m.<span class="hljs-title function_">add_seasonality</span>(name=<span class="hljs-string">'quarterly'</span>, period=<span class="hljs-number">92.25</span>, fourier_order=<span class="hljs-number">10</span>)

    m.<span class="hljs-title function_">add_country_holidays</span>(country_name=<span class="hljs-string">'US'</span>)
    
    m.<span class="hljs-title function_">fit</span>(data1)
    
    df_cv = <span class="hljs-title function_">cross_validation</span>(m, initial=<span class="hljs-string">'500 days'</span>, period=<span class="hljs-string">'180 days'</span>, horizon=<span class="hljs-string">'90 days'</span>)
    
    df_p = <span class="hljs-title function_">performance_metrics</span>(df_cv, rolling_window=<span class="hljs-number">1</span>)
    
    rmses.<span class="hljs-title function_">append</span>(df_p[<span class="hljs-string">'rmse'</span>].<span class="hljs-property">values</span>[<span class="hljs-number">0</span>])
    
# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
best_params = all_params[np.<span class="hljs-title function_">argmin</span>(rmses)]
    
<span class="hljs-title function_">print</span>(<span class="hljs-string">"\nìµœì ì˜ ë§¤ê°œë³€ìˆ˜ëŠ”:"</span>, best_params)
</code></pre>
<ul>
<li>ìµœì í™”ëœ ëª¨ë¸ì„ í”¼íŒ…í•˜ê³  í•´ë‹¹í•˜ëŠ” ì˜ˆì¸¡ ìƒì„±</li>
</ul>
<pre><code class="hljs language-js">model_param1 = {
    <span class="hljs-string">'daily_seasonality'</span>: <span class="hljs-title class_">False</span>,
    <span class="hljs-string">'weekly_seasonality'</span>: <span class="hljs-title class_">False</span>,
    <span class="hljs-string">'yearly_seasonality'</span>: <span class="hljs-title class_">True</span>,
    <span class="hljs-string">'seasonality_mode'</span>: <span class="hljs-string">'multiplicative'</span>,
    <span class="hljs-string">'growth'</span>: <span class="hljs-string">'logistic'</span>,
    <span class="hljs-string">'seasonality_prior_scale'</span>: <span class="hljs-number">0.1</span>,
    <span class="hljs-string">'changepoint_prior_scale'</span>: <span class="hljs-number">0.01</span>
}

model1 = <span class="hljs-title class_">Prophet</span>(**model_param1)

model1.<span class="hljs-title function_">add_country_holidays</span>(<span class="hljs-string">'US'</span>)

model1.<span class="hljs-title function_">fit</span>(data1)

# í–¥í›„ ë°ì´í„° í”„ë ˆì„ ìƒì„±
future = model1.<span class="hljs-title function_">make_future_dataframe</span>(periods=<span class="hljs-number">365</span>)
future[<span class="hljs-string">'cap'</span>] = data1[<span class="hljs-string">'cap'</span>].<span class="hljs-title function_">max</span>()

forecast = model1.<span class="hljs-title function_">predict</span>(future)
</code></pre>
<ul>
<li>ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>js
forecast["yhat"]=bc.untransform_boxcox(x=forecast["yhat"], lmbda=lmbda)
forecast["yhat_lower"]=bc.untransform_boxcox(x=forecast["yhat_lower"], lmbda=lmbda)
forecast["yhat_upper"]=bc.untransform_boxcox(x=forecast["yhat_upper"], lmbda=lmbda)
forecast.plot(x="ds", y=["yhat_lower", "yhat", "yhat_upper"])</p>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_11.png">
<ul>
<li>ìˆ˜ë™ cutoffë¡œ êµì°¨ ê²€ì¦ QC ì‹¤í–‰ ì¤‘</li>
</ul>
<pre><code class="hljs language-js">cutoffs = pd.<span class="hljs-title function_">to_datetime</span>([<span class="hljs-string">'2022-09-01'</span>, <span class="hljs-string">'2023-05-01'</span>, <span class="hljs-string">'2024-03-01'</span>])
df_cv2 = <span class="hljs-title function_">cross_validation</span>(model1, cutoffs=cutoffs, horizon=<span class="hljs-string">'90 days'</span>)
fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'rmse'</span>)
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_12.png" alt="image"></p>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'mape'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_13.png" alt="image"></p>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv2, metric=<span class="hljs-string">'mae'</span>)
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_14.png" alt="BTC-USD Price Prediction"></p>
<h2>2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ BTC-USD ì—­ì‚¬ì  ë°ì´í„° ì¤€ë¹„</h2>
<ul>
<li>ë°•ìŠ¤-ì½•ìŠ¤(Box-Cox) ë³€í™˜ì„ í•˜ì§€ ì•Šê³  2020ë…„ 01ì›” 01ì¼ë¶€í„° 2024ë…„ 07ì›” 07ì¼ê¹Œì§€ì˜ BTC-USD ì—­ì‚¬ì  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> prophet <span class="hljs-keyword">import</span> <span class="hljs-title class_">Prophet</span>
<span class="hljs-keyword">import</span> matplotlib.<span class="hljs-property">pyplot</span> <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce

%matplotlib inline
<span class="hljs-keyword">import</span> warnings
warnings.<span class="hljs-title function_">filterwarnings</span>(<span class="hljs-string">'ignore'</span>)

pd.<span class="hljs-property">options</span>.<span class="hljs-property">display</span>.<span class="hljs-property">float_format</span> = <span class="hljs-string">"{:,.2f}"</span>.<span class="hljs-property">format</span>

<span class="hljs-keyword">import</span> yfinance <span class="hljs-keyword">as</span> yf

ticker = <span class="hljs-string">'BTC-USD'</span>
start_date = <span class="hljs-string">'2020-01-01'</span>

stock_price = yf.<span class="hljs-title function_">download</span>(ticker, start=start_date)
stock_price[<span class="hljs-string">"ë‚ ì§œ"</span>] = stock_price.<span class="hljs-property">index</span>
stock_price.<span class="hljs-title function_">tail</span>()

           <span class="hljs-title class_">Open</span>      <span class="hljs-title class_">High</span>      <span class="hljs-title class_">Low</span>       <span class="hljs-title class_">Close</span>    <span class="hljs-title class_">Adj</span> <span class="hljs-title class_">Close</span>   <span class="hljs-title class_">Volume</span>      ë‚ ì§œ
<span class="hljs-title class_">Date</span>       
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span> <span class="hljs-number">62</span>,<span class="hljs-number">034</span><span class="hljs-number">.33</span> <span class="hljs-number">62</span>,<span class="hljs-number">187.70</span> <span class="hljs-number">59</span>,<span class="hljs-number">419.39</span> <span class="hljs-number">60</span>,<span class="hljs-number">173.92</span> <span class="hljs-number">60</span>,<span class="hljs-number">173.92</span> <span class="hljs-number">29756701685</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span> <span class="hljs-number">60</span>,<span class="hljs-number">147.14</span> <span class="hljs-number">60</span>,<span class="hljs-number">399.68</span> <span class="hljs-number">56</span>,<span class="hljs-number">777.80</span> <span class="hljs-number">56</span>,<span class="hljs-number">977.70</span> <span class="hljs-number">56</span>,<span class="hljs-number">977.70</span> <span class="hljs-number">41149609230</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span> <span class="hljs-number">57</span>,<span class="hljs-number">022</span><span class="hljs-number">.81</span> <span class="hljs-number">57</span>,<span class="hljs-number">497.15</span> <span class="hljs-number">53</span>,<span class="hljs-number">717.38</span> <span class="hljs-number">56</span>,<span class="hljs-number">662.38</span> <span class="hljs-number">56</span>,<span class="hljs-number">662.38</span> <span class="hljs-number">55417544033</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span> <span class="hljs-number">56</span>,<span class="hljs-number">659.07</span> <span class="hljs-number">58</span>,<span class="hljs-number">472.55</span> <span class="hljs-number">56</span>,<span class="hljs-number">038.96</span> <span class="hljs-number">58</span>,<span class="hljs-number">303.54</span> <span class="hljs-number">58</span>,<span class="hljs-number">303.54</span> <span class="hljs-number">20610320577</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span> <span class="hljs-number">58</span>,<span class="hljs-number">239.43</span> <span class="hljs-number">58</span>,<span class="hljs-number">367.18</span> <span class="hljs-number">56</span>,<span class="hljs-number">644.89</span> <span class="hljs-number">57</span>,<span class="hljs-number">198.04</span> <span class="hljs-number">57</span>,<span class="hljs-number">198.04</span> <span class="hljs-number">19585976320</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span>

stock_price = stock_price[[<span class="hljs-string">'ë‚ ì§œ'</span>,<span class="hljs-string">'Adj Close'</span>]]

stock_price.<span class="hljs-property">columns</span> = [<span class="hljs-string">'ds'</span>, <span class="hljs-string">'y'</span>]
stock_price.<span class="hljs-title function_">tail</span>()

           ds          y
<span class="hljs-title class_">Date</span>  
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">03</span> <span class="hljs-number">60</span>,<span class="hljs-number">173.92</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">04</span> <span class="hljs-number">56</span>,<span class="hljs-number">977.70</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span> <span class="hljs-number">56</span>,<span class="hljs-number">662.38</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span> <span class="hljs-number">58</span>,<span class="hljs-number">303.54</span>
<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span> <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span> <span class="hljs-number">57</span>,<span class="hljs-number">198.04</span>
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ê¸°ë³¸ Prophet ëª¨ë¸ì„ ì í•©ì‹œí‚¤ê³  2027ë…„ 7ì›” 7ì¼ê¹Œì§€ì˜ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-js">model = <span class="hljs-title class_">Prophet</span>()
model.<span class="hljs-title function_">fit</span>(stock_price)
future = model.<span class="hljs-title function_">make_future_dataframe</span>(<span class="hljs-number">1095</span>, freq=<span class="hljs-string">'d'</span>)

future_boolean = future[<span class="hljs-string">'ds'</span>].<span class="hljs-title function_">map</span>(lambda x : <span class="hljs-title class_">True</span> <span class="hljs-keyword">if</span> x.<span class="hljs-title function_">weekday</span>() <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-title class_">False</span>)
future = future[future_boolean] 

future.<span class="hljs-title function_">tail</span>()
ds
<span class="hljs-number">2738</span> <span class="hljs-number">2027</span>-<span class="hljs-number">07</span>-<span class="hljs-number">01</span>
<span class="hljs-number">2739</span> <span class="hljs-number">2027</span>-<span class="hljs-number">07</span>-<span class="hljs-number">02</span>
<span class="hljs-number">2742</span> <span class="hljs-number">2027</span>-<span class="hljs-number">07</span>-<span class="hljs-number">05</span>
<span class="hljs-number">2743</span> <span class="hljs-number">2027</span>-<span class="hljs-number">07</span>-<span class="hljs-number">06</span>
<span class="hljs-number">2744</span> <span class="hljs-number">2027</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span>

forecast = model.<span class="hljs-title function_">predict</span>(future)
#forecast.<span class="hljs-title function_">tail</span>()

model.<span class="hljs-title function_">plot</span>(forecast);
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15.png" alt="BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15"></p>
<ul>
<li>ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>model.plot_components(forecast);</p>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_16.png" alt="Forecast Plot"></p>
<ul>
<li>ì›ë˜ ê°€ê²©ê³¼ ì˜ˆì¸¡ì„ ì‹ ë¢° êµ¬ê°„ê³¼ í•¨ê»˜ ê·¸ë˜í”½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-python">stock_price_forecast = forecast[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'yhat'</span>, <span class="hljs-string">'yhat_lower'</span>, <span class="hljs-string">'yhat_upper'</span>]]
df = pd.merge(stock_price, stock_price_forecast, on=<span class="hljs-string">'ds'</span>, how=<span class="hljs-string">'right'</span>)
df.set_index(<span class="hljs-string">'ds'</span>).plot(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), color=[<span class="hljs-string">'royalblue'</span>, <span class="hljs-string">"#34495e"</span>, <span class="hljs-string">"#e74c3c"</span>, <span class="hljs-string">"#e74c3c"</span>], grid=<span class="hljs-literal">True</span>);
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_17.png" alt="image"></p>
<ul>
<li>Date ì—´ì„ 3 ë¶€ë¶„(ì—°/ì›”/ì¼)ìœ¼ë¡œ ë¶„í• í•˜ê³  Prophet ëª¨ë¸ì„ fittingí•©ë‹ˆë‹¤.</li>
</ul>
<pre><code class="hljs language-python">stock_price[<span class="hljs-string">'dayname'</span>] = stock_price[<span class="hljs-string">'ds'</span>].dt.day_name()
stock_price[<span class="hljs-string">'month'</span>] = stock_price[<span class="hljs-string">'ds'</span>].dt.month
stock_price[<span class="hljs-string">'year'</span>] = stock_price[<span class="hljs-string">'ds'</span>].dt.year
stock_price[<span class="hljs-string">'month/year'</span>] = stock_price[<span class="hljs-string">'month'</span>].<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>) + <span class="hljs-string">'/'</span> + stock_price[<span class="hljs-string">'year'</span>].<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>) 

stock_price = pd.merge(stock_price, 
                       stock_price[<span class="hljs-string">'month/year'</span>].drop_duplicates().reset_index(drop=<span class="hljs-literal">True</span>).reset_index(),
                       on=<span class="hljs-string">'month/year'</span>,
                       how=<span class="hljs-string">'left'</span>)

stock_price = stock_price.rename(columns={<span class="hljs-string">'index'</span>:<span class="hljs-string">'month/year_index'</span>})

loop_list = stock_price[<span class="hljs-string">'month/year'</span>].unique().tolist()
max_num = <span class="hljs-built_in">len</span>(loop_list) - <span class="hljs-number">1</span>
forecast_frames = []

<span class="hljs-keyword">for</span> num, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(loop_list):

    <span class="hljs-keyword">if</span>  num == max_num:
        <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">else</span>:
        df = stock_price.set_index(<span class="hljs-string">'ds'</span>)[
             stock_price[stock_price[<span class="hljs-string">'month/year'</span>] == loop_list[<span class="hljs-number">0</span>]][<span class="hljs-string">'ds'</span>].<span class="hljs-built_in">min</span>():\
             stock_price[stock_price[<span class="hljs-string">'month/year'</span>] == item][<span class="hljs-string">'ds'</span>].<span class="hljs-built_in">max</span>()]
        
        df = df.reset_index()[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'y'</span>]]
        
        model = Prophet()
        model.fit(df)
        
        future = stock_price[stock_price[<span class="hljs-string">'month/year_index'</span>] == (num + <span class="hljs-number">1</span>)][[<span class="hljs-string">'ds'</span>]]

        forecast = model.predict(future)
        forecast_frames.append(forecast)
</code></pre>
<ul>
<li>In-sample forecastì™€ ì›ë˜ ê°€ê²©ì„ ë¹„êµí•˜ëŠ” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-python">ì£¼ê°€ ì˜ˆì¸¡ = reduce(<span class="hljs-keyword">lambda</span> top, bottom: pd.concat([top, bottom], sort=<span class="hljs-literal">False</span>), ì˜ˆì¸¡_í”„ë ˆì„)
ì£¼ê°€ ì˜ˆì¸¡ = ì£¼ê°€ ì˜ˆì¸¡[[<span class="hljs-string">'ì¼ì'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’_í•˜í•œ'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’_ìƒí•œ'</span>]]

ë°ì´í„°í”„ë ˆì„ = pd.merge(ì£¼ê°€[[<span class="hljs-string">'ì¼ì'</span>,<span class="hljs-string">'ì‹¤ì œê°€ê²©'</span>, <span class="hljs-string">'ì›”/ì—°ë„_ì¸ë±ìŠ¤'</span>]], ì£¼ê°€ ì˜ˆì¸¡, on=<span class="hljs-string">'ì¼ì'</span>)
ë°ì´í„°í”„ë ˆì„[<span class="hljs-string">'ë³€ë™ë¥ '</span>] = ë°ì´í„°í”„ë ˆì„[<span class="hljs-string">'ì‹¤ì œê°€ê²©'</span>].pct_change()
ë°ì´í„°í”„ë ˆì„.set_index(<span class="hljs-string">'ì¼ì'</span>)[[<span class="hljs-string">'ì‹¤ì œê°€ê²©'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’_í•˜í•œ'</span>, <span class="hljs-string">'ì˜ˆì¸¡ê°’_ìƒí•œ'</span>]].plot(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), color=[<span class="hljs-string">'royalblue'</span>, <span class="hljs-string">"#34495e"</span>, <span class="hljs-string">"#e74c3c"</span>, <span class="hljs-string">"#e74c3c"</span>], grid=<span class="hljs-literal">True</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_18.png" alt="ì´ë¯¸ì§€"></p>
<ul>
<li>êµì°¨ ê²€ì¦ ìˆ˜í–‰ ì¤‘</li>
</ul>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> prophet.diagnostics <span class="hljs-keyword">import</span> performance_metrics
ì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤ = performance_metrics(df_cv)
ì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤.head()

  horizon  mse          rmse      mae     mape mdape smape coverage
<span class="hljs-number">0</span> <span class="hljs-number">37</span> ì¼    <span class="hljs-number">40</span>,<span class="hljs-number">821</span>,<span class="hljs-number">715.40</span> <span class="hljs-number">6</span>,<span class="hljs-number">389.19</span> <span class="hljs-number">4</span>,<span class="hljs-number">890.31</span> <span class="hljs-number">0.18</span> <span class="hljs-number">0.12</span> <span class="hljs-number">0.22</span> <span class="hljs-number">0.55</span>
<span class="hljs-number">1</span> <span class="hljs-number">38</span> ì¼    <span class="hljs-number">41</span>,<span class="hljs-number">109</span>,<span class="hljs-number">990.95</span> <span class="hljs-number">6</span>,<span class="hljs-number">411.71</span> <span class="hljs-number">4</span>,<span class="hljs-number">913.96</span> <span class="hljs-number">0.18</span> <span class="hljs-number">0.12</span> <span class="hljs-number">0.22</span> <span class="hljs-number">0.55</span>
<span class="hljs-number">2</span> <span class="hljs-number">39</span> ì¼    <span class="hljs-number">41</span>,<span class="hljs-number">311</span>,<span class="hljs-number">288.83</span> <span class="hljs-number">6</span>,<span class="hljs-number">427.39</span> <span class="hljs-number">4</span>,<span class="hljs-number">922.43</span> <span class="hljs-number">0.19</span> <span class="hljs-number">0.12</span> <span class="hljs-number">0.22</span> <span class="hljs-number">0.55</span>
<span class="hljs-number">3</span> <span class="hljs-number">40</span> ì¼    <span class="hljs-number">41</span>,<span class="hljs-number">641</span>,<span class="hljs-number">137.72</span> <span class="hljs-number">6</span>,<span class="hljs-number">452.99</span> <span class="hljs-number">4</span>,<span class="hljs-number">943.99</span> <span class="hljs-number">0.19</span> <span class="hljs-number">0.12</span> <span class="hljs-number">0.22</span> <span class="hljs-number">0.55</span>
<span class="hljs-number">4</span> <span class="hljs-number">41</span> ì¼    <span class="hljs-number">42</span>,<span class="hljs-number">299</span>,<span class="hljs-number">834.63</span> <span class="hljs-number">6</span>,<span class="hljs-number">503.83</span> <span class="hljs-number">5</span>,<span class="hljs-number">003.53</span> <span class="hljs-number">0.19</span> <span class="hljs-number">0.12</span> <span class="hljs-number">0.23</span> <span class="hljs-number">0.54</span>

<span class="hljs-keyword">from</span> prophet.plot <span class="hljs-keyword">import</span> plot_cross_validation_metric
ê·¸ë˜í”„ = plot_cross_validation_metric(df_cv, metric=<span class="hljs-string">'rmse'</span>)
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_19.png" alt="Plotting MAPE"></p>
<ul>
<li>MAPE í”Œë¡œíŒ…</li>
</ul>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv, metric=<span class="hljs-string">'mape'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_20.png" alt="MAPE Plot"></p>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>MAE ê·¸ë˜í”„ í”Œë¡œíŒ…í•˜ê¸°</li>
</ul>
<pre><code class="hljs language-js">fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv, metric=<span class="hljs-string">'mae'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_21.png" alt="MAE Plot"></p>
<ul>
<li>ê·¸ë¦¬ë“œ ê²€ìƒ‰ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” êµ¬í˜„ ë° MAEë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í‰ê°€í•˜ê¸°</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"># í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì •ì˜
<span class="hljs-keyword">from</span> sklearn.<span class="hljs-property">metrics</span> <span class="hljs-keyword">import</span> mean_absolute_error
param_grid = {
    <span class="hljs-string">'seasonality_mode'</span>: [<span class="hljs-string">'additive'</span>, <span class="hljs-string">'multiplicative'</span>],
    <span class="hljs-string">'changepoint_prior_scale'</span>: [<span class="hljs-number">0.01</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
    <span class="hljs-string">'seasonality_prior_scale'</span>: [<span class="hljs-number">0.01</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
}

# ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë„ìš°ë¯¸ í•¨ìˆ˜
def evaluate_model(model, metric_func):
    df_cv = <span class="hljs-title function_">cross_validation</span>(model, initial=<span class="hljs-string">'1125 days'</span>, period=<span class="hljs-string">'180 days'</span>, horizon=<span class="hljs-string">'365 days'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">metric_func</span>(df_cv[<span class="hljs-string">'y'</span>], df_cv[<span class="hljs-string">'yhat'</span>])

# ê·¸ë¦¬ë“œ ì„œì¹˜
best_params = {}
best_score = <span class="hljs-title function_">float</span>(<span class="hljs-string">'inf'</span>)

<span class="hljs-keyword">for</span> mode <span class="hljs-keyword">in</span> param_grid[<span class="hljs-string">'seasonality_mode'</span>]:
    <span class="hljs-keyword">for</span> cps <span class="hljs-keyword">in</span> param_grid[<span class="hljs-string">'changepoint_prior_scale'</span>]:
        <span class="hljs-keyword">for</span> sps <span class="hljs-keyword">in</span> param_grid[<span class="hljs-string">'seasonality_prior_scale'</span>]:
            # í˜„ì¬ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ìƒì„±
            m = <span class="hljs-title class_">Prophet</span>(seasonality_mode=mode, changepoint_prior_scale=cps, seasonality_prior_scale=sps)
            m.<span class="hljs-title function_">fit</span>(stock_price)

            # í‰ê°€ ì§€í‘œë¡œ í‰ê°€ ëª¨ë¸(<span class="hljs-title class_">Mean</span> <span class="hljs-title class_">Absolute</span> <span class="hljs-title class_">Error</span> ì‚¬ìš©)
            score = evaluate_model(m, mean_absolute_error)

            # í•„ìš” ì‹œ ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ ì—…ë°ì´íŠ¸
            <span class="hljs-keyword">if</span> score &#x3C; <span class="hljs-attr">best_score</span>:
                best_score = score
                best_params = {
                    <span class="hljs-string">'seasonality_mode'</span>: mode,
                    <span class="hljs-string">'changepoint_prior_scale'</span>: cps,
                    <span class="hljs-string">'seasonality_prior_scale'</span>: sps
                }

<span class="hljs-title function_">print</span>(<span class="hljs-params">best_params</span>)

{<span class="hljs-string">'seasonality_mode'</span>: <span class="hljs-string">'additive'</span>, <span class="hljs-string">'changepoint_prior_scale'</span>: <span class="hljs-number">0.1</span>, <span class="hljs-string">'seasonality_prior_scale'</span>: <span class="hljs-number">10</span>}

<span class="hljs-title function_">print</span>(best_score)
<span class="hljs-number">8675.430008099349</span>
</code></pre>
<ul>
<li>ìµœì í™”ëœ ëª¨ë¸ì„ ì í•©í•˜ê³  1ë…„ ì˜ˆì¸¡ ìƒì„±</li>
</ul>
<pre><code class="hljs language-js"># ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ ìƒì„±
m_best = <span class="hljs-title class_">Prophet</span>(seasonality_mode=<span class="hljs-string">'additive'</span>, changepoint_prior_scale=<span class="hljs-number">0.1</span>, seasonality_prior_scale=<span class="hljs-number">10</span>)
m_best.<span class="hljs-title function_">fit</span>(stock_price)

# <span class="hljs-number">365</span>ì¼ì„ í¬í•¨í•œ ì˜ˆì¸¡ì„ ìœ„í•œ ë°ì´í„°í”„ë ˆì„
future_best = m_best.<span class="hljs-title function_">make_future_dataframe</span>(periods=<span class="hljs-number">365</span>)
forecast_best = m_best.<span class="hljs-title function_">predict</span>(future_best)

# ì˜ˆì¸¡ ë°ì´í„°ì™€ í•¨ê»˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
fig1 = m.<span class="hljs-title function_">plot</span>(forecast_best)
ax = fig1.<span class="hljs-title function_">gca</span>()
ax.<span class="hljs-title function_">set_title</span>(<span class="hljs-string">"BTC-USD ì£¼ê°€ ì˜ˆì¸¡"</span>, size=<span class="hljs-number">25</span>)
ax.<span class="hljs-title function_">set_xlabel</span>(<span class="hljs-string">"ë‚ ì§œ"</span>, size=<span class="hljs-number">15</span>)
ax.<span class="hljs-title function_">set_ylabel</span>(<span class="hljs-string">"ê°€ê²©"</span>, size=<span class="hljs-number">15</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_22.png" alt="BTC-USD Stock Price Forecast"></p>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>scikit-learnê³¼ Prophet ì§€í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ QC ìˆ˜í–‰ ì¤‘</li>
</ul>
<pre><code class="hljs language-js"># êµì°¨ ê²€ì¦ ì‹¤í–‰
<span class="hljs-keyword">from</span> sklearn.<span class="hljs-property">metrics</span> <span class="hljs-keyword">import</span> mean_squared_error
df_cv = <span class="hljs-title function_">cross_validation</span>(m_best, initial=<span class="hljs-string">'1125 days'</span>, period=<span class="hljs-string">'180 days'</span>, horizon=<span class="hljs-string">'365 days'</span>)

# ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°
df_metrics = <span class="hljs-title function_">performance_metrics</span>(df_cv)

# <span class="hljs-variable constant_">MAE</span>, <span class="hljs-variable constant_">MSE</span> ë° <span class="hljs-variable constant_">RMSE</span> ê³„ì‚°
mae = <span class="hljs-title function_">mean_absolute_error</span>(df_cv[<span class="hljs-string">'y'</span>], df_cv[<span class="hljs-string">'yhat'</span>])
mse = <span class="hljs-title function_">mean_squared_error</span>(df_cv[<span class="hljs-string">'y'</span>], df_cv[<span class="hljs-string">'yhat'</span>])
rmse = np.<span class="hljs-title function_">sqrt</span>(mse)

<span class="hljs-title function_">print</span>(f<span class="hljs-string">'í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: {mae:.2f}'</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">'í‰ê·  ì œê³± ì˜¤ì°¨: {mse:.2f}'</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">'ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: {rmse:.2f}'</span>)

í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: <span class="hljs-number">8675.43</span>
í‰ê·  ì œê³± ì˜¤ì°¨: <span class="hljs-number">107375840.73</span>
ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: <span class="hljs-number">10362.23</span>

<span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot_cross_validation_metric
df_cv = <span class="hljs-title function_">cross_validation</span>(m_best, initial=<span class="hljs-string">'1125 days'</span>, period=<span class="hljs-string">'180 days'</span>, horizon=<span class="hljs-string">'365 days'</span>)
fig = <span class="hljs-title function_">plot_cross_validation_metric</span>(df_cv, metric=<span class="hljs-string">'rmse'</span>)
</code></pre>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_23.png">
<ul>
<li>MAPE í”Œë¡œíŒ…í•˜ê¸°</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-python">fig = plot_cross_validation_metric(df_cv, metric=<span class="hljs-string">'mape'</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_24.png" alt="image"></p>
<ul>
<li>MAE ê·¸ë¦¬ê¸°</li>
</ul>
<pre><code class="hljs language-python">fig = plot_cross_validation_metric(df_cv, metric=<span class="hljs-string">'mae'</span>)
</code></pre>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_25.png">
<ul>
<li>In-Sample ë° Out-of-Sample 1ë…„ Prophet ì˜ˆì¸¡ê³¼ ì‹ ë¢° êµ¬ê°„ì„ ë™ì‹œì— í”Œë¡œíŒ…í•©ë‹ˆë‹¤ (ì›ë˜ ìŠ¤ì¼€ì¼)</li>
</ul>
<pre><code class="hljs language-js">loop_list = stock_price[<span class="hljs-string">'month/year'</span>].<span class="hljs-title function_">unique</span>().<span class="hljs-title function_">tolist</span>()
max_num = <span class="hljs-title function_">len</span>(loop_list) - <span class="hljs-number">1</span>
forecast_frames = []

<span class="hljs-keyword">for</span> num, item <span class="hljs-keyword">in</span> <span class="hljs-title function_">enumerate</span>(loop_list):

    <span class="hljs-keyword">if</span> num == <span class="hljs-attr">max_num</span>:
        pass
    <span class="hljs-attr">else</span>:
        df = stock_price.<span class="hljs-title function_">set_index</span>(<span class="hljs-string">'ds'</span>)[
             stock_price[stock_price[<span class="hljs-string">'month/year'</span>] == loop_list[<span class="hljs-number">0</span>]][<span class="hljs-string">'ds'</span>].<span class="hljs-title function_">min</span>():\
             stock_price[stock_price[<span class="hljs-string">'month/year'</span>] == item][<span class="hljs-string">'ds'</span>].<span class="hljs-title function_">max</span>()]
        
        df = df.<span class="hljs-title function_">reset_index</span>()[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'y'</span>]]
        
        future = stock_price[stock_price[<span class="hljs-string">'month/year_index'</span>] == (num + <span class="hljs-number">1</span>)][[<span class="hljs-string">'ds'</span>]]

        forecast = m_best.<span class="hljs-title function_">predict</span>(future)
        forecast_frames.<span class="hljs-title function_">append</span>(forecast)

stock_price_forecast1 = <span class="hljs-title function_">reduce</span>(lambda top, <span class="hljs-attr">bottom</span>: pd.<span class="hljs-title function_">concat</span>([top, bottom], sort=<span class="hljs-title class_">False</span>), forecast_frames)
stock_price_forecast1 = stock_price_forecast1[[<span class="hljs-string">'ds'</span>, <span class="hljs-string">'yhat'</span>, <span class="hljs-string">'yhat_lower'</span>, <span class="hljs-string">'yhat_upper'</span>]]

df1 = pd.<span class="hljs-title function_">merge</span>(stock_price[[<span class="hljs-string">'ds'</span>,<span class="hljs-string">'y'</span>, <span class="hljs-string">'month/year_index'</span>]], stock_price_forecast1, on=<span class="hljs-string">'ds'</span>)
df1[<span class="hljs-string">'Percent Change'</span>] = df1[<span class="hljs-string">'y'</span>].<span class="hljs-title function_">pct_change</span>()
df1.<span class="hljs-title function_">set_index</span>(<span class="hljs-string">'ds'</span>)[[<span class="hljs-string">'y'</span>, <span class="hljs-string">'yhat'</span>, <span class="hljs-string">'yhat_lower'</span>, <span class="hljs-string">'yhat_upper'</span>]].<span class="hljs-title function_">plot</span>(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), color=[<span class="hljs-string">'royalblue'</span>, <span class="hljs-string">"#34495e"</span>, <span class="hljs-string">"#e74c3c"</span>, <span class="hljs-string">"#e74c3c"</span>], grid=<span class="hljs-title class_">True</span>)
</code></pre>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_26.png">
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>ìˆ˜ì •ëœ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµ</h2>
<ul>
<li>ë‹¤ìŒê³¼ ê°™ì´ Prophetë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ ìˆ˜ì •í•©ì‹œë‹¤.</li>
</ul>
<pre><code class="hljs language-js">#íŠ¸ë ˆì´ë”© ì•Œê³ ë¦¬ì¦˜
df=df1.<span class="hljs-title function_">copy</span>()
df[<span class="hljs-string">'Hold'</span>] = (df[<span class="hljs-string">'Percent Change'</span>] + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()
df[<span class="hljs-string">'Prophet'</span>] = ((df[<span class="hljs-string">'yhat'</span>].<span class="hljs-title function_">shift</span>(-<span class="hljs-number">1</span>) > df[<span class="hljs-string">'yhat'</span>]).<span class="hljs-title function_">shift</span>(<span class="hljs-number">1</span>) * (df[<span class="hljs-string">'Percent Change'</span>]) + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()
df[<span class="hljs-string">'Prophet Thresh'</span>] = ((df[<span class="hljs-string">'y'</span>] &#x3C; df[<span class="hljs-string">'yhat_upper'</span>]).<span class="hljs-title function_">shift</span>(<span class="hljs-number">1</span>) * (df[<span class="hljs-string">'Percent Change'</span>]) + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()
df[<span class="hljs-string">'Seasonality'</span>] = ((~df[<span class="hljs-string">'ds'</span>].<span class="hljs-property">dt</span>.<span class="hljs-property">month</span>.<span class="hljs-title function_">isin</span>([<span class="hljs-number">8</span>,<span class="hljs-number">9</span>])).<span class="hljs-title function_">shift</span>(<span class="hljs-number">1</span>) * (df[<span class="hljs-string">'Percent Change'</span>]) + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()

(df.<span class="hljs-title function_">dropna</span>().<span class="hljs-title function_">set_index</span>(<span class="hljs-string">'ds'</span>)[[<span class="hljs-string">'Hold'</span>, <span class="hljs-string">'Prophet'</span>, <span class="hljs-string">'Prophet Thresh'</span>,<span class="hljs-string">'Seasonality'</span>]] * <span class="hljs-number">1000</span>).<span class="hljs-title function_">plot</span>(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), grid=<span class="hljs-title class_">True</span>)

<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Hold = {df['Hold'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}"</span>)

<span class="hljs-title class_">Hold</span> = <span class="hljs-number">6</span>,<span class="hljs-number">090</span>
<span class="hljs-title class_">Prophet</span> = <span class="hljs-number">87</span>,<span class="hljs-number">595</span>
<span class="hljs-title class_">Prophet</span> <span class="hljs-title class_">Thresh</span> = <span class="hljs-number">18</span>,<span class="hljs-number">681</span>
<span class="hljs-title class_">Seasonality</span> = <span class="hljs-number">7</span>,<span class="hljs-number">172</span>
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_27.png" alt="ì´ë¯¸ì§€"></p>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì—¬ê¸°ì—ì„œ Prophet Thresh df['y']<code> df['yhat_lower'] ë¥¼ ì¡°ê±´ df['y']</code> df['yhat_upper'] ë¡œ ë°”ê¿” ë” ë†’ì€ ì˜ˆìƒ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</li>
<li>ìœ„ì˜ Prophet ì„ê³„ê°’ì„ ìµœì í™”í•´ ë´…ì‹œë‹¤.</li>
</ul>
<pre><code class="hljs language-js">performance = {}

<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.<span class="hljs-title function_">linspace</span>(<span class="hljs-number">.9</span>,<span class="hljs-number">.99</span>,<span class="hljs-number">10</span>):
    y = ((df[<span class="hljs-string">'y'</span>] &#x3C; df[<span class="hljs-string">'yhat_upper'</span>]*x).<span class="hljs-title function_">shift</span>(<span class="hljs-number">1</span>)* (df[<span class="hljs-string">'í¼ì„¼íŠ¸ ë³€í™”'</span>]) + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()
    performance[x] = y
    
best_yhat = pd.<span class="hljs-title class_">DataFrame</span>(performance).<span class="hljs-title function_">max</span>().<span class="hljs-title function_">idxmax</span>()
pd.<span class="hljs-title class_">DataFrame</span>(performance).<span class="hljs-title function_">plot</span>(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), grid=<span class="hljs-title class_">True</span>);
f<span class="hljs-string">'ìµœì ì˜ Yhat = {best_yhat:,.2f}'</span>

<span class="hljs-string">'ìµœì ì˜ Yhat = 0.92'</span>
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_28.png" alt="ì´ë¯¸ì§€"></p>
<ul>
<li>Best Yhat = 0.92ë¡œ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">df[<span class="hljs-string">'Optimized Prophet Thresh'</span>] = ((df[<span class="hljs-string">'y'</span>] &#x3C; df[<span class="hljs-string">'yhat_upper'</span>] * best_yhat).<span class="hljs-title function_">shift</span>(<span class="hljs-number">1</span>) * 
                                  (df[<span class="hljs-string">'Percent Change'</span>]) + <span class="hljs-number">1</span>).<span class="hljs-title function_">cumprod</span>()

(df.<span class="hljs-title function_">dropna</span>().<span class="hljs-title function_">set_index</span>(<span class="hljs-string">'ds'</span>)[[<span class="hljs-string">'Hold'</span>, <span class="hljs-string">'Prophet'</span>, <span class="hljs-string">'Prophet Thresh'</span>, 
                              <span class="hljs-string">'Seasonality'</span>, <span class="hljs-string">'Optimized Prophet Thresh'</span>]] * <span class="hljs-number">1000</span>).<span class="hljs-title function_">plot</span>(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">8</span>), grid=<span class="hljs-title class_">True</span>)

<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Hold = {df['Hold'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}"</span>)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">"Optimized Prophet Thresh = {df['Optimized Prophet Thresh'].iloc[-1]*1000:,.0f}"</span>)

<span class="hljs-title class_">Hold</span> = <span class="hljs-number">6</span>,<span class="hljs-number">090</span>
<span class="hljs-title class_">Prophet</span> = <span class="hljs-number">87</span>,<span class="hljs-number">595</span>
<span class="hljs-title class_">Prophet</span> <span class="hljs-title class_">Thresh</span> = <span class="hljs-number">18</span>,<span class="hljs-number">681</span>
<span class="hljs-title class_">Seasonality</span> = <span class="hljs-number">7</span>,<span class="hljs-number">172</span>
<span class="hljs-title class_">Optimized</span> <span class="hljs-title class_">Prophet</span> <span class="hljs-title class_">Thresh</span> = <span class="hljs-number">36</span>,<span class="hljs-number">769</span>
</code></pre>
<img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_29.png">
<ul>
<li>ìš”ì•½:
<ul>
<li>ROI(Prophet)/ROI(Optimized Prophet Thresh) ì•½ 2.4ë°°</li>
<li>ROI(Prophet)/ROI(Hold) ì•½ 14.0ë°°</li>
<li>ROI(Optimized Prophet Thresh)/ROI(Prophet Thresh) ì•½ 2.0ë°°</li>
<li>ROI(Prophet Thresh)/ROI(Seasonality) ì•½ 2.5ë°°</li>
<li>ROI(Seasonality)/ROI(Hold) ì•½ 1.0ë°°</li>
</ul>
</li>
</ul>
<h2>í”„ë¡œí• í”Œë¡¯ë¦¬ ì‹œê°í™”ì™€ ë³€ê²½ ì§€ì ë“¤</h2>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>Prophet Plotly ì‹œê°í™” ì˜µì…˜ì„ ì‚´í´ë´…ì‹œë‹¤.</li>
</ul>
<pre><code class="hljs language-js">mydf=stock_price[[<span class="hljs-string">'ds'</span>,<span class="hljs-string">'y'</span>]]
mm = <span class="hljs-title class_">Prophet</span>()
mm.<span class="hljs-title function_">fit</span>(mydf)
future = mm.<span class="hljs-title function_">make_future_dataframe</span>(periods=<span class="hljs-number">365</span>)
forecast = mm.<span class="hljs-title function_">predict</span>(future)
<span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot_plotly

<span class="hljs-title function_">plot_plotly</span>(mm, forecast)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_30.png" alt="Prophet Plotly Visualization"></p>
<ul>
<li>Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ê°’ê³¼ ë³€í™”ì ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> prophet.<span class="hljs-property">plot</span> <span class="hljs-keyword">import</span> plot_plotly

<span class="hljs-title function_">plot_plotly</span>(mm, forecast, changepoints=<span class="hljs-title class_">True</span>)
</code></pre>
<p><img src="/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_31.png" alt="BTC-USD Price Prediction"></p>
<h2>ê²°ë¡ </h2>
<ul>
<li>ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Prophet (Facebookì˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.</li>
<li>Yahoo Finance Pythonì„ ì‚¬ìš©í•˜ì—¬ 2 ê°œì˜ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤: (1) 2024-07-06ê¹Œì§€ 730 ì¼ ë™ì•ˆ; (2) 2020-01-01ë¶€í„° 2024-07-07ê¹Œì§€.</li>
<li>ë°ì´í„° ì„¸íŠ¸ 1ì„ ì‚¬ìš©í•˜ì—¬ Box-Cox ë³€í™˜ê³¼ ë¯¸êµ­ì˜ íœ´ì¼ì„ ê³ ë ¤í•œ HPOë¥¼ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.</li>
<li>ë°ì´í„° ì„¸íŠ¸ 2ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ Prophet HPO ì˜ˆì¸¡ì„ 3 ë¶€ë¶„(ì—°ë„, ì›”, ì¼)ìœ¼ë¡œ ë¶„í•  í•œ í›„ ë£¨í”„ë¥¼ í†µí•´ ë‹¤ì¤‘ ê³„ì ˆì„± ì²˜ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.</li>
<li>Prophet êµì°¨ ê²€ì¦ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ íƒêµ¬í•˜ì—¬ ë‘ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ RMSE, MAPE ë° MAEì™€ ê°™ì€ ì—¬ëŸ¬ ì£¼ìš” ì§€í‘œë¥¼ ë¹„êµí–ˆìŠµë‹ˆë‹¤.</li>
<li>ë°ì´í„° ì„¸íŠ¸ 2: ìµœì¢… ì¸ìƒ˜í”Œ Prophet ì˜¤ë¥˜ ì§€í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-title class_">Mean</span> <span class="hljs-title class_">Absolute</span> <span class="hljs-title class_">Error</span>: <span class="hljs-number">8675.43</span>
<span class="hljs-title class_">Mean</span> <span class="hljs-title class_">Squared</span> <span class="hljs-title class_">Error</span>: <span class="hljs-number">107375840.73</span>
<span class="hljs-title class_">Root</span> <span class="hljs-title class_">Mean</span> <span class="hljs-title class_">Squared</span> <span class="hljs-title class_">Error</span>: <span class="hljs-number">10362.23</span>
</code></pre>
<ul>
<li>ë°ì´í„° ì§‘í•© 2: 350ì¼ ì£¼ê¸°ì˜ ì™¸ë¶€ ìƒ˜í”Œ Prophet HPO ì˜¤ë¥˜ ë©”íŠ¸ë¦­</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">MAPE</span> ì•½ <span class="hljs-number">0.2</span>-<span class="hljs-number">0.4</span>, (<span class="hljs-variable constant_">MAE</span>, <span class="hljs-variable constant_">RMSE</span>) ì•½ 10k-15k
</code></pre>
<ul>
<li>Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ ì‹œì ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¹˜ë¥¼ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.</li>
<li>ë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„° ì§‘í•© 2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìœ ìš©í•œ Prophet ê¸°ë°˜ ë°±í…ŒìŠ¤íŒ… ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ Hold ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.</li>
<li>ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ëŠ” ROI(Prophet)/ROI(Hold) ì•½ 14.0ì„ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.</li>
<li>í…ŒìŠ¤íŠ¸ ê²°ê³¼, Prophet ì¶”ì„¸ê°€ ì™¸ë¶€ ë°ì´í„° ì—†ì´ë„ ì •í™•íˆ ì¶”ì •ë  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì‹œê³„ì—´ì´ ê°•ë ¥í•œ ê³„ì ˆì  ì‚¬ì—…ì£¼ê¸°ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ê³ ë ¤í•  ë•Œ, Prophetê°€ ìƒë‹¹íˆ ì˜ ì‘ë™í•œë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.</li>
<li>Prophetì˜ ë‹¤ë¥¸ í†µê³„ ëª¨ë¸ ë° ê¸°ê³„ í•™ìŠµë³´ë‹¤ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í•´ì„ ê°€ëŠ¥ì„±ì…ë‹ˆë‹¤. Prophetì€ ì‹œê°„ ê¸°ëŠ¥ì„ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ì¢‹ì€ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.</li>
<li>ì „ë°˜ì ìœ¼ë¡œ, ì‹œê³„ì—´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ê¸°ë¥¼ ë”°ë¼ê°„ë‹¤ë©´ Prophetë¥¼ ê¸°ì¤€ ëª¨ë¸ë¡œ ì‚¬ìš©í•  ê°€ì¹˜ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤ (ì°¸ê³  ìë£Œ ì°¸ì¡°).</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>ì°¸ê³  ìë£Œ</h2>
<ul>
<li>Facebook Prophetë¥¼ ì‚¬ìš©í•œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡</li>
<li>Prophet ì§„ë‹¨</li>
<li>Facebook Prophet ì‹œì‘í•˜ê¸°</li>
<li>Facebook Prophetë¡œ ì‹œê³„ì—´ ì˜ˆì¸¡</li>
<li>FB Prophetë¥¼ ì‚¬ìš©í•œ BTC ê°€ê²© ì˜ˆì¸¡</li>
</ul>
<h2>ì—°ë½ì²˜</h2>
<ul>
<li>ì›¹ì‚¬ì´íŠ¸</li>
<li>GitHub</li>
<li>Facebook</li>
<li>X/Twitter</li>
<li>Pinterest</li>
<li>Mastodon</li>
<li>Tumblr</li>
</ul>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>ê³ ì§€ì‚¬í•­</h2>
<ul>
<li>ë‹¤ìŒ ê³ ì§€ëŠ” ë³¸ ê¸€ì˜ ì •ë³´ê°€ êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë˜ì—ˆìŒì„ ëª…í™•íˆí•˜ë©°, ì¬ì • ë˜ëŠ” íˆ¬ì ìë¬¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ëœë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•©ë‹ˆë‹¤.</li>
<li>ì œê³µëœ ì •ë³´ëŠ” ê·€í•˜ ê°œì¸ì˜ ì¬ì • ìƒí™©, ëª©í‘œ ë˜ëŠ” ë¦¬ìŠ¤í¬ í—ˆìš©ë„ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
<li>ê·€í•˜ê°€ ì·¨í•˜ëŠ” íˆ¬ì ê²°ì •ì´ë‚˜ ì¡°ì¹˜ëŠ” ì „ì ìœ¼ë¡œ ê·€í•˜ì˜ ì±…ì„ì…ë‹ˆë‹¤.</li>
<li>ì¬ì • ëª©í‘œ, ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ë° íˆ¬ì ê¸°ê°„ì— ë”°ë¼ ì–´ë– í•œ íˆ¬ìì˜ ì í•©ì„±ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•´ì•¼ í•©ë‹ˆë‹¤.</li>
<li>íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ë§ì¶¤ ê°€ì´ë“œ ì œê³µì´ ê°€ëŠ¥í•œ ìê²©ì„ ê°–ì¶˜ ì¬ë¬´ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ êµ¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.</li>
<li>ì œê³µëœ ë„êµ¬, ë°ì´í„°, ì½˜í…ì¸ , ì •ë³´ëŠ” ë§ì¶¤í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©° ì–´ë–¤ ê°œì¸ì˜ íˆ¬ì ìš”êµ¬ ì‚¬í•­ì— ë¶€í•©í•˜ë„ë¡ ì œê³µëœ ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì •ë³´ ë° êµìœ¡ ëª©ì ë§Œì„ ìœ„í•´ ì œê³µë©ë‹ˆë‹¤.</li>
</ul>
<h2>ìë£Œ</h2>
<p><a href="https://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet" rel="nofollow" target="_blank">https://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet</a> ë‚˜ì¨</p>
<!-- TIL ìˆ˜í‰ -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><a href="https://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting" rel="nofollow" target="_blank">https://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting</a> í˜ì´ì§€ë¥¼ ë°©ë¬¸í•´ ë³´ì„¸ìš”! í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ì£¼ì‹ ê°€ê²© ë¶„ì„ ë° ì˜ˆì¸¡ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"FB Prophetê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ ì‚¬ìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡, êµì°¨ ê²€ì¦ QC, ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ê±°ë˜ ì „ëµ","description":"","date":"2024-07-13 19:54","slug":"2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies","content":"\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png\" /\u003e\n\n- ë³¸ ê¸€ì€ ì´ì „ ì—°êµ¬ë¥¼ ì´ì–´ê°€ë©°, Pythonì—ì„œ Facebookì˜ Prophetì„ í™œìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡ì— ëŒ€í•œ ìì„¸í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤ [1â€“5] (ì°¸ê³  ë¬¸í—Œ).\n- í˜„ì¬ì˜ ë¹„êµ ë¶„ì„ì€ ì‹œê°„ ì‹œë¦¬ì¦ˆ êµì°¨ ê²€ì¦ QCë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ì¸¡ì •í•˜ëŠ” HPO ë˜ëŠ” ëª¨ë¸ íŠœë‹ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë´…ë‹ˆë‹¤.\n- ì‹œë®¬ë ˆì´ì…˜ëœ BTC ì˜ˆì¸¡ì— ì¶”ê°€ë˜ì–´, FB Prophetì„ ì‚¬ìš©í•˜ì—¬ í¬ë¦½í†  ì•Œê³ íŠ¸ë ˆì´ë”© ì „ëµì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ Buy \u0026 Hold ê¸°ì¤€ê³¼ ë¹„êµí•˜ì—¬ ì„¤ëª…í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.\n\n## ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤\n\n- ì ì ˆí•œ ì•”í˜¸í™”í ì˜ˆì¸¡ì€ í¬ë¦½í†  íŠ¸ë ˆì´ë”ë“¤ì—ê²Œ í° ì´ìµì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆìœ¼ë©° íš¨ê³¼ì ì¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ìµœê·¼ BTCëŠ” ë§ì€ ê°€ê²© ì˜ˆì¸¡ì˜ ì£¼ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n- CoinCodex: BTCì˜ ì—­ì‚¬ì ì¸ ê°€ê²© ë³€ë™ê³¼ BTC í•˜í”„ ì‚¬ì´í´ì„ ê¸°ë°˜ìœ¼ë¡œ, BTCê°€ ìƒí•œ ê°€ê²© ëŒ€ìƒì— ë„ë‹¬í•œë‹¤ë©´ 2025ë…„ê¹Œì§€ 201.59%ì˜ ì´ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œí¸, BTCì˜ ê°€ê²©ì€ ë‚´ë…„ì— $173,833ê¹Œì§€ ìƒìŠ¹í•  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.\n- í•˜ì§€ë§Œ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ 2030ë…„ê¹Œì§€ 1ë°±ë§Œ ë‹¬ëŸ¬ì— ë„ë‹¬í• ê¹Œìš”?\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## FB Prophetì— ëŒ€í•´\n\n- FB Prophetì€ ì¶”ì„¸/ê³„ì ˆì„± ëª¨ë¸ë§ê³¼ ë² ì´ì§€ì•ˆ ì¶”ë¡ ì— ê¸°ì´ˆí•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ì ˆì°¨ì…ë‹ˆë‹¤.\n- ê°•í•œ ê³„ì ˆ íš¨ê³¼ê°€ ìˆëŠ” ì‹œê³„ì—´ì— ê°€ì¥ ì í•©í•˜ë©°, ëˆ„ë½ ëœ ë°ì´í„°, ì´ìƒì¹˜ ë° ì¶”ì„¸ ë³€ë™ì— ê²¬ê³ í•©ë‹ˆë‹¤.\n- ì˜ˆì¸¡ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: ì¶”ì„¸(ì¥ê¸°ê°„ ë™ì•ˆì˜ ë³€í™”), ê³„ì ˆì„±(ì£¼ê¸°ì  ë˜ëŠ” ë‹¨ê¸° ë³€í™”), íœ´ì¼ ë° íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ì—ë§Œ í•´ë‹¹ë˜ëŠ” ì¡°ê±´ë¶€ ë³€ê²½ ì‚¬í•­.\n- ìƒˆë¡œìš´ ì‚¬ìš©ìì—ê²Œ íŠ¹íˆ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„±ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.\n- ì¶”ê°€ì ì¸ íšŒê·€ ë³€ìˆ˜, ê³±ì…ˆ ê³„ì ˆì„±, ë¹„ì¼ì¼ ë°ì´í„°, ë¶ˆí™•ì‹¤ì„± ì¸¡ì • ë° ì§„ë‹¨ì´ í¬í•¨ë©ë‹ˆë‹¤.\n\nì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²© ì˜ˆì¸¡ì˜ êµ¬ì²´ì  ë‚´ìš©ì„ ì‚´í´ë´…ì‹œë‹¤.\n\n## ì£¼ìš” ì„¤ì¹˜ ë°©ë²•\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- pipì€ ì €í¬ê°€ ì„ í˜¸í•˜ëŠ” ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Python 3.4ë¶€í„° Python ì´ì§„ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n- Jupyter Notebookì„ ì‹¤í–‰í•˜ê³  í•„ìˆ˜ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n\n```python\n!pip install statsmodels, math, yfinance, prophet, plotly,matplotlib, itertools\n```\n\n## Imports \u0026 Settings\n\n- ì½”ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì´ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nimport pandas as pd\nimport plotly.express as px\nimport requests\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom math import floor\nfrom termcolor import colored as cl\nimport yfinance as yf\nimport datetime\nfrom datetime import date, timedelta\n\n# Prophet ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°\nfrom prophet import Prophet\n\nplt.rcParams['figure.figsize'] = (12, 6)\nplt.style.use('fivethirtyeight')\n\nimport os\nos.chdir('ì‘ì—…ê²½ë¡œ')    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •\nos.getcwd()\n```\n\n## ì£¼ì‹ ë°ì´í„° ì…ë ¥\n\n- 730ì¼ì˜ BTC-USD ì´ë ¥ ë°ì´í„° ì…ë ¥\n\n```js\ntoday = date.today()\n\nd1 = today.strftime(\"%Y-%m-%d\")\nend_date = d1\nd2 = date.today() - timedelta(days=730)\nd2 = d2.strftime(\"%Y-%m-%d\")\nstart_date = d2\n\ndata = yf.download('BTC-USD', \n                      start=start_date, \n                      end=end_date, \n                      progress=False)\ndata[\"Date\"] = data.index\ndata = data[[\"Date\", \"Open\", \"High\", \"Low\", \"Close\", \"Adj Close\", \"Volume\"]]\ndata.reset_index(drop=True, inplace=True)\ndata.tail()\n\n|   Date    |    Open    |    High    |   Low    |   Close    |  Adj Close  |   Volume      |\n|----------|------------|------------|---------|------------|-------------|--------------|\n|2024-07-02| 62,844.41  | 63,203.36  | 61,752.75|   62,029.02 |  62,029.02  |  20151616992  |\n|2024-07-03| 62,034.33  | 62,187.70  | 59,419.39|   60,173.92 |  60,173.92  |  29756701685  |\n|2024-07-04| 60,147.14  | 60,399.68  | 56,777.80|   56,977.70 |  56,977.70  |  41149609230  |\n|2024-07-05| 57,022.81  | 57,497.15  | 53,717.38|   56,662.38 |  56,662.38  |  55417544033  |\n|2024-07-06| 56,659.07  | 58,472.55  | 56,038.96|   58,303.54 |  58,303.54  |  20610320577  |\n```   \n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì¢…ê°€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n```js\nplt.plot(data['Date'], data['Close'])\nplt.xlabel('ë‚ ì§œ')\nplt.ylabel('ì¢…ê°€(USD)')\nplt.title('BTC-USD ì¢…ê°€')\n```\n\n![BTC-USD Close Price](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_1.png)\n\n## ë°ì´í„° ì¤€ë¹„\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- Box Cox ë³€í™˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì •ê·œì ì¸ ì¢…ì† ë³€ìˆ˜ì¸ Close ê°€ê²©ì„ ì •ê·œë¶„í¬ í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.\n\n```js\n### Box Cox ë³€í™˜\nfrom statsmodels.base.transform import BoxCox\n\nbc = BoxCox()\ndata[\"Close\"], lmbda = bc.transform_boxcox(data[\"Close\"])\n```\n\n- Prophetì— ì…ë ¥ ë°ì´í„° ë§Œë“¤ê¸°\n\n```js\ndata1 = data[[\"Date\", \"Close\"]]\ndata1.columns = [\"ds\", \"y\"]\n\ndata1.tail()\n\n    ds          y\n725 2024-07-02 42.381398\n726 2024-07-03 42.086488\n727 2024-07-04 41.560999\n728 2024-07-05 41.507898\n729 2024-07-06 41.781750\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- Prophetì— ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒì€ í•­ìƒ dsì™€ y ë‘ ê°œì˜ ì—´ì´ ìˆëŠ” ë°ì´í„°í”„ë ˆì„ì…ë‹ˆë‹¤. ds (ë‚ ì§œ) ì—´ì€ Pandasì—ì„œ ì˜ˆìƒí•˜ëŠ” í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‚ ì§œì˜ ê²½ìš° YYYY-MM-DDì´ê³ , íƒ€ì„ìŠ¤íƒ¬í”„ì˜ ê²½ìš° YYYY-MM-DD HH:MM:SSì…ë‹ˆë‹¤. y ì—´ì€ ìˆ«ìì´ì–´ì•¼ í•˜ë©°, ì˜ˆì¸¡í•˜ë ¤ëŠ” ì¸¡ì • ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n## Max Capê³¼ 5% í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•œ Prophet\n\n- ë§¤ë…„ ê³±ì…ˆ ê³„ì ˆì„±ê³¼ ë¡œì§€ìŠ¤í‹± ì„±ì¥ì´ ìˆëŠ” ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n```js\nmodel_param = {\n    \"daily_seasonality\": False,\n    \"weekly_seasonality\": False,\n    \"yearly_seasonality\": True,\n    \"seasonality_mode\": \"multiplicative\",\n    \"growth\": \"logistic\"\n}\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ê°€ë²• ê³„ì ˆì„± ëª¨ë¸ì„ ì í•©ì‹œí‚¤ë©°, ê³„ì ˆì„±ì˜ ì˜í–¥ì´ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì¶”ì„¸ì— ë”í•´ì§‘ë‹ˆë‹¤. ìœ„ ëª¨ë¸ì—ì„œ ê³„ì ˆì„±ì€ Prophetì´ ê°€ì •í•œ ê²ƒì²˜ëŸ¼ ì¼ì •í•œ ê°€ë²•ì  ìš”ì†Œê°€ ì•„ë‹ˆë¼ ì¶”ì„¸ì™€ í•¨ê»˜ ì¦ê°€í•˜ëŠ” ë‹¤ì¤‘ ê³„ì ˆì„±ì…ë‹ˆë‹¤.\n- ê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ì˜ˆì¸¡ì„ ìœ„í•´ ì„ í˜• ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ì¥ì„ ì˜ˆì¸¡í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ì •í•œ ìµœëŒ€ ë‹¬ì„± ê°€ëŠ¥ ì§€ì ì´ ìˆìŠµë‹ˆë‹¤: ì´ ì‹œì¥ ê·œëª¨ ë“±. ì´ë¥¼ ìš´ë°˜ ìš©ëŸ‰ì´ë¼ê³ í•˜ë©°, ì˜ˆì¸¡ì€ ì´ ì§€ì ì—ì„œ í¬í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Prophetì€ ì§€ì •ëœ ìš´ë°˜ ìš©ëŸ‰ì„ ê°–ì¶˜ ë¡œì§€ìŠ¤í‹± ì„±ì¥ íŠ¸ë Œë“œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ëª¨ë¸ ì‹¤í–‰\n\n```js\nmodel = Prophet(**model_param)\n```\n\n- ë¡œì§€ìŠ¤í‹± ì„±ì¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— ëŒ€í•œ ìƒí•œì„  ë˜ëŠ” ìƒí•œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ìƒí•œê°’ì€ ê°€ê²©ì˜ ìµœëŒ€ê°’ì— í‘œì¤€í¸ì°¨ì˜ 5%ë¥¼ ë”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n```js\ndata1['cap'] = data1[\"y\"].max() + data1[\"y\"].std() * 0.05\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ëª¨ë¸ì„ ë§ì¶”ëŠ” ì¤‘\n\n```js\nmodel.fit(data1)\n```\n\n- ìœ„ì˜ ìº¡ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë‚´ë¶€ ë° 1ë…„ ì¥ê¸° ì˜ˆì¸¡ ìƒì„±\n\n```js\nfuture= model.make_future_dataframe(periods=365)\n\nfuture['cap'] = data1['cap'].max()\n\nforecast= model.predict(future)\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ (ds-y) ë„ë©”ì¸ ì˜ˆì¸¡ì„ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.\n\n```js\nmodel.plot(forecast,figsize=(14, 8))\n```\n\n![BTC-USD ê°€ê²© ì˜ˆì¸¡](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_2.png)\n\n```js\nmodel.plot_components(forecast,figsize=(16, 10));\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ì „ì— ì‚¬ìš©í•˜ë˜ table tagë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.\n\n## Prophet with Monthly/Quarterly Seasonality \u0026 US Holidays\n\n- Prophetë¥¼ ì›”ë³„/ë¶„ê¸°ë³„ ê³„ì ˆì„± ë° ë¯¸êµ­ ê³µíœ´ì¼ê³¼ í•¨ê»˜ ì‹¤í–‰ ì¤‘\n\n```js\nmodel = Prophet(**model_param)\n\nmodel.add_seasonality(name=\"monthly\", period=30, fourier_order=10)\nmodel.add_seasonality(name=\"quarterly\", period=92.25, fourier_order=10)\n\nmodel.add_country_holidays(\"US\")\n\nmodel.fit(data1)\n\n# ë¯¸ë˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±\nfuture = model.make_future_dataframe(periods=365)\nfuture['cap'] = data1['cap'].max()\n\nforecast = model.predict(future)\n\nfrom prophet.plot import plot\n\nplot(model, forecast, figsize=(14, 8))\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nfrom prophet.plot import plot_components\n\nplot_components(model, forecast, figsize=(10, 12))\n```\n\nìœ„ì˜ ì½”ë“œ ë¸”ë¡ì€ Prophet ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡í•œ ë°ì´í„°ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹œê°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”! ğŸš€\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤\n\n```js\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])\n```\n\n![BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7.png)\n\n- ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ cutoffë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì˜ ëª‡ ê°€ì§€ ìœ ìš©í•œ í†µê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nfrom prophet.diagnostics import cross_validation, performance_metrics\nfrom prophet.plot import plot_cross_validation_metric\ndf_cv = cross_validation(model, initial=\"600 days\", period=\"30 days\", horizon=\"90 days\")\ncutoffs = pd.to_datetime(['2022-09-01', '2023-05-01', '2024-03-01'])\ndf_cv2 = cross_validation(model, cutoffs=cutoffs, horizon='90 days')\nfig = plot_cross_validation_metric(df_cv2, metric='rmse')\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_8.png\" /\u003e\n\n- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìš”ì•½ ì •ë³´ ì¶œë ¥\n\n```js\ndf_p = performance_metrics(df_cv2)\ndf_p.head()\n\n    horizon mse      rmse       mae       mape     mdape   smape coverage\n0 9 days 3805.462369 61.688430 29.520999 0.893692 0.118312 0.355870 0.0\n1 10 days 5382.793620 73.367524 37.768231 1.140719 0.168333 0.425770 0.0\n2 11 days 6754.735216 82.187196 45.409934 1.368028 0.286148 0.491224 0.0\n3 12 days 7678.053041 87.624500 51.465541 1.551664 0.352840 0.546114 0.0\n4 13 days 8071.329465 89.840578 55.027843 1.658574 0.426625 0.584601 0.0\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- MAPE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mape')\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_9.png\" /\u003e\n\n- MAE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mae')\n```\n\n![BTC-USD Price Prediction using FB Prophet with Hyperparameter Optimization Cross-Validation QC Modified Algorithm Trading Strategies](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_10.png)\n\n## Hyperparameter Optimization (HPO)\n\n- Running HPO by adding monthly/quarterly seasonality and US holidays\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nrmses = list()\n\n# ê° ì¡°í•©ì„ ìˆœíšŒí•©ë‹ˆë‹¤.\nfor params in all_params:\n    m = Prophet(**params)\n    \n    m = m.add_seasonality(name='monthly', period=30, fourier_order=5)\n    m = m.add_seasonality(name='quarterly', period=92.25, fourier_order=10)\n\n    m.add_country_holidays(country_name='US')\n    \n    m.fit(data1)\n    \n    df_cv = cross_validation(m, initial='500 days', period='180 days', horizon='90 days')\n    \n    df_p = performance_metrics(df_cv, rolling_window=1)\n    \n    rmses.append(df_p['rmse'].values[0])\n    \n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\nbest_params = all_params[np.argmin(rmses)]\n    \nprint(\"\\nìµœì ì˜ ë§¤ê°œë³€ìˆ˜ëŠ”:\", best_params)\n```\n\n- ìµœì í™”ëœ ëª¨ë¸ì„ í”¼íŒ…í•˜ê³  í•´ë‹¹í•˜ëŠ” ì˜ˆì¸¡ ìƒì„±\n\n```js\nmodel_param1 = {\n    'daily_seasonality': False,\n    'weekly_seasonality': False,\n    'yearly_seasonality': True,\n    'seasonality_mode': 'multiplicative',\n    'growth': 'logistic',\n    'seasonality_prior_scale': 0.1,\n    'changepoint_prior_scale': 0.01\n}\n\nmodel1 = Prophet(**model_param1)\n\nmodel1.add_country_holidays('US')\n\nmodel1.fit(data1)\n\n# í–¥í›„ ë°ì´í„° í”„ë ˆì„ ìƒì„±\nfuture = model1.make_future_dataframe(periods=365)\nfuture['cap'] = data1['cap'].max()\n\nforecast = model1.predict(future)\n```\n\n- ì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n js\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])\n\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_11.png\" /\u003e\n\n- ìˆ˜ë™ cutoffë¡œ êµì°¨ ê²€ì¦ QC ì‹¤í–‰ ì¤‘\n\n```js\ncutoffs = pd.to_datetime(['2022-09-01', '2023-05-01', '2024-03-01'])\ndf_cv2 = cross_validation(model1, cutoffs=cutoffs, horizon='90 days')\nfig = plot_cross_validation_metric(df_cv2, metric='rmse')\n``` \n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_12.png)\n\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mape')\n```\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_13.png)\n\n```js\nfig = plot_cross_validation_metric(df_cv2, metric='mae')\n``` \n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\n![BTC-USD Price Prediction](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_14.png)\n\n## 2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ BTC-USD ì—­ì‚¬ì  ë°ì´í„° ì¤€ë¹„\n\n- ë°•ìŠ¤-ì½•ìŠ¤(Box-Cox) ë³€í™˜ì„ í•˜ì§€ ì•Šê³  2020ë…„ 01ì›” 01ì¼ë¶€í„° 2024ë…„ 07ì›” 07ì¼ê¹Œì§€ì˜ BTC-USD ì—­ì‚¬ì  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.\n\n```js\nimport pandas as pd\nimport numpy as np\nfrom prophet import Prophet\nimport matplotlib.pyplot as plt\nfrom functools import reduce\n\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\npd.options.display.float_format = \"{:,.2f}\".format\n\nimport yfinance as yf\n\nticker = 'BTC-USD'\nstart_date = '2020-01-01'\n\nstock_price = yf.download(ticker, start=start_date)\nstock_price[\"ë‚ ì§œ\"] = stock_price.index\nstock_price.tail()\n\n           Open      High      Low       Close    Adj Close   Volume      ë‚ ì§œ\nDate       \n2024-07-03 62,034.33 62,187.70 59,419.39 60,173.92 60,173.92 29756701685 2024-07-03\n2024-07-04 60,147.14 60,399.68 56,777.80 56,977.70 56,977.70 41149609230 2024-07-04\n2024-07-05 57,022.81 57,497.15 53,717.38 56,662.38 56,662.38 55417544033 2024-07-05\n2024-07-06 56,659.07 58,472.55 56,038.96 58,303.54 58,303.54 20610320577 2024-07-06\n2024-07-07 58,239.43 58,367.18 56,644.89 57,198.04 57,198.04 19585976320 2024-07-07\n\nstock_price = stock_price[['ë‚ ì§œ','Adj Close']]\n\nstock_price.columns = ['ds', 'y']\nstock_price.tail()\n\n           ds          y\nDate  \n2024-07-03 2024-07-03 60,173.92\n2024-07-04 2024-07-04 56,977.70\n2024-07-05 2024-07-05 56,662.38\n2024-07-06 2024-07-06 58,303.54\n2024-07-07 2024-07-07 57,198.04\n```\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ê¸°ë³¸ Prophet ëª¨ë¸ì„ ì í•©ì‹œí‚¤ê³  2027ë…„ 7ì›” 7ì¼ê¹Œì§€ì˜ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n```js\nmodel = Prophet()\nmodel.fit(stock_price)\nfuture = model.make_future_dataframe(1095, freq='d')\n\nfuture_boolean = future['ds'].map(lambda x : True if x.weekday() in range(0, 5) else False)\nfuture = future[future_boolean] \n\nfuture.tail()\nds\n2738 2027-07-01\n2739 2027-07-02\n2742 2027-07-05\n2743 2027-07-06\n2744 2027-07-07\n\nforecast = model.predict(future)\n#forecast.tail()\n\nmodel.plot(forecast);\r\n```\n\n![BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15.png)\n\n- ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\nmodel.plot_components(forecast);\n\n\n![Forecast Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_16.png)\n\n- ì›ë˜ ê°€ê²©ê³¼ ì˜ˆì¸¡ì„ ì‹ ë¢° êµ¬ê°„ê³¼ í•¨ê»˜ ê·¸ë˜í”½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.\n\n```python\nstock_price_forecast = forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']]\ndf = pd.merge(stock_price, stock_price_forecast, on='ds', how='right')\ndf.set_index('ds').plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True);\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_17.png)\n\n- Date ì—´ì„ 3 ë¶€ë¶„(ì—°/ì›”/ì¼)ìœ¼ë¡œ ë¶„í• í•˜ê³  Prophet ëª¨ë¸ì„ fittingí•©ë‹ˆë‹¤.\n\n```python\nstock_price['dayname'] = stock_price['ds'].dt.day_name()\nstock_price['month'] = stock_price['ds'].dt.month\nstock_price['year'] = stock_price['ds'].dt.year\nstock_price['month/year'] = stock_price['month'].map(str) + '/' + stock_price['year'].map(str) \n\nstock_price = pd.merge(stock_price, \n                       stock_price['month/year'].drop_duplicates().reset_index(drop=True).reset_index(),\n                       on='month/year',\n                       how='left')\n\nstock_price = stock_price.rename(columns={'index':'month/year_index'})\n\nloop_list = stock_price['month/year'].unique().tolist()\nmax_num = len(loop_list) - 1\nforecast_frames = []\n\nfor num, item in enumerate(loop_list):\n\n    if  num == max_num:\n        pass\n    else:\n        df = stock_price.set_index('ds')[\n             stock_price[stock_price['month/year'] == loop_list[0]]['ds'].min():\\\n             stock_price[stock_price['month/year'] == item]['ds'].max()]\n        \n        df = df.reset_index()[['ds', 'y']]\n        \n        model = Prophet()\n        model.fit(df)\n        \n        future = stock_price[stock_price['month/year_index'] == (num + 1)][['ds']]\n\n        forecast = model.predict(future)\n        forecast_frames.append(forecast)\n```\n\n- In-sample forecastì™€ ì›ë˜ ê°€ê²©ì„ ë¹„êµí•˜ëŠ” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```python\nì£¼ê°€ ì˜ˆì¸¡ = reduce(lambda top, bottom: pd.concat([top, bottom], sort=False), ì˜ˆì¸¡_í”„ë ˆì„)\nì£¼ê°€ ì˜ˆì¸¡ = ì£¼ê°€ ì˜ˆì¸¡[['ì¼ì', 'ì˜ˆì¸¡ê°’', 'ì˜ˆì¸¡ê°’_í•˜í•œ', 'ì˜ˆì¸¡ê°’_ìƒí•œ']]\n\në°ì´í„°í”„ë ˆì„ = pd.merge(ì£¼ê°€[['ì¼ì','ì‹¤ì œê°€ê²©', 'ì›”/ì—°ë„_ì¸ë±ìŠ¤']], ì£¼ê°€ ì˜ˆì¸¡, on='ì¼ì')\në°ì´í„°í”„ë ˆì„['ë³€ë™ë¥ '] = ë°ì´í„°í”„ë ˆì„['ì‹¤ì œê°€ê²©'].pct_change()\në°ì´í„°í”„ë ˆì„.set_index('ì¼ì')[['ì‹¤ì œê°€ê²©', 'ì˜ˆì¸¡ê°’', 'ì˜ˆì¸¡ê°’_í•˜í•œ', 'ì˜ˆì¸¡ê°’_ìƒí•œ']].plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True)\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_18.png)\n\n- êµì°¨ ê²€ì¦ ìˆ˜í–‰ ì¤‘\n\n```python\nfrom prophet.diagnostics import performance_metrics\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤ = performance_metrics(df_cv)\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤.head()\n\n  horizon  mse          rmse      mae     mape mdape smape coverage\n0 37 ì¼    40,821,715.40 6,389.19 4,890.31 0.18 0.12 0.22 0.55\n1 38 ì¼    41,109,990.95 6,411.71 4,913.96 0.18 0.12 0.22 0.55\n2 39 ì¼    41,311,288.83 6,427.39 4,922.43 0.19 0.12 0.22 0.55\n3 40 ì¼    41,641,137.72 6,452.99 4,943.99 0.19 0.12 0.22 0.55\n4 41 ì¼    42,299,834.63 6,503.83 5,003.53 0.19 0.12 0.23 0.54\n\nfrom prophet.plot import plot_cross_validation_metric\nê·¸ë˜í”„ = plot_cross_validation_metric(df_cv, metric='rmse')\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\n![Plotting MAPE](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_19.png)\n\n- MAPE í”Œë¡œíŒ…\n\n```js\nfig = plot_cross_validation_metric(df_cv, metric='mape')\n```\n\n![MAPE Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_20.png)\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- MAE ê·¸ë˜í”„ í”Œë¡œíŒ…í•˜ê¸°\n\n```js\nfig = plot_cross_validation_metric(df_cv, metric='mae')\n```\n\n![MAE Plot](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_21.png)\n\n- ê·¸ë¦¬ë“œ ê²€ìƒ‰ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” êµ¬í˜„ ë° MAEë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í‰ê°€í•˜ê¸°\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n# í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì •ì˜\nfrom sklearn.metrics import mean_absolute_error\nparam_grid = {\n    'seasonality_mode': ['additive', 'multiplicative'],\n    'changepoint_prior_scale': [0.01, 0.1, 1, 10],\n    'seasonality_prior_scale': [0.01, 0.1, 1, 10],\n}\n\n# ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë„ìš°ë¯¸ í•¨ìˆ˜\ndef evaluate_model(model, metric_func):\n    df_cv = cross_validation(model, initial='1125 days', period='180 days', horizon='365 days')\n    return metric_func(df_cv['y'], df_cv['yhat'])\n\n# ê·¸ë¦¬ë“œ ì„œì¹˜\nbest_params = {}\nbest_score = float('inf')\n\nfor mode in param_grid['seasonality_mode']:\n    for cps in param_grid['changepoint_prior_scale']:\n        for sps in param_grid['seasonality_prior_scale']:\n            # í˜„ì¬ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ìƒì„±\n            m = Prophet(seasonality_mode=mode, changepoint_prior_scale=cps, seasonality_prior_scale=sps)\n            m.fit(stock_price)\n\n            # í‰ê°€ ì§€í‘œë¡œ í‰ê°€ ëª¨ë¸(Mean Absolute Error ì‚¬ìš©)\n            score = evaluate_model(m, mean_absolute_error)\n\n            # í•„ìš” ì‹œ ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ ì—…ë°ì´íŠ¸\n            if score \u003c best_score:\n                best_score = score\n                best_params = {\n                    'seasonality_mode': mode,\n                    'changepoint_prior_scale': cps,\n                    'seasonality_prior_scale': sps\n                }\n\nprint(best_params)\n\n{'seasonality_mode': 'additive', 'changepoint_prior_scale': 0.1, 'seasonality_prior_scale': 10}\n\nprint(best_score)\n8675.430008099349\n```\n\n- ìµœì í™”ëœ ëª¨ë¸ì„ ì í•©í•˜ê³  1ë…„ ì˜ˆì¸¡ ìƒì„±\n\n```js\n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ ìƒì„±\nm_best = Prophet(seasonality_mode='additive', changepoint_prior_scale=0.1, seasonality_prior_scale=10)\nm_best.fit(stock_price)\n\n# 365ì¼ì„ í¬í•¨í•œ ì˜ˆì¸¡ì„ ìœ„í•œ ë°ì´í„°í”„ë ˆì„\nfuture_best = m_best.make_future_dataframe(periods=365)\nforecast_best = m_best.predict(future_best)\n\n# ì˜ˆì¸¡ ë°ì´í„°ì™€ í•¨ê»˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\nfig1 = m.plot(forecast_best)\nax = fig1.gca()\nax.set_title(\"BTC-USD ì£¼ê°€ ì˜ˆì¸¡\", size=25)\nax.set_xlabel(\"ë‚ ì§œ\", size=15)\nax.set_ylabel(\"ê°€ê²©\", size=15)\n```\n\n![BTC-USD Stock Price Forecast](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_22.png)\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- scikit-learnê³¼ Prophet ì§€í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ QC ìˆ˜í–‰ ì¤‘\n\n```js\n# êµì°¨ ê²€ì¦ ì‹¤í–‰\nfrom sklearn.metrics import mean_squared_error\ndf_cv = cross_validation(m_best, initial='1125 days', period='180 days', horizon='365 days')\n\n# ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°\ndf_metrics = performance_metrics(df_cv)\n\n# MAE, MSE ë° RMSE ê³„ì‚°\nmae = mean_absolute_error(df_cv['y'], df_cv['yhat'])\nmse = mean_squared_error(df_cv['y'], df_cv['yhat'])\nrmse = np.sqrt(mse)\n\nprint(f'í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: {mae:.2f}')\nprint(f'í‰ê·  ì œê³± ì˜¤ì°¨: {mse:.2f}')\nprint(f'ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: {rmse:.2f}')\n\ní‰ê·  ì ˆëŒ€ ì˜¤ì°¨: 8675.43\ní‰ê·  ì œê³± ì˜¤ì°¨: 107375840.73\nì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: 10362.23\n\nfrom prophet.plot import plot_cross_validation_metric\ndf_cv = cross_validation(m_best, initial='1125 days', period='180 days', horizon='365 days')\nfig = plot_cross_validation_metric(df_cv, metric='rmse')\r\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_23.png\" /\u003e\n\n- MAPE í”Œë¡œíŒ…í•˜ê¸°\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```python\nfig = plot_cross_validation_metric(df_cv, metric='mape')\n```\n\n![image](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_24.png)\n\n- MAE ê·¸ë¦¬ê¸°\n\n```python\nfig = plot_cross_validation_metric(df_cv, metric='mae')\n```\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_25.png\" /\u003e\n\n- In-Sample ë° Out-of-Sample 1ë…„ Prophet ì˜ˆì¸¡ê³¼ ì‹ ë¢° êµ¬ê°„ì„ ë™ì‹œì— í”Œë¡œíŒ…í•©ë‹ˆë‹¤ (ì›ë˜ ìŠ¤ì¼€ì¼)\n\n```js\nloop_list = stock_price['month/year'].unique().tolist()\nmax_num = len(loop_list) - 1\nforecast_frames = []\n\nfor num, item in enumerate(loop_list):\n\n    if num == max_num:\n        pass\n    else:\n        df = stock_price.set_index('ds')[\n             stock_price[stock_price['month/year'] == loop_list[0]]['ds'].min():\\\n             stock_price[stock_price['month/year'] == item]['ds'].max()]\n        \n        df = df.reset_index()[['ds', 'y']]\n        \n        future = stock_price[stock_price['month/year_index'] == (num + 1)][['ds']]\n\n        forecast = m_best.predict(future)\n        forecast_frames.append(forecast)\n\nstock_price_forecast1 = reduce(lambda top, bottom: pd.concat([top, bottom], sort=False), forecast_frames)\nstock_price_forecast1 = stock_price_forecast1[['ds', 'yhat', 'yhat_lower', 'yhat_upper']]\n\ndf1 = pd.merge(stock_price[['ds','y', 'month/year_index']], stock_price_forecast1, on='ds')\ndf1['Percent Change'] = df1['y'].pct_change()\ndf1.set_index('ds')[['y', 'yhat', 'yhat_lower', 'yhat_upper']].plot(figsize=(16,8), color=['royalblue', \"#34495e\", \"#e74c3c\", \"#e74c3c\"], grid=True)\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_26.png\" /\u003e\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ìˆ˜ì •ëœ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµ\n\n- ë‹¤ìŒê³¼ ê°™ì´ Prophetë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ ìˆ˜ì •í•©ì‹œë‹¤.\n\n```js\n#íŠ¸ë ˆì´ë”© ì•Œê³ ë¦¬ì¦˜\ndf=df1.copy()\ndf['Hold'] = (df['Percent Change'] + 1).cumprod()\ndf['Prophet'] = ((df['yhat'].shift(-1) \u003e df['yhat']).shift(1) * (df['Percent Change']) + 1).cumprod()\ndf['Prophet Thresh'] = ((df['y'] \u003c df['yhat_upper']).shift(1) * (df['Percent Change']) + 1).cumprod()\ndf['Seasonality'] = ((~df['ds'].dt.month.isin([8,9])).shift(1) * (df['Percent Change']) + 1).cumprod()\n\n(df.dropna().set_index('ds')[['Hold', 'Prophet', 'Prophet Thresh','Seasonality']] * 1000).plot(figsize=(16,8), grid=True)\n\nprint(f\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\")\nprint(f\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\")\nprint(f\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\")\nprint(f\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\")\n\nHold = 6,090\nProphet = 87,595\nProphet Thresh = 18,681\nSeasonality = 7,172\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_27.png)\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì—¬ê¸°ì—ì„œ Prophet Thresh df['y']` df['yhat_lower'] ë¥¼ ì¡°ê±´ df['y']` df['yhat_upper'] ë¡œ ë°”ê¿” ë” ë†’ì€ ì˜ˆìƒ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.\n- ìœ„ì˜ Prophet ì„ê³„ê°’ì„ ìµœì í™”í•´ ë´…ì‹œë‹¤.\n\n```js\nperformance = {}\n\nfor x in np.linspace(.9,.99,10):\n    y = ((df['y'] \u003c df['yhat_upper']*x).shift(1)* (df['í¼ì„¼íŠ¸ ë³€í™”']) + 1).cumprod()\n    performance[x] = y\n    \nbest_yhat = pd.DataFrame(performance).max().idxmax()\npd.DataFrame(performance).plot(figsize=(16,8), grid=True);\nf'ìµœì ì˜ Yhat = {best_yhat:,.2f}'\n\n'ìµœì ì˜ Yhat = 0.92'\n```\n\n![ì´ë¯¸ì§€](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_28.png)\n\n- Best Yhat = 0.92ë¡œ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\r\ndf['Optimized Prophet Thresh'] = ((df['y'] \u003c df['yhat_upper'] * best_yhat).shift(1) * \r\n                                  (df['Percent Change']) + 1).cumprod()\r\n\r\n(df.dropna().set_index('ds')[['Hold', 'Prophet', 'Prophet Thresh', \r\n                              'Seasonality', 'Optimized Prophet Thresh']] * 1000).plot(figsize=(16,8), grid=True)\r\n\r\nprint(f\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\")\r\nprint(f\"Optimized Prophet Thresh = {df['Optimized Prophet Thresh'].iloc[-1]*1000:,.0f}\")\r\n\r\nHold = 6,090\r\nProphet = 87,595\r\nProphet Thresh = 18,681\r\nSeasonality = 7,172\r\nOptimized Prophet Thresh = 36,769\r\n```\r\n\r\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_29.png\" /\u003e\r\n\r\n- ìš”ì•½:\r\n    - ROI(Prophet)/ROI(Optimized Prophet Thresh) ì•½ 2.4ë°°\r\n    - ROI(Prophet)/ROI(Hold) ì•½ 14.0ë°°\r\n    - ROI(Optimized Prophet Thresh)/ROI(Prophet Thresh) ì•½ 2.0ë°°\r\n    - ROI(Prophet Thresh)/ROI(Seasonality) ì•½ 2.5ë°°\r\n    - ROI(Seasonality)/ROI(Hold) ì•½ 1.0ë°°\r\n\r\n## í”„ë¡œí• í”Œë¡¯ë¦¬ ì‹œê°í™”ì™€ ë³€ê²½ ì§€ì ë“¤\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- Prophet Plotly ì‹œê°í™” ì˜µì…˜ì„ ì‚´í´ë´…ì‹œë‹¤.\n\n```js\nmydf=stock_price[['ds','y']]\nmm = Prophet()\nmm.fit(mydf)\nfuture = mm.make_future_dataframe(periods=365)\nforecast = mm.predict(future)\nfrom prophet.plot import plot_plotly\n\nplot_plotly(mm, forecast)\n```\n\n![Prophet Plotly Visualization](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_30.png)\n\n- Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ê°’ê³¼ ë³€í™”ì ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nfrom prophet.plot import plot_plotly\n\nplot_plotly(mm, forecast, changepoints=True)\n```\n\n![BTC-USD Price Prediction](/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_31.png)\n\n## ê²°ë¡ \n\n- ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Prophet (Facebookì˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.\n- Yahoo Finance Pythonì„ ì‚¬ìš©í•˜ì—¬ 2 ê°œì˜ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤: (1) 2024-07-06ê¹Œì§€ 730 ì¼ ë™ì•ˆ; (2) 2020-01-01ë¶€í„° 2024-07-07ê¹Œì§€.\n- ë°ì´í„° ì„¸íŠ¸ 1ì„ ì‚¬ìš©í•˜ì—¬ Box-Cox ë³€í™˜ê³¼ ë¯¸êµ­ì˜ íœ´ì¼ì„ ê³ ë ¤í•œ HPOë¥¼ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.\n- ë°ì´í„° ì„¸íŠ¸ 2ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ Prophet HPO ì˜ˆì¸¡ì„ 3 ë¶€ë¶„(ì—°ë„, ì›”, ì¼)ìœ¼ë¡œ ë¶„í•  í•œ í›„ ë£¨í”„ë¥¼ í†µí•´ ë‹¤ì¤‘ ê³„ì ˆì„± ì²˜ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\n- Prophet êµì°¨ ê²€ì¦ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ íƒêµ¬í•˜ì—¬ ë‘ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ RMSE, MAPE ë° MAEì™€ ê°™ì€ ì—¬ëŸ¬ ì£¼ìš” ì§€í‘œë¥¼ ë¹„êµí–ˆìŠµë‹ˆë‹¤.\n- ë°ì´í„° ì„¸íŠ¸ 2: ìµœì¢… ì¸ìƒ˜í”Œ Prophet ì˜¤ë¥˜ ì§€í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nMean Absolute Error: 8675.43\nMean Squared Error: 107375840.73\nRoot Mean Squared Error: 10362.23\n```\n\n- ë°ì´í„° ì§‘í•© 2: 350ì¼ ì£¼ê¸°ì˜ ì™¸ë¶€ ìƒ˜í”Œ Prophet HPO ì˜¤ë¥˜ ë©”íŠ¸ë¦­\n\n```js\nMAPE ì•½ 0.2-0.4, (MAE, RMSE) ì•½ 10k-15k\n```\n\n- Plotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ ì‹œì ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¹˜ë¥¼ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.\n- ë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„° ì§‘í•© 2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìœ ìš©í•œ Prophet ê¸°ë°˜ ë°±í…ŒìŠ¤íŒ… ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ Hold ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.\n- ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ëŠ” ROI(Prophet)/ROI(Hold) ì•½ 14.0ì„ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\n- í…ŒìŠ¤íŠ¸ ê²°ê³¼, Prophet ì¶”ì„¸ê°€ ì™¸ë¶€ ë°ì´í„° ì—†ì´ë„ ì •í™•íˆ ì¶”ì •ë  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì‹œê³„ì—´ì´ ê°•ë ¥í•œ ê³„ì ˆì  ì‚¬ì—…ì£¼ê¸°ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ê³ ë ¤í•  ë•Œ, Prophetê°€ ìƒë‹¹íˆ ì˜ ì‘ë™í•œë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.\n- Prophetì˜ ë‹¤ë¥¸ í†µê³„ ëª¨ë¸ ë° ê¸°ê³„ í•™ìŠµë³´ë‹¤ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í•´ì„ ê°€ëŠ¥ì„±ì…ë‹ˆë‹¤. Prophetì€ ì‹œê°„ ê¸°ëŠ¥ì„ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ì¢‹ì€ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.\n- ì „ë°˜ì ìœ¼ë¡œ, ì‹œê³„ì—´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ê¸°ë¥¼ ë”°ë¼ê°„ë‹¤ë©´ Prophetë¥¼ ê¸°ì¤€ ëª¨ë¸ë¡œ ì‚¬ìš©í•  ê°€ì¹˜ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤ (ì°¸ê³  ìë£Œ ì°¸ì¡°).\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ì°¸ê³  ìë£Œ\n\n- Facebook Prophetë¥¼ ì‚¬ìš©í•œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡\n- Prophet ì§„ë‹¨\n- Facebook Prophet ì‹œì‘í•˜ê¸°\n- Facebook Prophetë¡œ ì‹œê³„ì—´ ì˜ˆì¸¡\n- FB Prophetë¥¼ ì‚¬ìš©í•œ BTC ê°€ê²© ì˜ˆì¸¡\n\n## ì—°ë½ì²˜\n\n- ì›¹ì‚¬ì´íŠ¸\n- GitHub\n- Facebook\n- X/Twitter\n- Pinterest\n- Mastodon\n- Tumblr\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ê³ ì§€ì‚¬í•­\n\n- ë‹¤ìŒ ê³ ì§€ëŠ” ë³¸ ê¸€ì˜ ì •ë³´ê°€ êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë˜ì—ˆìŒì„ ëª…í™•íˆí•˜ë©°, ì¬ì • ë˜ëŠ” íˆ¬ì ìë¬¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ëœë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•©ë‹ˆë‹¤.\n- ì œê³µëœ ì •ë³´ëŠ” ê·€í•˜ ê°œì¸ì˜ ì¬ì • ìƒí™©, ëª©í‘œ ë˜ëŠ” ë¦¬ìŠ¤í¬ í—ˆìš©ë„ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n- ê·€í•˜ê°€ ì·¨í•˜ëŠ” íˆ¬ì ê²°ì •ì´ë‚˜ ì¡°ì¹˜ëŠ” ì „ì ìœ¼ë¡œ ê·€í•˜ì˜ ì±…ì„ì…ë‹ˆë‹¤.\n- ì¬ì • ëª©í‘œ, ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ë° íˆ¬ì ê¸°ê°„ì— ë”°ë¼ ì–´ë– í•œ íˆ¬ìì˜ ì í•©ì„±ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•´ì•¼ í•©ë‹ˆë‹¤.\n- íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ë§ì¶¤ ê°€ì´ë“œ ì œê³µì´ ê°€ëŠ¥í•œ ìê²©ì„ ê°–ì¶˜ ì¬ë¬´ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ êµ¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.\n- ì œê³µëœ ë„êµ¬, ë°ì´í„°, ì½˜í…ì¸ , ì •ë³´ëŠ” ë§ì¶¤í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©° ì–´ë–¤ ê°œì¸ì˜ íˆ¬ì ìš”êµ¬ ì‚¬í•­ì— ë¶€í•©í•˜ë„ë¡ ì œê³µëœ ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì •ë³´ ë° êµìœ¡ ëª©ì ë§Œì„ ìœ„í•´ ì œê³µë©ë‹ˆë‹¤.\n\n## ìë£Œ\n\nhttps://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet ë‚˜ì¨\n\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nhttps://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting í˜ì´ì§€ë¥¼ ë°©ë¬¸í•´ ë³´ì„¸ìš”! í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ì£¼ì‹ ê°€ê²© ë¶„ì„ ë° ì˜ˆì¸¡ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!","ogImage":{"url":"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png"},"coverImage":"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png","tag":["Tech"],"readingTime":39},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_0.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eë³¸ ê¸€ì€ ì´ì „ ì—°êµ¬ë¥¼ ì´ì–´ê°€ë©°, Pythonì—ì„œ Facebookì˜ Prophetì„ í™œìš©í•œ BTC-USD ê°€ê²© ì˜ˆì¸¡ì— ëŒ€í•œ ìì„¸í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤ [1â€“5] (ì°¸ê³  ë¬¸í—Œ).\u003c/li\u003e\n\u003cli\u003eí˜„ì¬ì˜ ë¹„êµ ë¶„ì„ì€ ì‹œê°„ ì‹œë¦¬ì¦ˆ êµì°¨ ê²€ì¦ QCë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ì¸¡ì •í•˜ëŠ” HPO ë˜ëŠ” ëª¨ë¸ íŠœë‹ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë´…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì‹œë®¬ë ˆì´ì…˜ëœ BTC ì˜ˆì¸¡ì— ì¶”ê°€ë˜ì–´, FB Prophetì„ ì‚¬ìš©í•˜ì—¬ í¬ë¦½í†  ì•Œê³ íŠ¸ë ˆì´ë”© ì „ëµì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ Buy \u0026#x26; Hold ê¸°ì¤€ê³¼ ë¹„êµí•˜ì—¬ ì„¤ëª…í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eì ì ˆí•œ ì•”í˜¸í™”í ì˜ˆì¸¡ì€ í¬ë¦½í†  íŠ¸ë ˆì´ë”ë“¤ì—ê²Œ í° ì´ìµì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆìœ¼ë©° íš¨ê³¼ì ì¸ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eìµœê·¼ BTCëŠ” ë§ì€ ê°€ê²© ì˜ˆì¸¡ì˜ ì£¼ì œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eCoinCodex: BTCì˜ ì—­ì‚¬ì ì¸ ê°€ê²© ë³€ë™ê³¼ BTC í•˜í”„ ì‚¬ì´í´ì„ ê¸°ë°˜ìœ¼ë¡œ, BTCê°€ ìƒí•œ ê°€ê²© ëŒ€ìƒì— ë„ë‹¬í•œë‹¤ë©´ 2025ë…„ê¹Œì§€ 201.59%ì˜ ì´ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œí¸, BTCì˜ ê°€ê²©ì€ ë‚´ë…„ì— $173,833ê¹Œì§€ ìƒìŠ¹í•  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eí•˜ì§€ë§Œ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ 2030ë…„ê¹Œì§€ 1ë°±ë§Œ ë‹¬ëŸ¬ì— ë„ë‹¬í• ê¹Œìš”?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eFB Prophetì— ëŒ€í•´\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFB Prophetì€ ì¶”ì„¸/ê³„ì ˆì„± ëª¨ë¸ë§ê³¼ ë² ì´ì§€ì•ˆ ì¶”ë¡ ì— ê¸°ì´ˆí•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ì ˆì°¨ì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eê°•í•œ ê³„ì ˆ íš¨ê³¼ê°€ ìˆëŠ” ì‹œê³„ì—´ì— ê°€ì¥ ì í•©í•˜ë©°, ëˆ„ë½ ëœ ë°ì´í„°, ì´ìƒì¹˜ ë° ì¶”ì„¸ ë³€ë™ì— ê²¬ê³ í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì˜ˆì¸¡ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: ì¶”ì„¸(ì¥ê¸°ê°„ ë™ì•ˆì˜ ë³€í™”), ê³„ì ˆì„±(ì£¼ê¸°ì  ë˜ëŠ” ë‹¨ê¸° ë³€í™”), íœ´ì¼ ë° íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ì—ë§Œ í•´ë‹¹ë˜ëŠ” ì¡°ê±´ë¶€ ë³€ê²½ ì‚¬í•­.\u003c/li\u003e\n\u003cli\u003eìƒˆë¡œìš´ ì‚¬ìš©ìì—ê²Œ íŠ¹íˆ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„±ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì¶”ê°€ì ì¸ íšŒê·€ ë³€ìˆ˜, ê³±ì…ˆ ê³„ì ˆì„±, ë¹„ì¼ì¼ ë°ì´í„°, ë¶ˆí™•ì‹¤ì„± ì¸¡ì • ë° ì§„ë‹¨ì´ í¬í•¨ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²© ì˜ˆì¸¡ì˜ êµ¬ì²´ì  ë‚´ìš©ì„ ì‚´í´ë´…ì‹œë‹¤.\u003c/p\u003e\n\u003ch2\u003eì£¼ìš” ì„¤ì¹˜ ë°©ë²•\u003c/h2\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003epipì€ ì €í¬ê°€ ì„ í˜¸í•˜ëŠ” ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. Python 3.4ë¶€í„° Python ì´ì§„ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì— ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eJupyter Notebookì„ ì‹¤í–‰í•˜ê³  í•„ìˆ˜ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e!pip install statsmodels, math, yfinance, prophet, plotly,matplotlib, itertools\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eImports \u0026#x26; Settings\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eì½”ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì´ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plotly.\u003cspan class=\"hljs-property\"\u003eexpress\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e px\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e numpy \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e np\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e matplotlib.\u003cspan class=\"hljs-property\"\u003epyplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e plt\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e math \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e floor\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e termcolor \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e colored \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e cl\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e yfinance \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e yf\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e datetime \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e date, timedelta\n\n# \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e\n\nplt.\u003cspan class=\"hljs-property\"\u003ercParams\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'figure.figsize'\u003c/span\u003e] = (\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-property\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003euse\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'fivethirtyeight'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e os\nos.\u003cspan class=\"hljs-title function_\"\u003echdir\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì‘ì—…ê²½ë¡œ'\u003c/span\u003e)    # ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •\nos.\u003cspan class=\"hljs-title function_\"\u003egetcwd\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eì£¼ì‹ ë°ì´í„° ì…ë ¥\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e730ì¼ì˜ BTC-USD ì´ë ¥ ë°ì´í„° ì…ë ¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003etoday = date.\u003cspan class=\"hljs-title function_\"\u003etoday\u003c/span\u003e()\n\nd1 = today.\u003cspan class=\"hljs-title function_\"\u003estrftime\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%Y-%m-%d\"\u003c/span\u003e)\nend_date = d1\nd2 = date.\u003cspan class=\"hljs-title function_\"\u003etoday\u003c/span\u003e() - \u003cspan class=\"hljs-title function_\"\u003etimedelta\u003c/span\u003e(days=\u003cspan class=\"hljs-number\"\u003e730\u003c/span\u003e)\nd2 = d2.\u003cspan class=\"hljs-title function_\"\u003estrftime\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%Y-%m-%d\"\u003c/span\u003e)\nstart_date = d2\n\ndata = yf.\u003cspan class=\"hljs-title function_\"\u003edownload\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'BTC-USD'\u003c/span\u003e, \n                      start=start_date, \n                      end=end_date, \n                      progress=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\ndata[\u003cspan class=\"hljs-string\"\u003e\"Date\"\u003c/span\u003e] = data.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e\ndata = data[[\u003cspan class=\"hljs-string\"\u003e\"Date\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Open\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"High\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Low\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Adj Close\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Volume\"\u003c/span\u003e]]\ndata.\u003cspan class=\"hljs-title function_\"\u003ereset_index\u003c/span\u003e(drop=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e, inplace=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\ndata.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\n\n|   \u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e    |    \u003cspan class=\"hljs-title class_\"\u003eOpen\u003c/span\u003e    |    \u003cspan class=\"hljs-title class_\"\u003eHigh\u003c/span\u003e    |   \u003cspan class=\"hljs-title class_\"\u003eLow\u003c/span\u003e    |   \u003cspan class=\"hljs-title class_\"\u003eClose\u003c/span\u003e    |  \u003cspan class=\"hljs-title class_\"\u003eAdj\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eClose\u003c/span\u003e  |   \u003cspan class=\"hljs-title class_\"\u003eVolume\u003c/span\u003e      |\n|----------|------------|------------|---------|------------|-------------|--------------|\n|\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e844.41\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e63\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e203.36\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e61\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e752.75\u003c/span\u003e|   \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e029.02\u003c/span\u003e |  \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e029.02\u003c/span\u003e  |  \u003cspan class=\"hljs-number\"\u003e20151616992\u003c/span\u003e  |\n|\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e034\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.33\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e187.70\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e419.39\u003c/span\u003e|   \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e173.92\u003c/span\u003e |  \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e173.92\u003c/span\u003e  |  \u003cspan class=\"hljs-number\"\u003e29756701685\u003c/span\u003e  |\n|\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e147.14\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e399.68\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e777.80\u003c/span\u003e|   \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e977.70\u003c/span\u003e |  \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e977.70\u003c/span\u003e  |  \u003cspan class=\"hljs-number\"\u003e41149609230\u003c/span\u003e  |\n|\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e022\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.81\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e497.15\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e717.38\u003c/span\u003e|   \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e662.38\u003c/span\u003e |  \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e662.38\u003c/span\u003e  |  \u003cspan class=\"hljs-number\"\u003e55417544033\u003c/span\u003e  |\n|\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e| \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e659.07\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e472.55\u003c/span\u003e  | \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e038.96\u003c/span\u003e|   \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e303.54\u003c/span\u003e |  \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e303.54\u003c/span\u003e  |  \u003cspan class=\"hljs-number\"\u003e20610320577\u003c/span\u003e  |\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì¢…ê°€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(data[\u003cspan class=\"hljs-string\"\u003e'Date'\u003c/span\u003e], data[\u003cspan class=\"hljs-string\"\u003e'Close'\u003c/span\u003e])\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ë‚ ì§œ'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì¢…ê°€(USD)'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'BTC-USD ì¢…ê°€'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_1.png\" alt=\"BTC-USD Close Price\"\u003e\u003c/p\u003e\n\u003ch2\u003eë°ì´í„° ì¤€ë¹„\u003c/h2\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eBox Cox ë³€í™˜ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì •ê·œì ì¸ ì¢…ì† ë³€ìˆ˜ì¸ Close ê°€ê²©ì„ ì •ê·œë¶„í¬ í˜•íƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e### \u003cspan class=\"hljs-title class_\"\u003eBox\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eCox\u003c/span\u003e ë³€í™˜\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e statsmodels.\u003cspan class=\"hljs-property\"\u003ebase\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003etransform\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBoxCox\u003c/span\u003e\n\nbc = \u003cspan class=\"hljs-title class_\"\u003eBoxCox\u003c/span\u003e()\ndata[\u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e], lmbda = bc.\u003cspan class=\"hljs-title function_\"\u003etransform_boxcox\u003c/span\u003e(data[\u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eProphetì— ì…ë ¥ ë°ì´í„° ë§Œë“¤ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edata1 = data[[\u003cspan class=\"hljs-string\"\u003e\"Date\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e]]\ndata1.\u003cspan class=\"hljs-property\"\u003ecolumns\u003c/span\u003e = [\u003cspan class=\"hljs-string\"\u003e\"ds\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"y\"\u003c/span\u003e]\n\ndata1.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\n\n    ds          y\n\u003cspan class=\"hljs-number\"\u003e725\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e42.381398\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e726\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e42.086488\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e727\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e41.560999\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e728\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e41.507898\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e729\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e41.781750\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eProphetì— ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒì€ í•­ìƒ dsì™€ y ë‘ ê°œì˜ ì—´ì´ ìˆëŠ” ë°ì´í„°í”„ë ˆì„ì…ë‹ˆë‹¤. ds (ë‚ ì§œ) ì—´ì€ Pandasì—ì„œ ì˜ˆìƒí•˜ëŠ” í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‚ ì§œì˜ ê²½ìš° YYYY-MM-DDì´ê³ , íƒ€ì„ìŠ¤íƒ¬í”„ì˜ ê²½ìš° YYYY-MM-DD HH:MM:SSì…ë‹ˆë‹¤. y ì—´ì€ ìˆ«ìì´ì–´ì•¼ í•˜ë©°, ì˜ˆì¸¡í•˜ë ¤ëŠ” ì¸¡ì • ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eMax Capê³¼ 5% í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•œ Prophet\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eë§¤ë…„ ê³±ì…ˆ ê³„ì ˆì„±ê³¼ ë¡œì§€ìŠ¤í‹± ì„±ì¥ì´ ìˆëŠ” ëª¨ë¸ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel_param = {\n    \u003cspan class=\"hljs-string\"\u003e\"daily_seasonality\"\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"weekly_seasonality\"\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"yearly_seasonality\"\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"seasonality_mode\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"multiplicative\"\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\"growth\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"logistic\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ê°€ë²• ê³„ì ˆì„± ëª¨ë¸ì„ ì í•©ì‹œí‚¤ë©°, ê³„ì ˆì„±ì˜ ì˜í–¥ì´ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì¶”ì„¸ì— ë”í•´ì§‘ë‹ˆë‹¤. ìœ„ ëª¨ë¸ì—ì„œ ê³„ì ˆì„±ì€ Prophetì´ ê°€ì •í•œ ê²ƒì²˜ëŸ¼ ì¼ì •í•œ ê°€ë²•ì  ìš”ì†Œê°€ ì•„ë‹ˆë¼ ì¶”ì„¸ì™€ í•¨ê»˜ ì¦ê°€í•˜ëŠ” ë‹¤ì¤‘ ê³„ì ˆì„±ì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eê¸°ë³¸ì ìœ¼ë¡œ Prophetì€ ì˜ˆì¸¡ì„ ìœ„í•´ ì„ í˜• ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ì¥ì„ ì˜ˆì¸¡í•  ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ì •í•œ ìµœëŒ€ ë‹¬ì„± ê°€ëŠ¥ ì§€ì ì´ ìˆìŠµë‹ˆë‹¤: ì´ ì‹œì¥ ê·œëª¨ ë“±. ì´ë¥¼ ìš´ë°˜ ìš©ëŸ‰ì´ë¼ê³ í•˜ë©°, ì˜ˆì¸¡ì€ ì´ ì§€ì ì—ì„œ í¬í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Prophetì€ ì§€ì •ëœ ìš´ë°˜ ìš©ëŸ‰ì„ ê°–ì¶˜ ë¡œì§€ìŠ¤í‹± ì„±ì¥ íŠ¸ë Œë“œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eëª¨ë¸ ì‹¤í–‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(**model_param)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eë¡œì§€ìŠ¤í‹± ì„±ì¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— ëŒ€í•œ ìƒí•œì„  ë˜ëŠ” ìƒí•œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ìƒí•œê°’ì€ ê°€ê²©ì˜ ìµœëŒ€ê°’ì— í‘œì¤€í¸ì°¨ì˜ 5%ë¥¼ ë”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edata1[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e] = data1[\u003cspan class=\"hljs-string\"\u003e\"y\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e() + data1[\u003cspan class=\"hljs-string\"\u003e\"y\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003estd\u003c/span\u003e() * \u003cspan class=\"hljs-number\"\u003e0.05\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eëª¨ë¸ì„ ë§ì¶”ëŠ” ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(data1)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eìœ„ì˜ ìº¡ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë‚´ë¶€ ë° 1ë…„ ì¥ê¸° ì˜ˆì¸¡ ìƒì„±\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efuture= model.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(periods=\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\n\nfuture[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e] = data1[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e()\n\nforecast= model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ (ds-y) ë„ë©”ì¸ ì˜ˆì¸¡ì„ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(forecast,figsize=(\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_2.png\" alt=\"BTC-USD ê°€ê²© ì˜ˆì¸¡\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003eplot_components\u003c/span\u003e(forecast,figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e));\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì´ì „ì— ì‚¬ìš©í•˜ë˜ table tagë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.\u003c/p\u003e\n\u003ch2\u003eProphet with Monthly/Quarterly Seasonality \u0026#x26; US Holidays\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eProphetë¥¼ ì›”ë³„/ë¶„ê¸°ë³„ ê³„ì ˆì„± ë° ë¯¸êµ­ ê³µíœ´ì¼ê³¼ í•¨ê»˜ ì‹¤í–‰ ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(**model_param)\n\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd_seasonality\u003c/span\u003e(name=\u003cspan class=\"hljs-string\"\u003e\"monthly\"\u003c/span\u003e, period=\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e, fourier_order=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd_seasonality\u003c/span\u003e(name=\u003cspan class=\"hljs-string\"\u003e\"quarterly\"\u003c/span\u003e, period=\u003cspan class=\"hljs-number\"\u003e92.25\u003c/span\u003e, fourier_order=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd_country_holidays\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"US\"\u003c/span\u003e)\n\nmodel.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(data1)\n\n# ë¯¸ë˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±\nfuture = model.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(periods=\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\nfuture[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e] = data1[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e()\n\nforecast = model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot\n\n\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(model, forecast, figsize=(\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_components\n\n\u003cspan class=\"hljs-title function_\"\u003eplot_components\u003c/span\u003e(model, forecast, figsize=(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eìœ„ì˜ ì½”ë“œ ë¸”ë¡ì€ Prophet ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡í•œ ë°ì´í„°ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹œê°í™”í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”! ğŸš€\u003c/p\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eforecast[\u003cspan class=\"hljs-string\"\u003e\"yhat\"\u003c/span\u003e]=bc.\u003cspan class=\"hljs-title function_\"\u003euntransform_boxcox\u003c/span\u003e(x=forecast[\u003cspan class=\"hljs-string\"\u003e\"yhat\"\u003c/span\u003e], lmbda=lmbda)\nforecast[\u003cspan class=\"hljs-string\"\u003e\"yhat_lower\"\u003c/span\u003e]=bc.\u003cspan class=\"hljs-title function_\"\u003euntransform_boxcox\u003c/span\u003e(x=forecast[\u003cspan class=\"hljs-string\"\u003e\"yhat_lower\"\u003c/span\u003e], lmbda=lmbda)\nforecast[\u003cspan class=\"hljs-string\"\u003e\"yhat_upper\"\u003c/span\u003e]=bc.\u003cspan class=\"hljs-title function_\"\u003euntransform_boxcox\u003c/span\u003e(x=forecast[\u003cspan class=\"hljs-string\"\u003e\"yhat_upper\"\u003c/span\u003e], lmbda=lmbda)\nforecast.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(x=\u003cspan class=\"hljs-string\"\u003e\"ds\"\u003c/span\u003e, y=[\u003cspan class=\"hljs-string\"\u003e\"yhat_lower\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"yhat\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"yhat_upper\"\u003c/span\u003e])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7.png\" alt=\"BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_7\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ cutoffë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ì„±ëŠ¥ì˜ ëª‡ ê°€ì§€ ìœ ìš©í•œ í†µê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003ediagnostics\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e cross_validation, performance_metrics\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_cross_validation_metric\ndf_cv = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(model, initial=\u003cspan class=\"hljs-string\"\u003e\"600 days\"\u003c/span\u003e, period=\u003cspan class=\"hljs-string\"\u003e\"30 days\"\u003c/span\u003e, horizon=\u003cspan class=\"hljs-string\"\u003e\"90 days\"\u003c/span\u003e)\ncutoffs = pd.\u003cspan class=\"hljs-title function_\"\u003eto_datetime\u003c/span\u003e([\u003cspan class=\"hljs-string\"\u003e'2022-09-01'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'2023-05-01'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'2024-03-01'\u003c/span\u003e])\ndf_cv2 = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(model, cutoffs=cutoffs, horizon=\u003cspan class=\"hljs-string\"\u003e'90 days'\u003c/span\u003e)\nfig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'rmse'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_8.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eì„±ëŠ¥ ë©”íŠ¸ë¦­ ìš”ì•½ ì •ë³´ ì¶œë ¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edf_p = \u003cspan class=\"hljs-title function_\"\u003eperformance_metrics\u003c/span\u003e(df_cv2)\ndf_p.\u003cspan class=\"hljs-title function_\"\u003ehead\u003c/span\u003e()\n\n    horizon mse      rmse       mae       mape     mdape   smape coverage\n\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e days \u003cspan class=\"hljs-number\"\u003e3805.462369\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e61.688430\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e29.520999\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.893692\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.118312\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.355870\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e days \u003cspan class=\"hljs-number\"\u003e5382.793620\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e73.367524\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e37.768231\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.140719\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.168333\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.425770\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e days \u003cspan class=\"hljs-number\"\u003e6754.735216\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e82.187196\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e45.409934\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.368028\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.286148\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.491224\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e days \u003cspan class=\"hljs-number\"\u003e7678.053041\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e87.624500\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e51.465541\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.551664\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.352840\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.546114\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e days \u003cspan class=\"hljs-number\"\u003e8071.329465\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e89.840578\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e55.027843\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.658574\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.426625\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.584601\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eMAPE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'mape'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_9.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eMAE ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'mae'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_10.png\" alt=\"BTC-USD Price Prediction using FB Prophet with Hyperparameter Optimization Cross-Validation QC Modified Algorithm Trading Strategies\"\u003e\u003c/p\u003e\n\u003ch2\u003eHyperparameter Optimization (HPO)\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eRunning HPO by adding monthly/quarterly seasonality and US holidays\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ermses = \u003cspan class=\"hljs-title function_\"\u003elist\u003c/span\u003e()\n\n# ê° ì¡°í•©ì„ ìˆœíšŒí•©ë‹ˆë‹¤.\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e params \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eall_params\u003c/span\u003e:\n    m = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(**params)\n    \n    m = m.\u003cspan class=\"hljs-title function_\"\u003eadd_seasonality\u003c/span\u003e(name=\u003cspan class=\"hljs-string\"\u003e'monthly'\u003c/span\u003e, period=\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e, fourier_order=\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n    m = m.\u003cspan class=\"hljs-title function_\"\u003eadd_seasonality\u003c/span\u003e(name=\u003cspan class=\"hljs-string\"\u003e'quarterly'\u003c/span\u003e, period=\u003cspan class=\"hljs-number\"\u003e92.25\u003c/span\u003e, fourier_order=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n\n    m.\u003cspan class=\"hljs-title function_\"\u003eadd_country_holidays\u003c/span\u003e(country_name=\u003cspan class=\"hljs-string\"\u003e'US'\u003c/span\u003e)\n    \n    m.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(data1)\n    \n    df_cv = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(m, initial=\u003cspan class=\"hljs-string\"\u003e'500 days'\u003c/span\u003e, period=\u003cspan class=\"hljs-string\"\u003e'180 days'\u003c/span\u003e, horizon=\u003cspan class=\"hljs-string\"\u003e'90 days'\u003c/span\u003e)\n    \n    df_p = \u003cspan class=\"hljs-title function_\"\u003eperformance_metrics\u003c/span\u003e(df_cv, rolling_window=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    \n    rmses.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(df_p[\u003cspan class=\"hljs-string\"\u003e'rmse'\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003evalues\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e])\n    \n# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\nbest_params = all_params[np.\u003cspan class=\"hljs-title function_\"\u003eargmin\u003c/span\u003e(rmses)]\n    \n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\nìµœì ì˜ ë§¤ê°œë³€ìˆ˜ëŠ”:\"\u003c/span\u003e, best_params)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eìµœì í™”ëœ ëª¨ë¸ì„ í”¼íŒ…í•˜ê³  í•´ë‹¹í•˜ëŠ” ì˜ˆì¸¡ ìƒì„±\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel_param1 = {\n    \u003cspan class=\"hljs-string\"\u003e'daily_seasonality'\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'weekly_seasonality'\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'yearly_seasonality'\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'seasonality_mode'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'multiplicative'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'growth'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'logistic'\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'seasonality_prior_scale'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'changepoint_prior_scale'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.01\u003c/span\u003e\n}\n\nmodel1 = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(**model_param1)\n\nmodel1.\u003cspan class=\"hljs-title function_\"\u003eadd_country_holidays\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'US'\u003c/span\u003e)\n\nmodel1.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(data1)\n\n# í–¥í›„ ë°ì´í„° í”„ë ˆì„ ìƒì„±\nfuture = model1.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(periods=\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\nfuture[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e] = data1[\u003cspan class=\"hljs-string\"\u003e'cap'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e()\n\nforecast = model1.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eì›ë˜ ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ ì—­ Box-Cox ë³€í™˜ì„ ì ìš©í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003ejs\nforecast[\"yhat\"]=bc.untransform_boxcox(x=forecast[\"yhat\"], lmbda=lmbda)\nforecast[\"yhat_lower\"]=bc.untransform_boxcox(x=forecast[\"yhat_lower\"], lmbda=lmbda)\nforecast[\"yhat_upper\"]=bc.untransform_boxcox(x=forecast[\"yhat_upper\"], lmbda=lmbda)\nforecast.plot(x=\"ds\", y=[\"yhat_lower\", \"yhat\", \"yhat_upper\"])\u003c/p\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_11.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eìˆ˜ë™ cutoffë¡œ êµì°¨ ê²€ì¦ QC ì‹¤í–‰ ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecutoffs = pd.\u003cspan class=\"hljs-title function_\"\u003eto_datetime\u003c/span\u003e([\u003cspan class=\"hljs-string\"\u003e'2022-09-01'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'2023-05-01'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'2024-03-01'\u003c/span\u003e])\ndf_cv2 = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(model1, cutoffs=cutoffs, horizon=\u003cspan class=\"hljs-string\"\u003e'90 days'\u003c/span\u003e)\nfig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'rmse'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_12.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'mape'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_13.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv2, metric=\u003cspan class=\"hljs-string\"\u003e'mae'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_14.png\" alt=\"BTC-USD Price Prediction\"\u003e\u003c/p\u003e\n\u003ch2\u003e2020ë…„ë¶€í„° 2024ë…„ê¹Œì§€ BTC-USD ì—­ì‚¬ì  ë°ì´í„° ì¤€ë¹„\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eë°•ìŠ¤-ì½•ìŠ¤(Box-Cox) ë³€í™˜ì„ í•˜ì§€ ì•Šê³  2020ë…„ 01ì›” 01ì¼ë¶€í„° 2024ë…„ 07ì›” 07ì¼ê¹Œì§€ì˜ BTC-USD ì—­ì‚¬ì  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e numpy \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e np\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e matplotlib.\u003cspan class=\"hljs-property\"\u003epyplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e plt\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e functools \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e reduce\n\n%matplotlib inline\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e warnings\nwarnings.\u003cspan class=\"hljs-title function_\"\u003efilterwarnings\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ignore'\u003c/span\u003e)\n\npd.\u003cspan class=\"hljs-property\"\u003eoptions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edisplay\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efloat_format\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"{:,.2f}\"\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eformat\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e yfinance \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e yf\n\nticker = \u003cspan class=\"hljs-string\"\u003e'BTC-USD'\u003c/span\u003e\nstart_date = \u003cspan class=\"hljs-string\"\u003e'2020-01-01'\u003c/span\u003e\n\nstock_price = yf.\u003cspan class=\"hljs-title function_\"\u003edownload\u003c/span\u003e(ticker, start=start_date)\nstock_price[\u003cspan class=\"hljs-string\"\u003e\"ë‚ ì§œ\"\u003c/span\u003e] = stock_price.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e\nstock_price.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\n\n           \u003cspan class=\"hljs-title class_\"\u003eOpen\u003c/span\u003e      \u003cspan class=\"hljs-title class_\"\u003eHigh\u003c/span\u003e      \u003cspan class=\"hljs-title class_\"\u003eLow\u003c/span\u003e       \u003cspan class=\"hljs-title class_\"\u003eClose\u003c/span\u003e    \u003cspan class=\"hljs-title class_\"\u003eAdj\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eClose\u003c/span\u003e   \u003cspan class=\"hljs-title class_\"\u003eVolume\u003c/span\u003e      ë‚ ì§œ\n\u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e       \n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e034\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.33\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e187.70\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e59\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e419.39\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e173.92\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e173.92\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e29756701685\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e147.14\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e399.68\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e777.80\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e977.70\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e977.70\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e41149609230\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e022\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.81\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e497.15\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e53\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e717.38\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e662.38\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e662.38\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e55417544033\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e659.07\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e472.55\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e038.96\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e303.54\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e303.54\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20610320577\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e239.43\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e367.18\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e644.89\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e198.04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e198.04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19585976320\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e\n\nstock_price = stock_price[[\u003cspan class=\"hljs-string\"\u003e'ë‚ ì§œ'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'Adj Close'\u003c/span\u003e]]\n\nstock_price.\u003cspan class=\"hljs-property\"\u003ecolumns\u003c/span\u003e = [\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e]\nstock_price.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\n\n           ds          y\n\u003cspan class=\"hljs-title class_\"\u003eDate\u003c/span\u003e  \n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e03\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e173.92\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e04\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e977.70\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e662.38\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e58\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e303.54\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e198.04\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eê¸°ë³¸ Prophet ëª¨ë¸ì„ ì í•©ì‹œí‚¤ê³  2027ë…„ 7ì›” 7ì¼ê¹Œì§€ì˜ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e()\nmodel.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(stock_price)\nfuture = model.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1095\u003c/span\u003e, freq=\u003cspan class=\"hljs-string\"\u003e'd'\u003c/span\u003e)\n\nfuture_boolean = future[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(lambda x : \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e x.\u003cspan class=\"hljs-title function_\"\u003eweekday\u003c/span\u003e() \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\nfuture = future[future_boolean] \n\nfuture.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\nds\n\u003cspan class=\"hljs-number\"\u003e2738\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2027\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2739\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2027\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2742\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2027\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2743\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2027\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e06\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2744\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2027\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e\n\nforecast = model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n#forecast.\u003cspan class=\"hljs-title function_\"\u003etail\u003c/span\u003e()\n\nmodel.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(forecast);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15.png\" alt=\"BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_15\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emodel.plot_components(forecast);\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_16.png\" alt=\"Forecast Plot\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eì›ë˜ ê°€ê²©ê³¼ ì˜ˆì¸¡ì„ ì‹ ë¢° êµ¬ê°„ê³¼ í•¨ê»˜ ê·¸ë˜í”½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003estock_price_forecast = forecast[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_lower'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e]]\ndf = pd.merge(stock_price, stock_price_forecast, on=\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, how=\u003cspan class=\"hljs-string\"\u003e'right'\u003c/span\u003e)\ndf.set_index(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e).plot(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), color=[\u003cspan class=\"hljs-string\"\u003e'royalblue'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#34495e\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e], grid=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_17.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDate ì—´ì„ 3 ë¶€ë¶„(ì—°/ì›”/ì¼)ìœ¼ë¡œ ë¶„í• í•˜ê³  Prophet ëª¨ë¸ì„ fittingí•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003estock_price[\u003cspan class=\"hljs-string\"\u003e'dayname'\u003c/span\u003e] = stock_price[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].dt.day_name()\nstock_price[\u003cspan class=\"hljs-string\"\u003e'month'\u003c/span\u003e] = stock_price[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].dt.month\nstock_price[\u003cspan class=\"hljs-string\"\u003e'year'\u003c/span\u003e] = stock_price[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].dt.year\nstock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e] = stock_price[\u003cspan class=\"hljs-string\"\u003e'month'\u003c/span\u003e].\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e) + \u003cspan class=\"hljs-string\"\u003e'/'\u003c/span\u003e + stock_price[\u003cspan class=\"hljs-string\"\u003e'year'\u003c/span\u003e].\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e) \n\nstock_price = pd.merge(stock_price, \n                       stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e].drop_duplicates().reset_index(drop=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e).reset_index(),\n                       on=\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e,\n                       how=\u003cspan class=\"hljs-string\"\u003e'left'\u003c/span\u003e)\n\nstock_price = stock_price.rename(columns={\u003cspan class=\"hljs-string\"\u003e'index'\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e'month/year_index'\u003c/span\u003e})\n\nloop_list = stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e].unique().tolist()\nmax_num = \u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(loop_list) - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nforecast_frames = []\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e num, item \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eenumerate\u003c/span\u003e(loop_list):\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e  num == max_num:\n        \u003cspan class=\"hljs-keyword\"\u003epass\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        df = stock_price.set_index(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)[\n             stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e] == loop_list[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]][\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e():\\\n             stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e] == item][\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e()]\n        \n        df = df.reset_index()[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e]]\n        \n        model = Prophet()\n        model.fit(df)\n        \n        future = stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year_index'\u003c/span\u003e] == (num + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)][[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e]]\n\n        forecast = model.predict(future)\n        forecast_frames.append(forecast)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eIn-sample forecastì™€ ì›ë˜ ê°€ê²©ì„ ë¹„êµí•˜ëŠ” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eì£¼ê°€ ì˜ˆì¸¡ = reduce(\u003cspan class=\"hljs-keyword\"\u003elambda\u003c/span\u003e top, bottom: pd.concat([top, bottom], sort=\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e), ì˜ˆì¸¡_í”„ë ˆì„)\nì£¼ê°€ ì˜ˆì¸¡ = ì£¼ê°€ ì˜ˆì¸¡[[\u003cspan class=\"hljs-string\"\u003e'ì¼ì'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’_í•˜í•œ'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’_ìƒí•œ'\u003c/span\u003e]]\n\në°ì´í„°í”„ë ˆì„ = pd.merge(ì£¼ê°€[[\u003cspan class=\"hljs-string\"\u003e'ì¼ì'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'ì‹¤ì œê°€ê²©'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì›”/ì—°ë„_ì¸ë±ìŠ¤'\u003c/span\u003e]], ì£¼ê°€ ì˜ˆì¸¡, on=\u003cspan class=\"hljs-string\"\u003e'ì¼ì'\u003c/span\u003e)\në°ì´í„°í”„ë ˆì„[\u003cspan class=\"hljs-string\"\u003e'ë³€ë™ë¥ '\u003c/span\u003e] = ë°ì´í„°í”„ë ˆì„[\u003cspan class=\"hljs-string\"\u003e'ì‹¤ì œê°€ê²©'\u003c/span\u003e].pct_change()\në°ì´í„°í”„ë ˆì„.set_index(\u003cspan class=\"hljs-string\"\u003e'ì¼ì'\u003c/span\u003e)[[\u003cspan class=\"hljs-string\"\u003e'ì‹¤ì œê°€ê²©'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’_í•˜í•œ'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ì˜ˆì¸¡ê°’_ìƒí•œ'\u003c/span\u003e]].plot(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), color=[\u003cspan class=\"hljs-string\"\u003e'royalblue'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#34495e\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e], grid=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_18.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eêµì°¨ ê²€ì¦ ìˆ˜í–‰ ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.diagnostics \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e performance_metrics\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤ = performance_metrics(df_cv)\nì„±ëŠ¥_ë©”íŠ¸ë¦­ìŠ¤.head()\n\n  horizon  mse          rmse      mae     mape mdape smape coverage\n\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e37\u003c/span\u003e ì¼    \u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e821\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e715.40\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e389.19\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e890.31\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.18\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.55\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e38\u003c/span\u003e ì¼    \u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e109\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e990.95\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e411.71\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e913.96\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.18\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.55\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e ì¼    \u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e311\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e288.83\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e427.39\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e922.43\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.19\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.55\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e ì¼    \u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e641\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e137.72\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e452.99\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e943.99\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.19\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.22\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.55\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e ì¼    \u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e299\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e834.63\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e503.83\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e003.53\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.19\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.12\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.23\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.54\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.plot \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_cross_validation_metric\nê·¸ë˜í”„ = plot_cross_validation_metric(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'rmse'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_19.png\" alt=\"Plotting MAPE\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMAPE í”Œë¡œíŒ…\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'mape'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_20.png\" alt=\"MAPE Plot\"\u003e\u003c/p\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eMAE ê·¸ë˜í”„ í”Œë¡œíŒ…í•˜ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'mae'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_21.png\" alt=\"MAE Plot\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eê·¸ë¦¬ë“œ ê²€ìƒ‰ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” êµ¬í˜„ ë° MAEë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ í‰ê°€í•˜ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì •ì˜\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.\u003cspan class=\"hljs-property\"\u003emetrics\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e mean_absolute_error\nparam_grid = {\n    \u003cspan class=\"hljs-string\"\u003e'seasonality_mode'\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e'additive'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'multiplicative'\u003c/span\u003e],\n    \u003cspan class=\"hljs-string\"\u003e'changepoint_prior_scale'\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e0.01\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e],\n    \u003cspan class=\"hljs-string\"\u003e'seasonality_prior_scale'\u003c/span\u003e: [\u003cspan class=\"hljs-number\"\u003e0.01\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e],\n}\n\n# ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë„ìš°ë¯¸ í•¨ìˆ˜\ndef evaluate_model(model, metric_func):\n    df_cv = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(model, initial=\u003cspan class=\"hljs-string\"\u003e'1125 days'\u003c/span\u003e, period=\u003cspan class=\"hljs-string\"\u003e'180 days'\u003c/span\u003e, horizon=\u003cspan class=\"hljs-string\"\u003e'365 days'\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003emetric_func\u003c/span\u003e(df_cv[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e], df_cv[\u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e])\n\n# ê·¸ë¦¬ë“œ ì„œì¹˜\nbest_params = {}\nbest_score = \u003cspan class=\"hljs-title function_\"\u003efloat\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'inf'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e mode \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e param_grid[\u003cspan class=\"hljs-string\"\u003e'seasonality_mode'\u003c/span\u003e]:\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e cps \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e param_grid[\u003cspan class=\"hljs-string\"\u003e'changepoint_prior_scale'\u003c/span\u003e]:\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e sps \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e param_grid[\u003cspan class=\"hljs-string\"\u003e'seasonality_prior_scale'\u003c/span\u003e]:\n            # í˜„ì¬ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ìƒì„±\n            m = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(seasonality_mode=mode, changepoint_prior_scale=cps, seasonality_prior_scale=sps)\n            m.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(stock_price)\n\n            # í‰ê°€ ì§€í‘œë¡œ í‰ê°€ ëª¨ë¸(\u003cspan class=\"hljs-title class_\"\u003eMean\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAbsolute\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e ì‚¬ìš©)\n            score = evaluate_model(m, mean_absolute_error)\n\n            # í•„ìš” ì‹œ ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ ì—…ë°ì´íŠ¸\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e score \u0026#x3C; \u003cspan class=\"hljs-attr\"\u003ebest_score\u003c/span\u003e:\n                best_score = score\n                best_params = {\n                    \u003cspan class=\"hljs-string\"\u003e'seasonality_mode'\u003c/span\u003e: mode,\n                    \u003cspan class=\"hljs-string\"\u003e'changepoint_prior_scale'\u003c/span\u003e: cps,\n                    \u003cspan class=\"hljs-string\"\u003e'seasonality_prior_scale'\u003c/span\u003e: sps\n                }\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ebest_params\u003c/span\u003e)\n\n{\u003cspan class=\"hljs-string\"\u003e'seasonality_mode'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'additive'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'changepoint_prior_scale'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'seasonality_prior_scale'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e}\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(best_score)\n\u003cspan class=\"hljs-number\"\u003e8675.430008099349\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eìµœì í™”ëœ ëª¨ë¸ì„ ì í•©í•˜ê³  1ë…„ ì˜ˆì¸¡ ìƒì„±\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# ìµœì ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ëª¨ë¸ ìƒì„±\nm_best = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e(seasonality_mode=\u003cspan class=\"hljs-string\"\u003e'additive'\u003c/span\u003e, changepoint_prior_scale=\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e, seasonality_prior_scale=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\nm_best.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(stock_price)\n\n# \u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003eì¼ì„ í¬í•¨í•œ ì˜ˆì¸¡ì„ ìœ„í•œ ë°ì´í„°í”„ë ˆì„\nfuture_best = m_best.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(periods=\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\nforecast_best = m_best.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future_best)\n\n# ì˜ˆì¸¡ ë°ì´í„°ì™€ í•¨ê»˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°\nfig1 = m.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(forecast_best)\nax = fig1.\u003cspan class=\"hljs-title function_\"\u003egca\u003c/span\u003e()\nax.\u003cspan class=\"hljs-title function_\"\u003eset_title\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"BTC-USD ì£¼ê°€ ì˜ˆì¸¡\"\u003c/span\u003e, size=\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e)\nax.\u003cspan class=\"hljs-title function_\"\u003eset_xlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ë‚ ì§œ\"\u003c/span\u003e, size=\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e)\nax.\u003cspan class=\"hljs-title function_\"\u003eset_ylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ê°€ê²©\"\u003c/span\u003e, size=\u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_22.png\" alt=\"BTC-USD Stock Price Forecast\"\u003e\u003c/p\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003escikit-learnê³¼ Prophet ì§€í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ QC ìˆ˜í–‰ ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# êµì°¨ ê²€ì¦ ì‹¤í–‰\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.\u003cspan class=\"hljs-property\"\u003emetrics\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e mean_squared_error\ndf_cv = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(m_best, initial=\u003cspan class=\"hljs-string\"\u003e'1125 days'\u003c/span\u003e, period=\u003cspan class=\"hljs-string\"\u003e'180 days'\u003c/span\u003e, horizon=\u003cspan class=\"hljs-string\"\u003e'365 days'\u003c/span\u003e)\n\n# ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°\ndf_metrics = \u003cspan class=\"hljs-title function_\"\u003eperformance_metrics\u003c/span\u003e(df_cv)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eMAE\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eMSE\u003c/span\u003e ë° \u003cspan class=\"hljs-variable constant_\"\u003eRMSE\u003c/span\u003e ê³„ì‚°\nmae = \u003cspan class=\"hljs-title function_\"\u003emean_absolute_error\u003c/span\u003e(df_cv[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e], df_cv[\u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e])\nmse = \u003cspan class=\"hljs-title function_\"\u003emean_squared_error\u003c/span\u003e(df_cv[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e], df_cv[\u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e])\nrmse = np.\u003cspan class=\"hljs-title function_\"\u003esqrt\u003c/span\u003e(mse)\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e'í‰ê·  ì ˆëŒ€ ì˜¤ì°¨: {mae:.2f}'\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e'í‰ê·  ì œê³± ì˜¤ì°¨: {mse:.2f}'\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e'ì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: {rmse:.2f}'\u003c/span\u003e)\n\ní‰ê·  ì ˆëŒ€ ì˜¤ì°¨: \u003cspan class=\"hljs-number\"\u003e8675.43\u003c/span\u003e\ní‰ê·  ì œê³± ì˜¤ì°¨: \u003cspan class=\"hljs-number\"\u003e107375840.73\u003c/span\u003e\nì œê³±ê·¼ í‰ê·  ì œê³± ì˜¤ì°¨: \u003cspan class=\"hljs-number\"\u003e10362.23\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_cross_validation_metric\ndf_cv = \u003cspan class=\"hljs-title function_\"\u003ecross_validation\u003c/span\u003e(m_best, initial=\u003cspan class=\"hljs-string\"\u003e'1125 days'\u003c/span\u003e, period=\u003cspan class=\"hljs-string\"\u003e'180 days'\u003c/span\u003e, horizon=\u003cspan class=\"hljs-string\"\u003e'365 days'\u003c/span\u003e)\nfig = \u003cspan class=\"hljs-title function_\"\u003eplot_cross_validation_metric\u003c/span\u003e(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'rmse'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_23.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eMAPE í”Œë¡œíŒ…í•˜ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003efig = plot_cross_validation_metric(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'mape'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_24.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMAE ê·¸ë¦¬ê¸°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003efig = plot_cross_validation_metric(df_cv, metric=\u003cspan class=\"hljs-string\"\u003e'mae'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_25.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eIn-Sample ë° Out-of-Sample 1ë…„ Prophet ì˜ˆì¸¡ê³¼ ì‹ ë¢° êµ¬ê°„ì„ ë™ì‹œì— í”Œë¡œíŒ…í•©ë‹ˆë‹¤ (ì›ë˜ ìŠ¤ì¼€ì¼)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eloop_list = stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eunique\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003etolist\u003c/span\u003e()\nmax_num = \u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(loop_list) - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nforecast_frames = []\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e num, item \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eenumerate\u003c/span\u003e(loop_list):\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e num == \u003cspan class=\"hljs-attr\"\u003emax_num\u003c/span\u003e:\n        pass\n    \u003cspan class=\"hljs-attr\"\u003eelse\u003c/span\u003e:\n        df = stock_price.\u003cspan class=\"hljs-title function_\"\u003eset_index\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)[\n             stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e] == loop_list[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]][\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emin\u003c/span\u003e():\\\n             stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year'\u003c/span\u003e] == item][\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e()]\n        \n        df = df.\u003cspan class=\"hljs-title function_\"\u003ereset_index\u003c/span\u003e()[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e]]\n        \n        future = stock_price[stock_price[\u003cspan class=\"hljs-string\"\u003e'month/year_index'\u003c/span\u003e] == (num + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)][[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e]]\n\n        forecast = m_best.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n        forecast_frames.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(forecast)\n\nstock_price_forecast1 = \u003cspan class=\"hljs-title function_\"\u003ereduce\u003c/span\u003e(lambda top, \u003cspan class=\"hljs-attr\"\u003ebottom\u003c/span\u003e: pd.\u003cspan class=\"hljs-title function_\"\u003econcat\u003c/span\u003e([top, bottom], sort=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e), forecast_frames)\nstock_price_forecast1 = stock_price_forecast1[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_lower'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e]]\n\ndf1 = pd.\u003cspan class=\"hljs-title function_\"\u003emerge\u003c/span\u003e(stock_price[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'month/year_index'\u003c/span\u003e]], stock_price_forecast1, on=\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)\ndf1[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e] = df1[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003epct_change\u003c/span\u003e()\ndf1.\u003cspan class=\"hljs-title function_\"\u003eset_index\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)[[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_lower'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e]].\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), color=[\u003cspan class=\"hljs-string\"\u003e'royalblue'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#34495e\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"#e74c3c\"\u003c/span\u003e], grid=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_26.png\"\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eìˆ˜ì •ëœ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eë‹¤ìŒê³¼ ê°™ì´ Prophetë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì•”í˜¸í™”í ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ ìˆ˜ì •í•©ì‹œë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e#íŠ¸ë ˆì´ë”© ì•Œê³ ë¦¬ì¦˜\ndf=df1.\u003cspan class=\"hljs-title function_\"\u003ecopy\u003c/span\u003e()\ndf[\u003cspan class=\"hljs-string\"\u003e'Hold'\u003c/span\u003e] = (df[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e] + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\ndf[\u003cspan class=\"hljs-string\"\u003e'Prophet'\u003c/span\u003e] = ((df[\u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \u003e df[\u003cspan class=\"hljs-string\"\u003e'yhat'\u003c/span\u003e]).\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) * (df[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e]) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\ndf[\u003cspan class=\"hljs-string\"\u003e'Prophet Thresh'\u003c/span\u003e] = ((df[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e] \u0026#x3C; df[\u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e]).\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) * (df[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e]) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\ndf[\u003cspan class=\"hljs-string\"\u003e'Seasonality'\u003c/span\u003e] = ((~df[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003edt\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emonth\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eisin\u003c/span\u003e([\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e])).\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) * (df[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e]) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\n\n(df.\u003cspan class=\"hljs-title function_\"\u003edropna\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eset_index\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)[[\u003cspan class=\"hljs-string\"\u003e'Hold'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Prophet'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Prophet Thresh'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'Seasonality'\u003c/span\u003e]] * \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), grid=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\n\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-title class_\"\u003eHold\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e090\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e87\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e595\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThresh\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e681\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eSeasonality\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e172\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_27.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì—¬ê¸°ì—ì„œ Prophet Thresh df['y']\u003ccode\u003e df['yhat_lower'] ë¥¼ ì¡°ê±´ df['y']\u003c/code\u003e df['yhat_upper'] ë¡œ ë°”ê¿” ë” ë†’ì€ ì˜ˆìƒ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eìœ„ì˜ Prophet ì„ê³„ê°’ì„ ìµœì í™”í•´ ë´…ì‹œë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eperformance = {}\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e np.\u003cspan class=\"hljs-title function_\"\u003elinspace\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e.9\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e.99\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e):\n    y = ((df[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e] \u0026#x3C; df[\u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e]*x).\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)* (df[\u003cspan class=\"hljs-string\"\u003e'í¼ì„¼íŠ¸ ë³€í™”'\u003c/span\u003e]) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\n    performance[x] = y\n    \nbest_yhat = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e(performance).\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eidxmax\u003c/span\u003e()\npd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e(performance).\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), grid=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e);\nf\u003cspan class=\"hljs-string\"\u003e'ìµœì ì˜ Yhat = {best_yhat:,.2f}'\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003e'ìµœì ì˜ Yhat = 0.92'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_28.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBest Yhat = 0.92ë¡œ ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edf[\u003cspan class=\"hljs-string\"\u003e'Optimized Prophet Thresh'\u003c/span\u003e] = ((df[\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e] \u0026#x3C; df[\u003cspan class=\"hljs-string\"\u003e'yhat_upper'\u003c/span\u003e] * best_yhat).\u003cspan class=\"hljs-title function_\"\u003eshift\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) * \r\n                                  (df[\u003cspan class=\"hljs-string\"\u003e'Percent Change'\u003c/span\u003e]) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003ecumprod\u003c/span\u003e()\r\n\r\n(df.\u003cspan class=\"hljs-title function_\"\u003edropna\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eset_index\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e)[[\u003cspan class=\"hljs-string\"\u003e'Hold'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Prophet'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Prophet Thresh'\u003c/span\u003e, \r\n                              \u003cspan class=\"hljs-string\"\u003e'Seasonality'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Optimized Prophet Thresh'\u003c/span\u003e]] * \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e), grid=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\r\n\r\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Hold = {df['Hold'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Prophet = {df['Prophet'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Prophet Thresh = {df['Prophet Thresh'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Seasonality = {df['Seasonality'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e\"Optimized Prophet Thresh = {df['Optimized Prophet Thresh'].iloc[-1]*1000:,.0f}\"\u003c/span\u003e)\r\n\r\n\u003cspan class=\"hljs-title class_\"\u003eHold\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e090\u003c/span\u003e\r\n\u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e87\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e595\u003c/span\u003e\r\n\u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThresh\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e681\u003c/span\u003e\r\n\u003cspan class=\"hljs-title class_\"\u003eSeasonality\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e172\u003c/span\u003e\r\n\u003cspan class=\"hljs-title class_\"\u003eOptimized\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThresh\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e36\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e769\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_29.png\"\u003e\n\u003cul\u003e\n\u003cli\u003eìš”ì•½:\n\u003cul\u003e\n\u003cli\u003eROI(Prophet)/ROI(Optimized Prophet Thresh) ì•½ 2.4ë°°\u003c/li\u003e\n\u003cli\u003eROI(Prophet)/ROI(Hold) ì•½ 14.0ë°°\u003c/li\u003e\n\u003cli\u003eROI(Optimized Prophet Thresh)/ROI(Prophet Thresh) ì•½ 2.0ë°°\u003c/li\u003e\n\u003cli\u003eROI(Prophet Thresh)/ROI(Seasonality) ì•½ 2.5ë°°\u003c/li\u003e\n\u003cli\u003eROI(Seasonality)/ROI(Hold) ì•½ 1.0ë°°\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eí”„ë¡œí• í”Œë¡¯ë¦¬ ì‹œê°í™”ì™€ ë³€ê²½ ì§€ì ë“¤\u003c/h2\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eProphet Plotly ì‹œê°í™” ì˜µì…˜ì„ ì‚´í´ë´…ì‹œë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emydf=stock_price[[\u003cspan class=\"hljs-string\"\u003e'ds'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e]]\nmm = \u003cspan class=\"hljs-title class_\"\u003eProphet\u003c/span\u003e()\nmm.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(mydf)\nfuture = mm.\u003cspan class=\"hljs-title function_\"\u003emake_future_dataframe\u003c/span\u003e(periods=\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\nforecast = mm.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(future)\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_plotly\n\n\u003cspan class=\"hljs-title function_\"\u003eplot_plotly\u003c/span\u003e(mm, forecast)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_30.png\" alt=\"Prophet Plotly Visualization\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePlotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ê°’ê³¼ ë³€í™”ì ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e prophet.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e plot_plotly\n\n\u003cspan class=\"hljs-title function_\"\u003eplot_plotly\u003c/span\u003e(mm, forecast, changepoints=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/TIL/assets/img/2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies_31.png\" alt=\"BTC-USD Price Prediction\"\u003e\u003c/p\u003e\n\u003ch2\u003eê²°ë¡ \u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Prophet (Facebookì˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ BTC-USD ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eYahoo Finance Pythonì„ ì‚¬ìš©í•˜ì—¬ 2 ê°œì˜ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤: (1) 2024-07-06ê¹Œì§€ 730 ì¼ ë™ì•ˆ; (2) 2020-01-01ë¶€í„° 2024-07-07ê¹Œì§€.\u003c/li\u003e\n\u003cli\u003eë°ì´í„° ì„¸íŠ¸ 1ì„ ì‚¬ìš©í•˜ì—¬ Box-Cox ë³€í™˜ê³¼ ë¯¸êµ­ì˜ íœ´ì¼ì„ ê³ ë ¤í•œ HPOë¥¼ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë°ì´í„° ì„¸íŠ¸ 2ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ Prophet HPO ì˜ˆì¸¡ì„ 3 ë¶€ë¶„(ì—°ë„, ì›”, ì¼)ìœ¼ë¡œ ë¶„í•  í•œ í›„ ë£¨í”„ë¥¼ í†µí•´ ë‹¤ì¤‘ ê³„ì ˆì„± ì²˜ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eProphet êµì°¨ ê²€ì¦ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ íƒêµ¬í•˜ì—¬ ë‘ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ RMSE, MAPE ë° MAEì™€ ê°™ì€ ì—¬ëŸ¬ ì£¼ìš” ì§€í‘œë¥¼ ë¹„êµí–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë°ì´í„° ì„¸íŠ¸ 2: ìµœì¢… ì¸ìƒ˜í”Œ Prophet ì˜¤ë¥˜ ì§€í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eMean\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAbsolute\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e8675.43\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eMean\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSquared\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e107375840.73\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eRoot\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMean\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSquared\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10362.23\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eë°ì´í„° ì§‘í•© 2: 350ì¼ ì£¼ê¸°ì˜ ì™¸ë¶€ ìƒ˜í”Œ Prophet HPO ì˜¤ë¥˜ ë©”íŠ¸ë¦­\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eMAPE\u003c/span\u003e ì•½ \u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e0.4\u003c/span\u003e, (\u003cspan class=\"hljs-variable constant_\"\u003eMAE\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eRMSE\u003c/span\u003e) ì•½ 10k-15k\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ePlotlyë¥¼ ì‚¬ìš©í•˜ì—¬ Prophet ì˜ˆì¸¡ ì‹œì ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¹˜ë¥¼ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„° ì§‘í•© 2ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìœ ìš©í•œ Prophet ê¸°ë°˜ ë°±í…ŒìŠ¤íŒ… ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ íŠ¸ë ˆì´ë”© ì „ëµì„ Hold ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eë°±í…ŒìŠ¤íŒ… ê²°ê³¼ëŠ” ROI(Prophet)/ROI(Hold) ì•½ 14.0ì„ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eí…ŒìŠ¤íŠ¸ ê²°ê³¼, Prophet ì¶”ì„¸ê°€ ì™¸ë¶€ ë°ì´í„° ì—†ì´ë„ ì •í™•íˆ ì¶”ì •ë  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì‹œê³„ì—´ì´ ê°•ë ¥í•œ ê³„ì ˆì  ì‚¬ì—…ì£¼ê¸°ë¥¼ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ê³ ë ¤í•  ë•Œ, Prophetê°€ ìƒë‹¹íˆ ì˜ ì‘ë™í•œë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eProphetì˜ ë‹¤ë¥¸ í†µê³„ ëª¨ë¸ ë° ê¸°ê³„ í•™ìŠµë³´ë‹¤ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í•´ì„ ê°€ëŠ¥ì„±ì…ë‹ˆë‹¤. Prophetì€ ì‹œê°„ ê¸°ëŠ¥ì„ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ì¢‹ì€ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì „ë°˜ì ìœ¼ë¡œ, ì‹œê³„ì—´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ê¸°ë¥¼ ë”°ë¼ê°„ë‹¤ë©´ Prophetë¥¼ ê¸°ì¤€ ëª¨ë¸ë¡œ ì‚¬ìš©í•  ê°€ì¹˜ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤ (ì°¸ê³  ìë£Œ ì°¸ì¡°).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eì°¸ê³  ìë£Œ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFacebook Prophetë¥¼ ì‚¬ìš©í•œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡\u003c/li\u003e\n\u003cli\u003eProphet ì§„ë‹¨\u003c/li\u003e\n\u003cli\u003eFacebook Prophet ì‹œì‘í•˜ê¸°\u003c/li\u003e\n\u003cli\u003eFacebook Prophetë¡œ ì‹œê³„ì—´ ì˜ˆì¸¡\u003c/li\u003e\n\u003cli\u003eFB Prophetë¥¼ ì‚¬ìš©í•œ BTC ê°€ê²© ì˜ˆì¸¡\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eì—°ë½ì²˜\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eì›¹ì‚¬ì´íŠ¸\u003c/li\u003e\n\u003cli\u003eGitHub\u003c/li\u003e\n\u003cli\u003eFacebook\u003c/li\u003e\n\u003cli\u003eX/Twitter\u003c/li\u003e\n\u003cli\u003ePinterest\u003c/li\u003e\n\u003cli\u003eMastodon\u003c/li\u003e\n\u003cli\u003eTumblr\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eê³ ì§€ì‚¬í•­\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eë‹¤ìŒ ê³ ì§€ëŠ” ë³¸ ê¸€ì˜ ì •ë³´ê°€ êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë˜ì—ˆìŒì„ ëª…í™•íˆí•˜ë©°, ì¬ì • ë˜ëŠ” íˆ¬ì ìë¬¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ëœë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì œê³µëœ ì •ë³´ëŠ” ê·€í•˜ ê°œì¸ì˜ ì¬ì • ìƒí™©, ëª©í‘œ ë˜ëŠ” ë¦¬ìŠ¤í¬ í—ˆìš©ë„ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eê·€í•˜ê°€ ì·¨í•˜ëŠ” íˆ¬ì ê²°ì •ì´ë‚˜ ì¡°ì¹˜ëŠ” ì „ì ìœ¼ë¡œ ê·€í•˜ì˜ ì±…ì„ì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì¬ì • ëª©í‘œ, ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ë° íˆ¬ì ê¸°ê°„ì— ë”°ë¼ ì–´ë– í•œ íˆ¬ìì˜ ì í•©ì„±ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•´ì•¼ í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eíŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ë§ì¶¤ ê°€ì´ë“œ ì œê³µì´ ê°€ëŠ¥í•œ ìê²©ì„ ê°–ì¶˜ ì¬ë¬´ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ êµ¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì œê³µëœ ë„êµ¬, ë°ì´í„°, ì½˜í…ì¸ , ì •ë³´ëŠ” ë§ì¶¤í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©° ì–´ë–¤ ê°œì¸ì˜ íˆ¬ì ìš”êµ¬ ì‚¬í•­ì— ë¶€í•©í•˜ë„ë¡ ì œê³µëœ ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì •ë³´ ë° êµìœ¡ ëª©ì ë§Œì„ ìœ„í•´ ì œê³µë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eìë£Œ\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.kaggle.com/code/alexkaggle95/stock-prices-forecast-plotly-prophet\u003c/a\u003e ë‚˜ì¨\u003c/p\u003e\n\u003c!-- TIL ìˆ˜í‰ --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003ca href=\"https://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.kaggle.com/code/ghazanfarali/stock-price-analysis-and-forecasting\u003c/a\u003e í˜ì´ì§€ë¥¼ ë°©ë¬¸í•´ ë³´ì„¸ìš”! í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ì£¼ì‹ ê°€ê²© ë¶„ì„ ë° ì˜ˆì¸¡ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-07-13-BTC-USDPricePredictionusingFBProphetwithHyperparameterOptimizationCross-ValidationQCModifiedAlgo-TradingStrategies"},"buildId":"FuXRqV9h16krA5Mvtd6Dn","assetPrefix":"/TIL","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>