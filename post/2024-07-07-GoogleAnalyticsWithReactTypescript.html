<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>React와 TypeScript로 Google Analytics 사용 방법 | TIL</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://13akstjq.github.io/TIL//post/2024-07-07-GoogleAnalyticsWithReactTypescript" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="React와 TypeScript로 Google Analytics 사용 방법 | TIL" data-gatsby-head="true"/><meta property="og:title" content="React와 TypeScript로 Google Analytics 사용 방법 | TIL" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://TIL.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://13akstjq.github.io/TIL//post/2024-07-07-GoogleAnalyticsWithReactTypescript" data-gatsby-head="true"/><meta name="twitter:title" content="React와 TypeScript로 Google Analytics 사용 방법 | TIL" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | TIL" data-gatsby-head="true"/><meta name="article:published_time" content="2024-07-07 21:58" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/TIL/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/TIL/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/TIL/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/TIL/favicons/favicon-96x96.png"/><link rel="icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/TIL/favicons/browserconfig.xml"/><link rel="preload" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/TIL/_next/static/css/0eef537492fed77a.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/0eef537492fed77a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/TIL/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/TIL/_next/static/chunks/webpack-21ffe88bdca56cba.js" defer=""></script><script src="/TIL/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/TIL/_next/static/chunks/main-a5eeabb286676ce6.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/TIL/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/TIL/_next/static/chunks/348-02483b66b493dd81.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/post/%5Bslug%5D-8ded8b979ba73586.js" defer=""></script><script src="/TIL/_next/static/KUC9M_yIlA1Ugo01xmkHL/_buildManifest.js" defer=""></script><script src="/TIL/_next/static/KUC9M_yIlA1Ugo01xmkHL/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/TIL">TIL</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/TIL/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">React와 TypeScript로 Google Analytics 사용 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="React와 TypeScript로 Google Analytics 사용 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/TIL/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">TIL</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jul 7, 2024</span><span class="posts_reading_time__f7YPP">8<!-- --> min read</span></span></div></div></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<img src="/TIL/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png">
<h2>GA 란?!!</h2>
<p>Google Analytics (GA)은 웹사이트 트래픽 및 사용자 행동을 추적하고 분석하는 강력한 도구입니다.</p>
<p>다음은 그 동작 방식입니다:</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>당신의 웹사이트에서 GA는 JavaScript 추적 코드를 사용하여 데이터를 수집합니다. 이 코드는 웹사이트 페이지에 삽입되어 방문자에 대한 정보를 수집하고 Google의 서버로 보내어 처리되며 다양한 보고서에서 제공됩니다.</p>
<h2>구현은 어떻게 작동하나요?</h2>
<p>useGoogleAnalytics.ts는 GA와 통합하기 위한 기본 파일로 사용됩니다. 우리는 유연성과 미래 지향성을 위해 GA 통합을 처리하기 위해 객체를 사용하고 있습니다.</p>
<p>GoogleAnalyticsProvider.tsx는 라우트를 감싸는 공급자 컴포넌트로 사용됩니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>App.tsx 파일을 수정하여 GoogleAnalyticsProvider 컴포넌트를 추가해주세요.</p>
<p>이 방법을 선택한 이유는?</p>
<ul>
<li>
<p>다양한 기능 지원: 페이지 뷰, 이벤트 추적 및 초기화 후 구성을 쉽게 관리할 수 있습니다.</p>
</li>
<li>
<p>미래를 대비: ReactGA에서 다른 솔루션(예: 미래의 GA 버전)으로 전환하더라도 코드 베이스의 각 인스턴스를 모두 업데이트해야 하는 것이 아니라 이 객체만 업데이트하면 됩니다.</p>
</li>
</ul>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>React 방식: 이 방법은 React의 최상의 실천 방법을 따르며 부작용을 처리하기 위해 컴포넌트를 사용합니다.</li>
</ul>
<p>// 코드에 있는 주석들
앱에서 이를 검색하여 로직을 이해하고 앱에서 구현을 더 잘 할 수 있도록 하는 것을 추천합니다: <code>// 추천:</code> 및 <code>// 설명:</code></p>
<p>GitHub 저장소: ‘google-analytics-react-ts’</p>
<p>useGoogleAnalytics.ts.tsx</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactGA</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react-ga4"</span>;

<span class="hljs-comment">// 추천: 환경 변수를 사용하여 비밀로 유지하는 것이 좋습니다.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> trackingId = <span class="hljs-string">"GA_ID"</span>;
<span class="hljs-keyword">const</span> appVersion = <span class="hljs-string">"APP_VERSION"</span>;
<span class="hljs-comment">// 참고: 분석을 보다 나은 것으로 만들기 위해 앱에서 사용자 ID를 사용하십시오.</span>
<span class="hljs-comment">// 추천: Redux로 구현하는 것이 좋습니다.</span>
<span class="hljs-keyword">const</span> id = <span class="hljs-string">"user-id"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">useGoogleAnalytics</span> = (<span class="hljs-params"></span>) => {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =></span> {
    <span class="hljs-keyword">if</span> (trackingId) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-title class_">ReactGA</span>.<span class="hljs-title function_">initialize</span>([
          {
            trackingId,
            <span class="hljs-attr">gaOptions</span>: {
              <span class="hljs-attr">anonymizeIp</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">clientId</span>: id,
            },
          },
        ]);
        <span class="hljs-title class_">ReactGA</span>.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">app_version</span>: appVersion });
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Google Analytics 초기화 오류"</span>, { <span class="hljs-title class_">Error</span>: error });
      }
    }
  }, [id]);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setOption</span> = (<span class="hljs-params">key: string, value: unknown</span>) => {
    <span class="hljs-title class_">ReactGA</span>.<span class="hljs-title function_">set</span>({ [key]: value });
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setUserId</span> = (<span class="hljs-params">userId: string | number</span>) => {
    <span class="hljs-title function_">setOption</span>(<span class="hljs-string">"userId"</span>, userId);
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendData</span> = (<span class="hljs-params">type: string, data: <span class="hljs-built_in">Object</span></span>) => {
    <span class="hljs-title class_">ReactGA</span>.<span class="hljs-title function_">send</span>({ <span class="hljs-attr">hitType</span>: type, ...data });
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">trackPageView</span> = (<span class="hljs-params">pagePath?: string</span>) => {
    <span class="hljs-keyword">if</span> (!pagePath) {
      pagePath = location.<span class="hljs-property">href</span>;
    }

    <span class="hljs-title function_">setOption</span>(<span class="hljs-string">"app_version"</span>, appVersion);
    <span class="hljs-title function_">sendData</span>(<span class="hljs-string">"pageview"</span>, { <span class="hljs-attr">page</span>: pagePath });
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">trackEvent</span> = (<span class="hljs-params">category: string, action: string, label?: string, value?: number</span>) => {
    <span class="hljs-title function_">setOption</span>(<span class="hljs-string">"app_version"</span>, appVersion);
    <span class="hljs-title class_">ReactGA</span>.<span class="hljs-title function_">event</span>({ category, action, label, value });
  };

  <span class="hljs-keyword">return</span> {
    setOption,
    setUserId,
    trackPageView,
    trackEvent,
  };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useGoogleAnalytics;
</code></pre>
<p>GoogleAnalyticsProvider.tsx</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, <span class="hljs-title class_">PropsWithChildren</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { useLocation } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;
<span class="hljs-keyword">import</span> useGoogleAnalytics, { trackingId } <span class="hljs-keyword">from</span> <span class="hljs-string">"../hooks/useGoogleAnalytics"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">GoogleAnalyticsProvider</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&#x3C;<span class="hljs-title class_">PropsWithChildren</span>&#x3C;{}>> = <span class="hljs-function">(<span class="hljs-params">{ children }</span>) =></span> {
  <span class="hljs-keyword">const</span> { trackPageView } = <span class="hljs-title function_">useGoogleAnalytics</span>();
  <span class="hljs-keyword">const</span> location = <span class="hljs-title function_">useLocation</span>();

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =></span> {
    <span class="hljs-keyword">if</span> (trackingId) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">trackPageView</span>(location.<span class="hljs-property">pathname</span> + location.<span class="hljs-property">search</span>);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Google Analytics의 trackPageView 실행 오류"</span>, { <span class="hljs-title class_">Error</span>: error });
      }
    }
  }, [location, trackPageView]);
  <span class="hljs-comment">// 참고: GoogleAnalyticsProvider가 UI에 영향을 미치지 않고 다른 컴포넌트를 감쌀 수 있도록 합니다.</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;></span>{children}<span class="hljs-tag">&#x3C;/></span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">GoogleAnalyticsProvider</span>;
</code></pre>
<p>App.tsx</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BrowserRouter</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Router</span>, <span class="hljs-title class_">Route</span>, <span class="hljs-title class_">Routes</span>, useLocation } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">GoogleAnalyticsProvider</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./providers/GoogleAnalyticsProvider'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =></span> {

  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">// 참고: GoogleAnalyticsProvider를 어디에 배치할지 확인하여 최적의 위치를 지정-</span>
    <span class="hljs-comment">// 모든 route 변경을 추적하기 위해 초기화를 최소화하고 오류를 캡처합니다 (오류 추적 서비스 사용 시)</span>
    <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">GoogleAnalyticsProvider</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Routes</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">Route</span>
          <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span>
          <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
            &#x3C;<span class="hljs-attr">div</span>></span>
              Google Analytics React TypeScript
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
          }
        />
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">Routes</span>></span>
    &#x3C;/GoogleAnalyticsProvider >
  );
}

export default App;
export default App;
</span></code></pre>
<h2>2가지 구현 방법</h2>
<ol>
<li>일반 추적 (현재 레포지토리) :sunglasses:</li>
</ol>
<p>장점:</p>
<ul>
<li>간단한 초기화: 설정을 통해 GAInitializer 컴포넌트가 마운트될 때 Google Analytics가 한 번만 초기화됩니다.</li>
<li>페이지 뷰 추적: 페이지 뷰를 추적하는 방법을 제공하여 각 페이지 방문이 로그에 기록되도록 수동으로 처리할 수 있습니다.</li>
<li>사용자 정의 이벤트: trackEventBuilder 메서드를 사용하면 다양한 사용자 상호작용을 추적하는 유연성을 제공합니다.</li>
</ul>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>단점:</p>
<ul>
<li>수동 페이지 뷰 추적: App 컴포넌트만 래핑하고 각 route 변경을 래핑하지 않기 때문에 각 route 변경마다 trackPageView를 수동으로 호출해야 합니다. 안 할 경우 인간 에러가 발생할 수 있습니다.</li>
<li>route 변경 추적 부족: route 변경을 자동으로 추적하지 않기 때문에, 각 컴포넌트에서 명시적으로 trackPageView를 호출하지 않으면 일부 페이지 뷰 로깅을 놓칠 수 있습니다.</li>
<li>제한된 사용자 컨텍스트: 기본 GA가 수집한 것 이상의 상세한 사용자 상호작용 또는 인구통계 데이터를 추적하지 않습니다.</li>
</ul>
<p>장점:</p>
<ul>
<li>이벤트 추적 기능을 모든 추적하고 싶은 이벤트에 추가</li>
<li>세밀한 제어: 추적할 이벤트와 해당 라벨을 정확하게 제어할 수 있어 매우 상세하고 구체적인 분석 데이터를 얻을 수 있습니다.</li>
<li>사용자 정의: 각 이벤트를 특정 범주, 동작, 라벨 및 값으로 사용자 정의할 수 있어 사용자의 행동과 상호작용에 대한 풍부한 통찰을 제공합니다.</li>
</ul>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>단점:</p>
<ul>
<li>유지보수 부담 : 애플리케이션이 커지면 수많은 개별 추적 호출을 관리하는 것이 시간이 오래 걸리고 일관되게 유지하는 것이 어려워질 수 있습니다.</li>
<li>코드 중복 : 여러 구성 요소나 함수에서 유사한 추적 코드를 반복해야 할 수 있으며, 결과적으로 DRY (Don't Repeat Yourself) 코드가 줄어들 수 있습니다.</li>
</ul>
<h2>콘텐츠 보안 정책 (CSP)</h2>
<p>GA를 구현하기 위해 GA 스크립트를 웹 애플리케이션에 포함하고 코드에서 추적을 설정하세요. '<a href="https://www.google-analytics.com%60%EB%A5%BC" rel="nofollow" target="_blank">https://www.google-analytics.com`를</a> script-src 및 connect-src 지시문에 추가하여 GA 서버로의 연결을 허용하도록 CSP를 구성하세요. Google Tag Manager를 사용하는 경우 script-src 지시문에 ‘<a href="https://www.googletagmanager.com%60%EB%8F%84" rel="nofollow" target="_blank">https://www.googletagmanager.com`도</a> 포함하고 CSP 구성을 철저히 테스트하세요.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>참고 자료</h2>
<p>Medium: ‘Google Analytics TypeScript로 React에 구현하기’</p>
<p>YouTube: ‘React JS에 Google Analytics 추가하기’</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"React와 TypeScript로 Google Analytics 사용 방법","description":"","date":"2024-07-07 21:58","slug":"2024-07-07-GoogleAnalyticsWithReactTypescript","content":"\n\u003cimg src=\"/TIL/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png\" /\u003e\n\n## GA 란?!!\n\nGoogle Analytics (GA)은 웹사이트 트래픽 및 사용자 행동을 추적하고 분석하는 강력한 도구입니다.\n\n다음은 그 동작 방식입니다:\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n당신의 웹사이트에서 GA는 JavaScript 추적 코드를 사용하여 데이터를 수집합니다. 이 코드는 웹사이트 페이지에 삽입되어 방문자에 대한 정보를 수집하고 Google의 서버로 보내어 처리되며 다양한 보고서에서 제공됩니다.\n\n## 구현은 어떻게 작동하나요?\n\nuseGoogleAnalytics.ts는 GA와 통합하기 위한 기본 파일로 사용됩니다. 우리는 유연성과 미래 지향성을 위해 GA 통합을 처리하기 위해 객체를 사용하고 있습니다.\n\nGoogleAnalyticsProvider.tsx는 라우트를 감싸는 공급자 컴포넌트로 사용됩니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nApp.tsx 파일을 수정하여 GoogleAnalyticsProvider 컴포넌트를 추가해주세요.\n\n이 방법을 선택한 이유는?\n\n- 다양한 기능 지원: 페이지 뷰, 이벤트 추적 및 초기화 후 구성을 쉽게 관리할 수 있습니다.\n\n- 미래를 대비: ReactGA에서 다른 솔루션(예: 미래의 GA 버전)으로 전환하더라도 코드 베이스의 각 인스턴스를 모두 업데이트해야 하는 것이 아니라 이 객체만 업데이트하면 됩니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- React 방식: 이 방법은 React의 최상의 실천 방법을 따르며 부작용을 처리하기 위해 컴포넌트를 사용합니다.\n\n// 코드에 있는 주석들\n앱에서 이를 검색하여 로직을 이해하고 앱에서 구현을 더 잘 할 수 있도록 하는 것을 추천합니다: `// 추천:` 및 `// 설명:`\n\nGitHub 저장소: ‘google-analytics-react-ts’\n\nuseGoogleAnalytics.ts.tsx\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nimport { useEffect } from \"react\";\nimport ReactGA from \"react-ga4\";\n\n// 추천: 환경 변수를 사용하여 비밀로 유지하는 것이 좋습니다.\nexport const trackingId = \"GA_ID\";\nconst appVersion = \"APP_VERSION\";\n// 참고: 분석을 보다 나은 것으로 만들기 위해 앱에서 사용자 ID를 사용하십시오.\n// 추천: Redux로 구현하는 것이 좋습니다.\nconst id = \"user-id\";\n\nconst useGoogleAnalytics = () =\u003e {\n  useEffect(() =\u003e {\n    if (trackingId) {\n      try {\n        ReactGA.initialize([\n          {\n            trackingId,\n            gaOptions: {\n              anonymizeIp: true,\n              clientId: id,\n            },\n          },\n        ]);\n        ReactGA.set({ app_version: appVersion });\n      } catch (error) {\n        // 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.\n        console.log(\"Google Analytics 초기화 오류\", { Error: error });\n      }\n    }\n  }, [id]);\n\n  const setOption = (key: string, value: unknown) =\u003e {\n    ReactGA.set({ [key]: value });\n  };\n\n  const setUserId = (userId: string | number) =\u003e {\n    setOption(\"userId\", userId);\n  };\n\n  const sendData = (type: string, data: Object) =\u003e {\n    ReactGA.send({ hitType: type, ...data });\n  };\n\n  const trackPageView = (pagePath?: string) =\u003e {\n    if (!pagePath) {\n      pagePath = location.href;\n    }\n\n    setOption(\"app_version\", appVersion);\n    sendData(\"pageview\", { page: pagePath });\n  };\n\n  const trackEvent = (category: string, action: string, label?: string, value?: number) =\u003e {\n    setOption(\"app_version\", appVersion);\n    ReactGA.event({ category, action, label, value });\n  };\n\n  return {\n    setOption,\n    setUserId,\n    trackPageView,\n    trackEvent,\n  };\n};\n\nexport default useGoogleAnalytics;\n```\n\nGoogleAnalyticsProvider.tsx\n\n```js\nimport React, { useEffect, PropsWithChildren } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport useGoogleAnalytics, { trackingId } from \"../hooks/useGoogleAnalytics\";\n\nconst GoogleAnalyticsProvider: React.FC\u003cPropsWithChildren\u003c{}\u003e\u003e = ({ children }) =\u003e {\n  const { trackPageView } = useGoogleAnalytics();\n  const location = useLocation();\n\n  useEffect(() =\u003e {\n    if (trackingId) {\n      try {\n        trackPageView(location.pathname + location.search);\n      } catch (error) {\n        // 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.\n        console.log(\"Google Analytics의 trackPageView 실행 오류\", { Error: error });\n      }\n    }\n  }, [location, trackPageView]);\n  // 참고: GoogleAnalyticsProvider가 UI에 영향을 미치지 않고 다른 컴포넌트를 감쌀 수 있도록 합니다.\n  return \u003c\u003e{children}\u003c/\u003e;\n};\n\nexport default GoogleAnalyticsProvider;\n```\n\nApp.tsx\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nimport { BrowserRouter as Router, Route, Routes, useLocation } from 'react-router-dom';\nimport './App.css';\nimport GoogleAnalyticsProvider from './providers/GoogleAnalyticsProvider';\n\nconst App: React.FC = () =\u003e {\n\n  return (\n    // 참고: GoogleAnalyticsProvider를 어디에 배치할지 확인하여 최적의 위치를 지정-\n    // 모든 route 변경을 추적하기 위해 초기화를 최소화하고 오류를 캡처합니다 (오류 추적 서비스 사용 시)\n    \u003cGoogleAnalyticsProvider\u003e\n      \u003cRoutes\u003e\n        \u003cRoute\n          path=\"/\"\n          element={\n            \u003cdiv\u003e\n              Google Analytics React TypeScript\n            \u003c/div\u003e\n          }\n        /\u003e\n      \u003c/Routes\u003e\n    \u003c/GoogleAnalyticsProvider \u003e\n  );\n}\n\nexport default App;\nexport default App;\n```\n\n## 2가지 구현 방법\n\n1. 일반 추적 (현재 레포지토리) :sunglasses:\n\n장점:\n\n- 간단한 초기화: 설정을 통해 GAInitializer 컴포넌트가 마운트될 때 Google Analytics가 한 번만 초기화됩니다.\n- 페이지 뷰 추적: 페이지 뷰를 추적하는 방법을 제공하여 각 페이지 방문이 로그에 기록되도록 수동으로 처리할 수 있습니다.\n- 사용자 정의 이벤트: trackEventBuilder 메서드를 사용하면 다양한 사용자 상호작용을 추적하는 유연성을 제공합니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n단점:\n\n- 수동 페이지 뷰 추적: App 컴포넌트만 래핑하고 각 route 변경을 래핑하지 않기 때문에 각 route 변경마다 trackPageView를 수동으로 호출해야 합니다. 안 할 경우 인간 에러가 발생할 수 있습니다.\n- route 변경 추적 부족: route 변경을 자동으로 추적하지 않기 때문에, 각 컴포넌트에서 명시적으로 trackPageView를 호출하지 않으면 일부 페이지 뷰 로깅을 놓칠 수 있습니다.\n- 제한된 사용자 컨텍스트: 기본 GA가 수집한 것 이상의 상세한 사용자 상호작용 또는 인구통계 데이터를 추적하지 않습니다.\n\n장점:\n\n- 이벤트 추적 기능을 모든 추적하고 싶은 이벤트에 추가\n- 세밀한 제어: 추적할 이벤트와 해당 라벨을 정확하게 제어할 수 있어 매우 상세하고 구체적인 분석 데이터를 얻을 수 있습니다.\n- 사용자 정의: 각 이벤트를 특정 범주, 동작, 라벨 및 값으로 사용자 정의할 수 있어 사용자의 행동과 상호작용에 대한 풍부한 통찰을 제공합니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n단점:\n\n- 유지보수 부담 : 애플리케이션이 커지면 수많은 개별 추적 호출을 관리하는 것이 시간이 오래 걸리고 일관되게 유지하는 것이 어려워질 수 있습니다.\n- 코드 중복 : 여러 구성 요소나 함수에서 유사한 추적 코드를 반복해야 할 수 있으며, 결과적으로 DRY (Don't Repeat Yourself) 코드가 줄어들 수 있습니다.\n\n## 콘텐츠 보안 정책 (CSP)\n\nGA를 구현하기 위해 GA 스크립트를 웹 애플리케이션에 포함하고 코드에서 추적을 설정하세요. 'https://www.google-analytics.com`를 script-src 및 connect-src 지시문에 추가하여 GA 서버로의 연결을 허용하도록 CSP를 구성하세요. Google Tag Manager를 사용하는 경우 script-src 지시문에 ‘https://www.googletagmanager.com`도 포함하고 CSP 구성을 철저히 테스트하세요.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 참고 자료\n\nMedium: ‘Google Analytics TypeScript로 React에 구현하기’\n\nYouTube: ‘React JS에 Google Analytics 추가하기’\n","ogImage":{"url":"/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png"},"coverImage":"/TIL/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png","tag":["Tech"],"readingTime":8},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-07-GoogleAnalyticsWithReactTypescript_0.png\"\u003e\n\u003ch2\u003eGA 란?!!\u003c/h2\u003e\n\u003cp\u003eGoogle Analytics (GA)은 웹사이트 트래픽 및 사용자 행동을 추적하고 분석하는 강력한 도구입니다.\u003c/p\u003e\n\u003cp\u003e다음은 그 동작 방식입니다:\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e당신의 웹사이트에서 GA는 JavaScript 추적 코드를 사용하여 데이터를 수집합니다. 이 코드는 웹사이트 페이지에 삽입되어 방문자에 대한 정보를 수집하고 Google의 서버로 보내어 처리되며 다양한 보고서에서 제공됩니다.\u003c/p\u003e\n\u003ch2\u003e구현은 어떻게 작동하나요?\u003c/h2\u003e\n\u003cp\u003euseGoogleAnalytics.ts는 GA와 통합하기 위한 기본 파일로 사용됩니다. 우리는 유연성과 미래 지향성을 위해 GA 통합을 처리하기 위해 객체를 사용하고 있습니다.\u003c/p\u003e\n\u003cp\u003eGoogleAnalyticsProvider.tsx는 라우트를 감싸는 공급자 컴포넌트로 사용됩니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eApp.tsx 파일을 수정하여 GoogleAnalyticsProvider 컴포넌트를 추가해주세요.\u003c/p\u003e\n\u003cp\u003e이 방법을 선택한 이유는?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e다양한 기능 지원: 페이지 뷰, 이벤트 추적 및 초기화 후 구성을 쉽게 관리할 수 있습니다.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e미래를 대비: ReactGA에서 다른 솔루션(예: 미래의 GA 버전)으로 전환하더라도 코드 베이스의 각 인스턴스를 모두 업데이트해야 하는 것이 아니라 이 객체만 업데이트하면 됩니다.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eReact 방식: 이 방법은 React의 최상의 실천 방법을 따르며 부작용을 처리하기 위해 컴포넌트를 사용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e// 코드에 있는 주석들\n앱에서 이를 검색하여 로직을 이해하고 앱에서 구현을 더 잘 할 수 있도록 하는 것을 추천합니다: \u003ccode\u003e// 추천:\u003c/code\u003e 및 \u003ccode\u003e// 설명:\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eGitHub 저장소: ‘google-analytics-react-ts’\u003c/p\u003e\n\u003cp\u003euseGoogleAnalytics.ts.tsx\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useEffect } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"react\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"react-ga4\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// 추천: 환경 변수를 사용하여 비밀로 유지하는 것이 좋습니다.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e trackingId = \u003cspan class=\"hljs-string\"\u003e\"GA_ID\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e appVersion = \u003cspan class=\"hljs-string\"\u003e\"APP_VERSION\"\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e// 참고: 분석을 보다 나은 것으로 만들기 위해 앱에서 사용자 ID를 사용하십시오.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// 추천: Redux로 구현하는 것이 좋습니다.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e id = \u003cspan class=\"hljs-string\"\u003e\"user-id\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003euseGoogleAnalytics\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) =\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (trackingId) {\n      \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einitialize\u003c/span\u003e([\n          {\n            trackingId,\n            \u003cspan class=\"hljs-attr\"\u003egaOptions\u003c/span\u003e: {\n              \u003cspan class=\"hljs-attr\"\u003eanonymizeIp\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n              \u003cspan class=\"hljs-attr\"\u003eclientId\u003c/span\u003e: id,\n            },\n          },\n        ]);\n        \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003eapp_version\u003c/span\u003e: appVersion });\n      } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n        \u003cspan class=\"hljs-comment\"\u003e// 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.\u003c/span\u003e\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Google Analytics 초기화 오류\"\u003c/span\u003e, { \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: error });\n      }\n    }\n  }, [id]);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esetOption\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003ekey: string, value: unknown\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e({ [key]: value });\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esetUserId\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003euserId: string | number\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003esetOption\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"userId\"\u003c/span\u003e, userId);\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esendData\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003etype: string, data: \u003cspan class=\"hljs-built_in\"\u003eObject\u003c/span\u003e\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003esend\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003ehitType\u003c/span\u003e: type, ...data });\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etrackPageView\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003epagePath?: string\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!pagePath) {\n      pagePath = location.\u003cspan class=\"hljs-property\"\u003ehref\u003c/span\u003e;\n    }\n\n    \u003cspan class=\"hljs-title function_\"\u003esetOption\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"app_version\"\u003c/span\u003e, appVersion);\n    \u003cspan class=\"hljs-title function_\"\u003esendData\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"pageview\"\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003epage\u003c/span\u003e: pagePath });\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etrackEvent\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003ecategory: string, action: string, label?: string, value?: number\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003esetOption\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"app_version\"\u003c/span\u003e, appVersion);\n    \u003cspan class=\"hljs-title class_\"\u003eReactGA\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eevent\u003c/span\u003e({ category, action, label, value });\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n    setOption,\n    setUserId,\n    trackPageView,\n    trackEvent,\n  };\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e useGoogleAnalytics;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eGoogleAnalyticsProvider.tsx\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e, { useEffect, \u003cspan class=\"hljs-title class_\"\u003ePropsWithChildren\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"react\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useLocation } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"react-router-dom\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e useGoogleAnalytics, { trackingId } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"../hooks/useGoogleAnalytics\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGoogleAnalyticsProvider\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eFC\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003ePropsWithChildren\u003c/span\u003e\u0026#x3C;{}\u003e\u003e = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ children }\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { trackPageView } = \u003cspan class=\"hljs-title function_\"\u003euseGoogleAnalytics\u003c/span\u003e();\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e location = \u003cspan class=\"hljs-title function_\"\u003euseLocation\u003c/span\u003e();\n\n  \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (trackingId) {\n      \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_\"\u003etrackPageView\u003c/span\u003e(location.\u003cspan class=\"hljs-property\"\u003epathname\u003c/span\u003e + location.\u003cspan class=\"hljs-property\"\u003esearch\u003c/span\u003e);\n      } \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n        \u003cspan class=\"hljs-comment\"\u003e// 추천: 이 오류를 오류 추적 서비스에 보고하는 것이 좋습니다.\u003c/span\u003e\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Google Analytics의 trackPageView 실행 오류\"\u003c/span\u003e, { \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: error });\n      }\n    }\n  }, [location, trackPageView]);\n  \u003cspan class=\"hljs-comment\"\u003e// 참고: GoogleAnalyticsProvider가 UI에 영향을 미치지 않고 다른 컴포넌트를 감쌀 수 있도록 합니다.\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003e\u003c/span\u003e{children}\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003e\u003c/span\u003e\u003c/span\u003e;\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGoogleAnalyticsProvider\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eApp.tsx\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eBrowserRouter\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRouter\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eRoutes\u003c/span\u003e, useLocation } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'react-router-dom'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./App.css'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGoogleAnalyticsProvider\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./providers/GoogleAnalyticsProvider'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eApp\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eFC\u003c/span\u003e = \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"hljs-comment\"\u003e// 참고: GoogleAnalyticsProvider를 어디에 배치할지 확인하여 최적의 위치를 지정-\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// 모든 route 변경을 추적하기 위해 초기화를 최소화하고 오류를 캡처합니다 (오류 추적 서비스 사용 시)\u003c/span\u003e\n    \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eGoogleAnalyticsProvider\u003c/span\u003e\u003e\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eRoutes\u003c/span\u003e\u003e\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eRoute\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003eelement\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{\u003c/span\u003e\n            \u0026#x3C;\u003cspan class=\"hljs-attr\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\n              Google Analytics React TypeScript\n            \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u003e\u003c/span\u003e\n          }\n        /\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;/\u003cspan class=\"hljs-name\"\u003eRoutes\u003c/span\u003e\u003e\u003c/span\u003e\n    \u0026#x3C;/GoogleAnalyticsProvider \u003e\n  );\n}\n\nexport default App;\nexport default App;\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e2가지 구현 방법\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e일반 추적 (현재 레포지토리) :sunglasses:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e장점:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e간단한 초기화: 설정을 통해 GAInitializer 컴포넌트가 마운트될 때 Google Analytics가 한 번만 초기화됩니다.\u003c/li\u003e\n\u003cli\u003e페이지 뷰 추적: 페이지 뷰를 추적하는 방법을 제공하여 각 페이지 방문이 로그에 기록되도록 수동으로 처리할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e사용자 정의 이벤트: trackEventBuilder 메서드를 사용하면 다양한 사용자 상호작용을 추적하는 유연성을 제공합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e단점:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e수동 페이지 뷰 추적: App 컴포넌트만 래핑하고 각 route 변경을 래핑하지 않기 때문에 각 route 변경마다 trackPageView를 수동으로 호출해야 합니다. 안 할 경우 인간 에러가 발생할 수 있습니다.\u003c/li\u003e\n\u003cli\u003eroute 변경 추적 부족: route 변경을 자동으로 추적하지 않기 때문에, 각 컴포넌트에서 명시적으로 trackPageView를 호출하지 않으면 일부 페이지 뷰 로깅을 놓칠 수 있습니다.\u003c/li\u003e\n\u003cli\u003e제한된 사용자 컨텍스트: 기본 GA가 수집한 것 이상의 상세한 사용자 상호작용 또는 인구통계 데이터를 추적하지 않습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e장점:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e이벤트 추적 기능을 모든 추적하고 싶은 이벤트에 추가\u003c/li\u003e\n\u003cli\u003e세밀한 제어: 추적할 이벤트와 해당 라벨을 정확하게 제어할 수 있어 매우 상세하고 구체적인 분석 데이터를 얻을 수 있습니다.\u003c/li\u003e\n\u003cli\u003e사용자 정의: 각 이벤트를 특정 범주, 동작, 라벨 및 값으로 사용자 정의할 수 있어 사용자의 행동과 상호작용에 대한 풍부한 통찰을 제공합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e단점:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e유지보수 부담 : 애플리케이션이 커지면 수많은 개별 추적 호출을 관리하는 것이 시간이 오래 걸리고 일관되게 유지하는 것이 어려워질 수 있습니다.\u003c/li\u003e\n\u003cli\u003e코드 중복 : 여러 구성 요소나 함수에서 유사한 추적 코드를 반복해야 할 수 있으며, 결과적으로 DRY (Don't Repeat Yourself) 코드가 줄어들 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e콘텐츠 보안 정책 (CSP)\u003c/h2\u003e\n\u003cp\u003eGA를 구현하기 위해 GA 스크립트를 웹 애플리케이션에 포함하고 코드에서 추적을 설정하세요. '\u003ca href=\"https://www.google-analytics.com%60%EB%A5%BC\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.google-analytics.com`를\u003c/a\u003e script-src 및 connect-src 지시문에 추가하여 GA 서버로의 연결을 허용하도록 CSP를 구성하세요. Google Tag Manager를 사용하는 경우 script-src 지시문에 ‘\u003ca href=\"https://www.googletagmanager.com%60%EB%8F%84\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.googletagmanager.com`도\u003c/a\u003e 포함하고 CSP 구성을 철저히 테스트하세요.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e참고 자료\u003c/h2\u003e\n\u003cp\u003eMedium: ‘Google Analytics TypeScript로 React에 구현하기’\u003c/p\u003e\n\u003cp\u003eYouTube: ‘React JS에 Google Analytics 추가하기’\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-07-07-GoogleAnalyticsWithReactTypescript"},"buildId":"KUC9M_yIlA1Ugo01xmkHL","assetPrefix":"/TIL","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>