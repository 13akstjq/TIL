<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법 | TIL</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://13akstjq.github.io/TIL//post/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법 | TIL" data-gatsby-head="true"/><meta property="og:title" content="빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법 | TIL" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://TIL.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://13akstjq.github.io/TIL//post/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform" data-gatsby-head="true"/><meta name="twitter:title" content="빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법 | TIL" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | TIL" data-gatsby-head="true"/><meta name="article:published_time" content="2024-07-09 15:03" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/TIL/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/TIL/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/TIL/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/TIL/favicons/favicon-96x96.png"/><link rel="icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/TIL/favicons/browserconfig.xml"/><link rel="preload" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/TIL/_next/static/css/0eef537492fed77a.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/0eef537492fed77a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/TIL/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/TIL/_next/static/chunks/webpack-21ffe88bdca56cba.js" defer=""></script><script src="/TIL/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/TIL/_next/static/chunks/main-a5eeabb286676ce6.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/TIL/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/TIL/_next/static/chunks/348-02483b66b493dd81.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/post/%5Bslug%5D-8ded8b979ba73586.js" defer=""></script><script src="/TIL/_next/static/olPs1cVezSGTqD7OaewDI/_buildManifest.js" defer=""></script><script src="/TIL/_next/static/olPs1cVezSGTqD7OaewDI/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/TIL">TIL</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/TIL/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/TIL/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">TIL</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jul 9, 2024</span><span class="posts_reading_time__f7YPP">7<!-- --> min read</span></span></div></div></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h1>소개</h1>
<p>금융 시장은 본질적으로 소음이 많고 예측할 수 없어서, 수익성 있는 기회를 식별하고 활용하려는 트레이더와 투자자에게 상당한 어려움을 줍니다.</p>
<p>이 복잡성을 해결하기 위해 현대 트레이더들은 수학적 및 통계적 기술을 활용하여 소음을 걸러내고 데이터의 기저 주기/트렌드를 더 명확히 이해하기 위한 다양한 기법을 사용합니다. FFT(Fast Fourier Transform) 알고리즘은 이러한 강력한 도구 중 하나로, 어떤 신호/파형을 주파수가 변하는 사인 성분들의 합으로 표현하는 데 사용되는 알고리즘입니다. 따라서 시간 영역에서 주파수 영역으로 신호를 변환합니다.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/1*e-_z80BnbHWyFTfRLblJ_w.gif" alt="image"></p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 기사에서 논의하는 FFT 알고리즘은 신호 처리를 사용하여 가장 중요한 주파수를 감지하고 데이터에서 잡음을 제거합니다.</p>
<h1>FFT를 사용하는 이유?</h1>
<h2>주기와 패턴 감지</h2>
<p>주식 가격이나 거래량과 같은 금융 시계열은 다양한 경제 주기, 계절성 또는 투자자 행동으로 인해 주기적인 패턴을 나타내는 경우가 많습니다. 푸리에 변환은 이러한 주기와 해당 주파수를 식별하는 데 도움이 됩니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>소음 필터링</h2>
<p>금융 데이터는 종종 무작위 변동으로 인해 소음이 발생합니다. 데이터를 주파수 영역으로 변환하여 분석가들은 고주파 소음을 제거하여 중요한 저주파수 트렌드에 집중할 수 있습니다.</p>
<h2>예측 모델링</h2>
<p>주파수를 식별함으로써, 분석가들은 역사적인 패턴을 기반으로 미래 가격 변동이나 트렌드에 대한 예측을 할 수 있습니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>기계 학습을 위한 기능 추출</h2>
<p>Fourier 변환에서 얻은 주파수 구성 요소는 머신 러닝 모델에서 특징으로 사용되어 예측의 정확도를 향상시킬 수 있습니다.</p>
<h1>코드 및 단계별 분석</h1>
<h2>노트북 설정 및 주식 데이터 수집</h2>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>필요한 기본 주식 데이터 수집 및 데이터 프레임 조작을 위한 라이브러리 가져오기가 첫 번째 단계입니다.</p>
<p>또한, 분석 기간을 1년으로 설정하고 분석할 주식은 Tata Consultancy Services (TCS)입니다. 필요한 주식의 OLHCAV 데이터는 'df'라는 데이터 프레임에 저장되어 있습니다.</p>
<pre><code class="hljs language-js">#라이브러리 가져오기
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> pandas_datareader <span class="hljs-keyword">import</span> data <span class="hljs-keyword">as</span> pdr
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">import</span> scipy.<span class="hljs-property">stats</span> <span class="hljs-keyword">as</span> stats
<span class="hljs-keyword">import</span> matplotlib.<span class="hljs-property">pyplot</span> <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> yfinance <span class="hljs-keyword">as</span> yfin
yfin.<span class="hljs-title function_">pdr_override</span>()

# 분석 기간 설정
end_date = datetime.<span class="hljs-property">datetime</span>.<span class="hljs-title function_">now</span>()
start_date = end_date - datetime.<span class="hljs-title function_">timedelta</span>(<span class="hljs-number">365</span>)
ticker = <span class="hljs-string">'TCS'</span>

df = pdr.<span class="hljs-title function_">get_data_yahoo</span>(ticker + <span class="hljs-string">'.NS'</span>, start = start_date, end = end_date)
</code></pre>
<h2>FFT의 적용</h2>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>np.fft.fft()을 사용하여 푸리에 변환을 수행할 것이며, np.fft.fftfreq()를 사용하여 주파수를 얻을 것입니다. 가장 중요한 주파수가 나타나는 때를 나타내기 위해 진폭 대 주기를 그래프로 그려볼 수 있습니다.</p>
<pre><code class="hljs language-js">fft_result = np.<span class="hljs-property">fft</span>.<span class="hljs-title function_">fft</span>(df[<span class="hljs-string">'Close'</span>])
frequencies = np.<span class="hljs-property">fft</span>.<span class="hljs-title function_">fftfreq</span>(<span class="hljs-title function_">len</span>(fft_result), d=<span class="hljs-number">1</span>)  # assuming daily data, d=<span class="hljs-number">1</span>
magnitude = np.<span class="hljs-title function_">abs</span>(fft_result)
periods = <span class="hljs-number">1</span> / frequencies
</code></pre>
<h2>가격 및 주파수 영역 표현 시각화</h2>
<p>아래의 주파수 플롯은 시계열 내에서 우세한 주파수를 강조합니다. 이러한 주파수는 역 FFT를 수행하거나 원래 시계열을 다시 만들거나 잡음을 줄인 버전을 생성하는 데 사용될 수 있습니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"># 가격의 간단한 시각화
plt.<span class="hljs-title function_">figure</span>(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))
plt.<span class="hljs-title function_">subplot</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
plt.<span class="hljs-title function_">plot</span>(df.<span class="hljs-property">index</span>, df[<span class="hljs-string">'Close'</span>])
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">'TCS 시계열'</span>)
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">'날짜'</span>)
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">'가격'</span>)

# 주파수 도메인 표현
plt.<span class="hljs-title function_">subplot</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
plt.<span class="hljs-title function_">plot</span>(periods, magnitude)
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">'TCS의 FFT'</span>)
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">'기간 (일)'</span>)
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">'크기'</span>)
plt.<span class="hljs-title function_">xlim</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_">max</span>(periods[<span class="hljs-number">1</span>:]))  # 중요한 주기를 보기 위한 x-축 제한 (큰 주기 무시)
plt.<span class="hljs-title function_">ylim</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_">max</span>(magnitude[<span class="hljs-number">1</span>:]) * <span class="hljs-number">1.1</span>)  # 제로 주파수 구성요소 무시

plt.<span class="hljs-title function_">tight_layout</span>()
plt.<span class="hljs-title function_">show</span>()
</code></pre>
<img src="/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png">
<p>하지만, 이러한 우세 주파수의 중요성은 단순히 시계열을 재구성하는 데서 그치지 않습니다. 이들은 시계열 구조에 영향을 미치는 주요 경제 보고서나 거시경제 사건과 관련될 수 있습니다.</p>
<h2>원래 주식 시장 데이터 복구하기</h2>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>np.fft.ifft() 함수를 사용하여 원래의 시계열을 복원할 수 있습니다. 이 함수는 fft_results를 역변환합니다. 아래 그래프에서 볼 수 있듯이 완벽하게 재구성되었습니다.</p>
<pre><code class="hljs language-js">recovered = np.<span class="hljs-property">fft</span>.<span class="hljs-title function_">ifft</span>(fft_result);
plt.<span class="hljs-title function_">figure</span>((figsize = (<span class="hljs-number">14</span>, <span class="hljs-number">6</span>)));
plt.<span class="hljs-title function_">plot</span>(df.<span class="hljs-property">index</span>, df[<span class="hljs-string">"Close"</span>], (label = <span class="hljs-string">"Original"</span>));
plt.<span class="hljs-title function_">plot</span>(df.<span class="hljs-property">index</span>, recovered, (label = <span class="hljs-string">"Recovered"</span>));
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">"TCS 시계열: FFT 역변환"</span>);
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">"날짜"</span>);
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">"가격"</span>);
plt.<span class="hljs-title function_">legend</span>();
plt.<span class="hljs-title function_">show</span>();
</code></pre>
<img src="/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_1.png">
<h2>주요 주파수를 갖는 파형의 재구성</h2>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이것은 상위 25개 FFT 주파수만 사용하여 재구성된 신호를 생성합니다. 이것은 데이터의 노이즈 제거를 의미합니다.</p>
<pre><code class="hljs language-js">dominant_periods = pd.<span class="hljs-title class_">Series</span>(periods, (index = magnitude)).<span class="hljs-title function_">nlargest</span>(<span class="hljs-number">25</span>);
dominant_periods.<span class="hljs-title function_">to_frame</span>(<span class="hljs-string">"주기 (일)"</span>);
top_periods = dominant_periods.<span class="hljs-property">index</span>;
top_fft_result = fft_result.<span class="hljs-title function_">copy</span>();
top_fft_result[np.<span class="hljs-title function_">abs</span>(frequencies) > <span class="hljs-number">1</span> / top_periods.<span class="hljs-title function_">min</span>()] = <span class="hljs-number">0</span>;
top_recovered = np.<span class="hljs-property">fft</span>.<span class="hljs-title function_">ifft</span>(top_fft_result);

plt.<span class="hljs-title function_">figure</span>((figsize = (<span class="hljs-number">14</span>, <span class="hljs-number">6</span>)));
plt.<span class="hljs-title function_">plot</span>(df.<span class="hljs-property">index</span>, df[<span class="hljs-string">"Close"</span>], (label = <span class="hljs-string">"원본"</span>));
plt.<span class="hljs-title function_">plot</span>(df.<span class="hljs-property">index</span>, top_recovered, (label = <span class="hljs-string">"복원된"</span>));
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">"TCS 시계열: FFT 역변환"</span>);
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">"날짜"</span>);
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">"가격"</span>);
plt.<span class="hljs-title function_">legend</span>();
plt.<span class="hljs-title function_">show</span>();
</code></pre>
<img src="/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_2.png">
<h1>결론</h1>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 문서에서 설명한 알고리즘은 산업 전문가들이 사용하는 분석을 지나치게 단순화한 것입니다. 성능을 개선하기 위해 일반적으로 매일 모델을 조정합니다.</p>
<p>도움이 되었기를 바라며, 여기에 GitHub 파일을 찾을 수 있습니다: <a href="https://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main" rel="nofollow" target="_blank">https://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main</a></p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"빠른 푸리에 변환을 이용한 주식 시장 신호 분석 방법","description":"","date":"2024-07-09 15:03","slug":"2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform","content":"\n# 소개\n\n금융 시장은 본질적으로 소음이 많고 예측할 수 없어서, 수익성 있는 기회를 식별하고 활용하려는 트레이더와 투자자에게 상당한 어려움을 줍니다.\n\n이 복잡성을 해결하기 위해 현대 트레이더들은 수학적 및 통계적 기술을 활용하여 소음을 걸러내고 데이터의 기저 주기/트렌드를 더 명확히 이해하기 위한 다양한 기법을 사용합니다. FFT(Fast Fourier Transform) 알고리즘은 이러한 강력한 도구 중 하나로, 어떤 신호/파형을 주파수가 변하는 사인 성분들의 합으로 표현하는 데 사용되는 알고리즘입니다. 따라서 시간 영역에서 주파수 영역으로 신호를 변환합니다.\n\n![image](https://miro.medium.com/v2/resize:fit:1400/1*e-_z80BnbHWyFTfRLblJ_w.gif)\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 기사에서 논의하는 FFT 알고리즘은 신호 처리를 사용하여 가장 중요한 주파수를 감지하고 데이터에서 잡음을 제거합니다.\n\n# FFT를 사용하는 이유?\n\n## 주기와 패턴 감지\n\n주식 가격이나 거래량과 같은 금융 시계열은 다양한 경제 주기, 계절성 또는 투자자 행동으로 인해 주기적인 패턴을 나타내는 경우가 많습니다. 푸리에 변환은 이러한 주기와 해당 주파수를 식별하는 데 도움이 됩니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 소음 필터링\n\n금융 데이터는 종종 무작위 변동으로 인해 소음이 발생합니다. 데이터를 주파수 영역으로 변환하여 분석가들은 고주파 소음을 제거하여 중요한 저주파수 트렌드에 집중할 수 있습니다.\n\n## 예측 모델링\n\n주파수를 식별함으로써, 분석가들은 역사적인 패턴을 기반으로 미래 가격 변동이나 트렌드에 대한 예측을 할 수 있습니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 기계 학습을 위한 기능 추출\n\nFourier 변환에서 얻은 주파수 구성 요소는 머신 러닝 모델에서 특징으로 사용되어 예측의 정확도를 향상시킬 수 있습니다.\n\n# 코드 및 단계별 분석\n\n## 노트북 설정 및 주식 데이터 수집\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n필요한 기본 주식 데이터 수집 및 데이터 프레임 조작을 위한 라이브러리 가져오기가 첫 번째 단계입니다.\n\n또한, 분석 기간을 1년으로 설정하고 분석할 주식은 Tata Consultancy Services (TCS)입니다. 필요한 주식의 OLHCAV 데이터는 'df'라는 데이터 프레임에 저장되어 있습니다.\n\n```js\n#라이브러리 가져오기\nimport pandas as pd\nfrom pandas_datareader import data as pdr\nimport numpy as np\nimport math\nimport datetime\nimport scipy.stats as stats\nimport matplotlib.pyplot as plt\nimport yfinance as yfin\nyfin.pdr_override()\n\n# 분석 기간 설정\nend_date = datetime.datetime.now()\nstart_date = end_date - datetime.timedelta(365)\nticker = 'TCS'\n\ndf = pdr.get_data_yahoo(ticker + '.NS', start = start_date, end = end_date)\n```\n\n## FFT의 적용\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nnp.fft.fft()을 사용하여 푸리에 변환을 수행할 것이며, np.fft.fftfreq()를 사용하여 주파수를 얻을 것입니다. 가장 중요한 주파수가 나타나는 때를 나타내기 위해 진폭 대 주기를 그래프로 그려볼 수 있습니다.\n\n```js\nfft_result = np.fft.fft(df['Close'])\nfrequencies = np.fft.fftfreq(len(fft_result), d=1)  # assuming daily data, d=1\nmagnitude = np.abs(fft_result)\nperiods = 1 / frequencies\n```\n\n## 가격 및 주파수 영역 표현 시각화\n\n아래의 주파수 플롯은 시계열 내에서 우세한 주파수를 강조합니다. 이러한 주파수는 역 FFT를 수행하거나 원래 시계열을 다시 만들거나 잡음을 줄인 버전을 생성하는 데 사용될 수 있습니다.\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n# 가격의 간단한 시각화\nplt.figure(figsize=(10, 8))\nplt.subplot(2, 1, 1)\nplt.plot(df.index, df['Close'])\nplt.title('TCS 시계열')\nplt.xlabel('날짜')\nplt.ylabel('가격')\n\n# 주파수 도메인 표현\nplt.subplot(2, 1, 2)\nplt.plot(periods, magnitude)\nplt.title('TCS의 FFT')\nplt.xlabel('기간 (일)')\nplt.ylabel('크기')\nplt.xlim(0, max(periods[1:]))  # 중요한 주기를 보기 위한 x-축 제한 (큰 주기 무시)\nplt.ylim(0, max(magnitude[1:]) * 1.1)  # 제로 주파수 구성요소 무시\n\nplt.tight_layout()\nplt.show()\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png\" /\u003e\n\n하지만, 이러한 우세 주파수의 중요성은 단순히 시계열을 재구성하는 데서 그치지 않습니다. 이들은 시계열 구조에 영향을 미치는 주요 경제 보고서나 거시경제 사건과 관련될 수 있습니다.\n\n## 원래 주식 시장 데이터 복구하기\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nnp.fft.ifft() 함수를 사용하여 원래의 시계열을 복원할 수 있습니다. 이 함수는 fft_results를 역변환합니다. 아래 그래프에서 볼 수 있듯이 완벽하게 재구성되었습니다.\n\n```js\nrecovered = np.fft.ifft(fft_result);\nplt.figure((figsize = (14, 6)));\nplt.plot(df.index, df[\"Close\"], (label = \"Original\"));\nplt.plot(df.index, recovered, (label = \"Recovered\"));\nplt.title(\"TCS 시계열: FFT 역변환\");\nplt.xlabel(\"날짜\");\nplt.ylabel(\"가격\");\nplt.legend();\nplt.show();\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_1.png\" /\u003e\n\n## 주요 주파수를 갖는 파형의 재구성\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이것은 상위 25개 FFT 주파수만 사용하여 재구성된 신호를 생성합니다. 이것은 데이터의 노이즈 제거를 의미합니다.\n\n```js\ndominant_periods = pd.Series(periods, (index = magnitude)).nlargest(25);\ndominant_periods.to_frame(\"주기 (일)\");\ntop_periods = dominant_periods.index;\ntop_fft_result = fft_result.copy();\ntop_fft_result[np.abs(frequencies) \u003e 1 / top_periods.min()] = 0;\ntop_recovered = np.fft.ifft(top_fft_result);\n\nplt.figure((figsize = (14, 6)));\nplt.plot(df.index, df[\"Close\"], (label = \"원본\"));\nplt.plot(df.index, top_recovered, (label = \"복원된\"));\nplt.title(\"TCS 시계열: FFT 역변환\");\nplt.xlabel(\"날짜\");\nplt.ylabel(\"가격\");\nplt.legend();\nplt.show();\n```\n\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_2.png\" /\u003e\n\n# 결론\n\n\u003c!-- TIL 수평 --\u003e\n\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 문서에서 설명한 알고리즘은 산업 전문가들이 사용하는 분석을 지나치게 단순화한 것입니다. 성능을 개선하기 위해 일반적으로 매일 모델을 조정합니다.\n\n도움이 되었기를 바라며, 여기에 GitHub 파일을 찾을 수 있습니다: [https://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main](https://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main)\n","ogImage":{"url":"/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png"},"coverImage":"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png","tag":["Tech"],"readingTime":7},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003e소개\u003c/h1\u003e\n\u003cp\u003e금융 시장은 본질적으로 소음이 많고 예측할 수 없어서, 수익성 있는 기회를 식별하고 활용하려는 트레이더와 투자자에게 상당한 어려움을 줍니다.\u003c/p\u003e\n\u003cp\u003e이 복잡성을 해결하기 위해 현대 트레이더들은 수학적 및 통계적 기술을 활용하여 소음을 걸러내고 데이터의 기저 주기/트렌드를 더 명확히 이해하기 위한 다양한 기법을 사용합니다. FFT(Fast Fourier Transform) 알고리즘은 이러한 강력한 도구 중 하나로, 어떤 신호/파형을 주파수가 변하는 사인 성분들의 합으로 표현하는 데 사용되는 알고리즘입니다. 따라서 시간 영역에서 주파수 영역으로 신호를 변환합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:1400/1*e-_z80BnbHWyFTfRLblJ_w.gif\" alt=\"image\"\u003e\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 기사에서 논의하는 FFT 알고리즘은 신호 처리를 사용하여 가장 중요한 주파수를 감지하고 데이터에서 잡음을 제거합니다.\u003c/p\u003e\n\u003ch1\u003eFFT를 사용하는 이유?\u003c/h1\u003e\n\u003ch2\u003e주기와 패턴 감지\u003c/h2\u003e\n\u003cp\u003e주식 가격이나 거래량과 같은 금융 시계열은 다양한 경제 주기, 계절성 또는 투자자 행동으로 인해 주기적인 패턴을 나타내는 경우가 많습니다. 푸리에 변환은 이러한 주기와 해당 주파수를 식별하는 데 도움이 됩니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e소음 필터링\u003c/h2\u003e\n\u003cp\u003e금융 데이터는 종종 무작위 변동으로 인해 소음이 발생합니다. 데이터를 주파수 영역으로 변환하여 분석가들은 고주파 소음을 제거하여 중요한 저주파수 트렌드에 집중할 수 있습니다.\u003c/p\u003e\n\u003ch2\u003e예측 모델링\u003c/h2\u003e\n\u003cp\u003e주파수를 식별함으로써, 분석가들은 역사적인 패턴을 기반으로 미래 가격 변동이나 트렌드에 대한 예측을 할 수 있습니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e기계 학습을 위한 기능 추출\u003c/h2\u003e\n\u003cp\u003eFourier 변환에서 얻은 주파수 구성 요소는 머신 러닝 모델에서 특징으로 사용되어 예측의 정확도를 향상시킬 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e코드 및 단계별 분석\u003c/h1\u003e\n\u003ch2\u003e노트북 설정 및 주식 데이터 수집\u003c/h2\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e필요한 기본 주식 데이터 수집 및 데이터 프레임 조작을 위한 라이브러리 가져오기가 첫 번째 단계입니다.\u003c/p\u003e\n\u003cp\u003e또한, 분석 기간을 1년으로 설정하고 분석할 주식은 Tata Consultancy Services (TCS)입니다. 필요한 주식의 OLHCAV 데이터는 'df'라는 데이터 프레임에 저장되어 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e#라이브러리 가져오기\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pandas_datareader \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e data \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pdr\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e numpy \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e np\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e math\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e scipy.\u003cspan class=\"hljs-property\"\u003estats\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e stats\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e matplotlib.\u003cspan class=\"hljs-property\"\u003epyplot\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e plt\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e yfinance \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e yfin\nyfin.\u003cspan class=\"hljs-title function_\"\u003epdr_override\u003c/span\u003e()\n\n# 분석 기간 설정\nend_date = datetime.\u003cspan class=\"hljs-property\"\u003edatetime\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003enow\u003c/span\u003e()\nstart_date = end_date - datetime.\u003cspan class=\"hljs-title function_\"\u003etimedelta\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e)\nticker = \u003cspan class=\"hljs-string\"\u003e'TCS'\u003c/span\u003e\n\ndf = pdr.\u003cspan class=\"hljs-title function_\"\u003eget_data_yahoo\u003c/span\u003e(ticker + \u003cspan class=\"hljs-string\"\u003e'.NS'\u003c/span\u003e, start = start_date, end = end_date)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eFFT의 적용\u003c/h2\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003enp.fft.fft()을 사용하여 푸리에 변환을 수행할 것이며, np.fft.fftfreq()를 사용하여 주파수를 얻을 것입니다. 가장 중요한 주파수가 나타나는 때를 나타내기 위해 진폭 대 주기를 그래프로 그려볼 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efft_result = np.\u003cspan class=\"hljs-property\"\u003efft\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efft\u003c/span\u003e(df[\u003cspan class=\"hljs-string\"\u003e'Close'\u003c/span\u003e])\nfrequencies = np.\u003cspan class=\"hljs-property\"\u003efft\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efftfreq\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(fft_result), d=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)  # assuming daily data, d=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nmagnitude = np.\u003cspan class=\"hljs-title function_\"\u003eabs\u003c/span\u003e(fft_result)\nperiods = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e / frequencies\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e가격 및 주파수 영역 표현 시각화\u003c/h2\u003e\n\u003cp\u003e아래의 주파수 플롯은 시계열 내에서 우세한 주파수를 강조합니다. 이러한 주파수는 역 FFT를 수행하거나 원래 시계열을 다시 만들거나 잡음을 줄인 버전을 생성하는 데 사용될 수 있습니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 가격의 간단한 시각화\nplt.\u003cspan class=\"hljs-title function_\"\u003efigure\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e))\nplt.\u003cspan class=\"hljs-title function_\"\u003esubplot\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e, df[\u003cspan class=\"hljs-string\"\u003e'Close'\u003c/span\u003e])\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'TCS 시계열'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'날짜'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'가격'\u003c/span\u003e)\n\n# 주파수 도메인 표현\nplt.\u003cspan class=\"hljs-title function_\"\u003esubplot\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(periods, magnitude)\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'TCS의 FFT'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'기간 (일)'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'크기'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003exlim\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e(periods[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:]))  # 중요한 주기를 보기 위한 x-축 제한 (큰 주기 무시)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylim\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e(magnitude[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:]) * \u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e)  # 제로 주파수 구성요소 무시\n\nplt.\u003cspan class=\"hljs-title function_\"\u003etight_layout\u003c/span\u003e()\nplt.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_0.png\"\u003e\n\u003cp\u003e하지만, 이러한 우세 주파수의 중요성은 단순히 시계열을 재구성하는 데서 그치지 않습니다. 이들은 시계열 구조에 영향을 미치는 주요 경제 보고서나 거시경제 사건과 관련될 수 있습니다.\u003c/p\u003e\n\u003ch2\u003e원래 주식 시장 데이터 복구하기\u003c/h2\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003enp.fft.ifft() 함수를 사용하여 원래의 시계열을 복원할 수 있습니다. 이 함수는 fft_results를 역변환합니다. 아래 그래프에서 볼 수 있듯이 완벽하게 재구성되었습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003erecovered = np.\u003cspan class=\"hljs-property\"\u003efft\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eifft\u003c/span\u003e(fft_result);\nplt.\u003cspan class=\"hljs-title function_\"\u003efigure\u003c/span\u003e((figsize = (\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)));\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e, df[\u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e], (label = \u003cspan class=\"hljs-string\"\u003e\"Original\"\u003c/span\u003e));\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e, recovered, (label = \u003cspan class=\"hljs-string\"\u003e\"Recovered\"\u003c/span\u003e));\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"TCS 시계열: FFT 역변환\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"날짜\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"가격\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003elegend\u003c/span\u003e();\nplt.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_1.png\"\u003e\n\u003ch2\u003e주요 주파수를 갖는 파형의 재구성\u003c/h2\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이것은 상위 25개 FFT 주파수만 사용하여 재구성된 신호를 생성합니다. 이것은 데이터의 노이즈 제거를 의미합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edominant_periods = pd.\u003cspan class=\"hljs-title class_\"\u003eSeries\u003c/span\u003e(periods, (index = magnitude)).\u003cspan class=\"hljs-title function_\"\u003enlargest\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e);\ndominant_periods.\u003cspan class=\"hljs-title function_\"\u003eto_frame\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"주기 (일)\"\u003c/span\u003e);\ntop_periods = dominant_periods.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e;\ntop_fft_result = fft_result.\u003cspan class=\"hljs-title function_\"\u003ecopy\u003c/span\u003e();\ntop_fft_result[np.\u003cspan class=\"hljs-title function_\"\u003eabs\u003c/span\u003e(frequencies) \u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e / top_periods.\u003cspan class=\"hljs-title function_\"\u003emin\u003c/span\u003e()] = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\ntop_recovered = np.\u003cspan class=\"hljs-property\"\u003efft\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eifft\u003c/span\u003e(top_fft_result);\n\nplt.\u003cspan class=\"hljs-title function_\"\u003efigure\u003c/span\u003e((figsize = (\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)));\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e, df[\u003cspan class=\"hljs-string\"\u003e\"Close\"\u003c/span\u003e], (label = \u003cspan class=\"hljs-string\"\u003e\"원본\"\u003c/span\u003e));\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(df.\u003cspan class=\"hljs-property\"\u003eindex\u003c/span\u003e, top_recovered, (label = \u003cspan class=\"hljs-string\"\u003e\"복원된\"\u003c/span\u003e));\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"TCS 시계열: FFT 역변환\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"날짜\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"가격\"\u003c/span\u003e);\nplt.\u003cspan class=\"hljs-title function_\"\u003elegend\u003c/span\u003e();\nplt.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/TIL/assets/img/2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform_2.png\"\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 문서에서 설명한 알고리즘은 산업 전문가들이 사용하는 분석을 지나치게 단순화한 것입니다. 성능을 개선하기 위해 일반적으로 매일 모델을 조정합니다.\u003c/p\u003e\n\u003cp\u003e도움이 되었기를 바라며, 여기에 GitHub 파일을 찾을 수 있습니다: \u003ca href=\"https://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/karantha-kur/Signal-Analysis-Using-FFT/tree/main\u003c/a\u003e\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-07-09-StockMarketSignalAnalysisUsingFastFourierTransform"},"buildId":"olPs1cVezSGTqD7OaewDI","assetPrefix":"/TIL","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>