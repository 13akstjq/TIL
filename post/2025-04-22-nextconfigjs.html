<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>Next.js 15 next.config.js 기본 설정 방법 | TIL</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://13akstjq.github.io/TIL//post/2025-04-22-nextconfigjs" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="Next.js 15 next.config.js 기본 설정 방법 | TIL" data-gatsby-head="true"/><meta property="og:title" content="Next.js 15 next.config.js 기본 설정 방법 | TIL" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/TIL/assets/img/nextjs.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://TIL.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://13akstjq.github.io/TIL//post/2025-04-22-nextconfigjs" data-gatsby-head="true"/><meta name="twitter:title" content="Next.js 15 next.config.js 기본 설정 방법 | TIL" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/TIL/assets/img/nextjs.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | TIL" data-gatsby-head="true"/><meta name="article:published_time" content="2025-04-22 12:59" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/TIL/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/TIL/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/TIL/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/TIL/favicons/favicon-96x96.png"/><link rel="icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/TIL/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/TIL/favicons/browserconfig.xml"/><link rel="preload" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/TIL/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/TIL/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/TIL/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/TIL/_next/static/chunks/webpack-21ffe88bdca56cba.js" defer=""></script><script src="/TIL/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/TIL/_next/static/chunks/main-a5eeabb286676ce6.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/TIL/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/TIL/_next/static/chunks/348-02483b66b493dd81.js" defer=""></script><script src="/TIL/_next/static/chunks/pages/post/%5Bslug%5D-8ded8b979ba73586.js" defer=""></script><script src="/TIL/_next/static/X4OrKfmLtU3-3BijwfHe6/_buildManifest.js" defer=""></script><script src="/TIL/_next/static/X4OrKfmLtU3-3BijwfHe6/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/TIL">TIL</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/TIL/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">Next.js 15 next.config.js 기본 설정 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="Next.js 15 next.config.js 기본 설정 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/TIL/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">TIL</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Apr 22, 2025</span><span class="posts_reading_time__f7YPP">10<!-- --> min read</span></span></div></div></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h1>next.config.js 설정하기</h1>
<p>Next.js는 프로젝트 최상단(예: package.json이 위치한 같은 폴더)에 <code>next.config.js</code> 파일을 만들어 다양한 설정을 할 수 있어요. 이 파일은 기본적으로 <code>module.exports</code>로 구성한 객체를 내보내는 형태입니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// @ts-check</span>
 
<span class="hljs-comment">/** <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>} */</span>
<span class="hljs-keyword">const</span> nextConfig = {
  <span class="hljs-comment">/* 여기에 설정 옵션들을 적어주세요 */</span>
}
 
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = nextConfig
</code></pre>
<p>이렇게 하면 Next.js가 프로젝트를 빌드하거나 실행할 때 이 설정을 참조하게 되죠.</p>
<hr>
<h2>ECMAScript 모듈 방식으로 작성하기</h2>
<p>최근에는 Node.js가 ECMAScript Modules(ESM)을 더 잘 지원하면서, <code>next.config.js</code> 파일을 <code>ESM</code> 방식으로 작성하고 싶을 때도 있어요. 예를 들어 <code>export default</code>를 사용하는 식이죠.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">/** <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>} */</span>
<span class="hljs-keyword">const</span> nextConfig = {
  <span class="hljs-comment">/* 설정 작성 */</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig
</code></pre>
<p>단, 이렇게 하려면 <code>package.json</code>에 <code>"type": "module"</code>을 명시하거나, <code>next.config.mjs</code>와 같이 <code>.mjs</code> 확장자를 사용해야 해요. 그렇지 않으면 여전히 CommonJS 형식(<code>module.exports</code>)을 사용해야 합니다.</p>
<h3>참고로!</h3>
<ul>
<li>기본적으로 Next.js는 CommonJS 방식을 선호하고, 대부분 예제도 이 방식을 따라요.</li>
<li>만약 ESM 방식으로 작성했다면, Node.js 버전 호환과 프로젝트 설정을 꼼꼼히 확인하는 게 좋아요.</li>
<li>또, 환경 변수 설정이나 커스텀 웹팩 등 고급 설정을 할 때 이 차이가 영향을 줄 수 있으니 주의하세요!</li>
</ul>
<hr>
<p><code>next.config.js</code>는 Next.js 프로젝트를 내 입맛에 맞게 조정하는 아주 중요한 파일이에요. 설정 가능한 옵션들은 <a href="https://nextjs.org/docs/api-reference/next.config.js/introduction" rel="nofollow" target="_blank">공식 문서</a>를 참고하면 더 다양한 기능을 활용할 수 있어요!</p>
<p>필요한 설정을 넣고 내 프로젝트를 더 똑똑하게 만들어봅시다! 🚀</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>next.config.js는 일반적인 Node.js 모듈이지 JSON 파일이 아니에요. 이 파일은 Next.js 서버와 빌드 단계에서 사용되고, 브라우저 빌드에는 포함되지 않아요.</p>
<p>만약 ECMAScript 모듈 방식을 사용하고 싶다면, next.config.mjs 파일을 쓸 수 있는데요, 이렇게 작성하면 됩니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// @ts-check</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>}
 */</span>
<span class="hljs-keyword">const</span> nextConfig = {
  <span class="hljs-comment">/* 여기에 설정 옵션을 넣으면 돼요 */</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig
</code></pre>
<blockquote>
<p>참고로 좋은 정보! 현재 next.config 파일은 .cjs, .cts, .mts 확장자는 지원하지 않으니 꼭 .js 나 .mjs 확장자를 사용해야 해요.</p>
</blockquote>
<p>추가로, next.config.js는 서버 사이드에서만 동작하기 때문에 브라우저에 환경 설정이 노출되지 않는다는 점이 큰 장점이에요. 그래서 보안에 민감한 설정이나 API 키 같은 걸 넣어도 안전하게 사용할 수 있답니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>함수 형태로 설정하기</h2>
<p>Next.js 설정을 할 때, 단순히 객체를 내보내는 것 말고도 함수를 사용해서 설정할 수 있어요. 이렇게 하면 환경에 따라 동적으로 설정값을 다르게 줄 수 있어서 유용하답니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// @ts-check</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> (phase, { defaultConfig }) => {
  <span class="hljs-comment">/**
   * <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>}
   */</span>
  <span class="hljs-keyword">const</span> nextConfig = {
    <span class="hljs-comment">/* 여기에 설정 옵션 작성 */</span>
  }
  <span class="hljs-keyword">return</span> nextConfig
}
</code></pre>
<p>예를 들어, 빌드 시점(phase)에 따라 다른 옵션을 주거나, 기본 설정(defaultConfig)을 참고할 수도 있어요.</p>
<h3>비동기 설정도 가능해요!</h3>
<p>여기까지 보면 그냥 동기 함수 같지만, async 함수로 만들 수도 있어요. 예를 들어 외부 API에서 설정 정보를 받아 와야 한다면, async/await를 이용해서 처리할 수 있답니다.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> (phase, { defaultConfig }) => {
  <span class="hljs-comment">// 예: 외부 API에서 설정 가져오기</span>
  <span class="hljs-keyword">const</span> externalSettings = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchSomeSettings</span>()

  <span class="hljs-keyword">return</span> {
    ...defaultConfig,
    ...externalSettings,
  }
}
</code></pre>
<p>이렇게 하면 설정 값도 API 호출 결과에 따라 유연하게 바꿀 수 있으니, 복잡한 환경에서도 활용하기 딱 좋겠죠?</p>
<hr>
<p>다만, async 설정을 쓸 때는 빌드 시간에 네트워크 요청이 포함되니까 빌드 속도가 느려질 수 있어요. 꼭 필요한 경우에만 사용하는 게 좋아요!</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>Next.js 12.1.0 버전부터는 async 함수를 사용해서 설정 파일을 작성할 수 있어요. 예를 들어:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// @ts-check</span>

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">async</span> (phase, { defaultConfig }) => {
  <span class="hljs-comment">/**
   * <span class="hljs-doctag">@type</span> {<span class="hljs-type">import('next').NextConfig</span>}
   */</span>
  <span class="hljs-keyword">const</span> nextConfig = {
    <span class="hljs-comment">/* 여기에 설정 옵션을 작성하세요 */</span>
  }
  <span class="hljs-keyword">return</span> nextConfig
}
</code></pre>
<p>여기서 <code>phase</code>는 현재 설정이 로드되는 상황(컨텍스트)을 의미해요. 어떤 상황에서 설정이 호출되는지 구분해서 설정을 다르게 할 수 있죠. Next.js에서는 여러 가지 phase를 제공합니다.</p>
<p>그리고 이런 phase 값들은 <code>next/constants</code> 모듈에서 가져올 수 있어요. 예를 들어 이렇게요:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { <span class="hljs-variable constant_">PHASE_DEVELOPMENT_SERVER</span>, <span class="hljs-variable constant_">PHASE_PRODUCTION_BUILD</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'next/constants'</span>)
</code></pre>
<p>이걸 활용하면 특정 상황에서만 설정을 다르게 하거나, 개발 모드와 프로덕션 모드에 맞는 설정을 분리할 수 있답니다.</p>
<h3>Phase 종류 예시</h3>

























<table><thead><tr><th>상수</th><th>의미</th></tr></thead><tbody><tr><td><code>PHASE_DEVELOPMENT_SERVER</code></td><td>개발 서버 실행 시</td></tr><tr><td><code>PHASE_PRODUCTION_BUILD</code></td><td>프로덕션 빌드 시</td></tr><tr><td><code>PHASE_PRODUCTION_SERVER</code></td><td>프로덕션 서버 실행 시</td></tr><tr><td><code>PHASE_EXPORT</code></td><td>정적 HTML Export 수행 시</td></tr></tbody></table>
<p>이렇게 상황에 따라 설정을 구분해놓으면 훨씬 유연하고 관리하기 쉬워져요. 예를들어 개발환경에선 디버깅 옵션을 켜고, 프로덕션에선 최적화 옵션을 켜는 식으로 말이죠.</p>
<p>만약 더 복잡한 설정을 원한다면, async 함수 내에서 API 호출이나 파일 읽기 같은 비동기 작업도 할 수 있어서 설정을 더 동적으로 만들어 줄 수 있어요. Next.js 12.1.0부터 이 기능 덕분에 한층 더 풍부한 설정 구성이 가능해졌답니다!</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>자, 오늘은 Next.js 설정 파일을 다루는 방법에 대해서 이야기해볼게요. Next.js를 사용하다 보면 각 환경(development, production 등)에 따라 다르게 설정하고 싶을 때가 있잖아요? 이럴 때 유용한 예제를 하나 가지고 왔어요.</p>
<h3>Next.js 설정 파일 예제 (JavaScript)</h3>
<pre><code class="hljs language-js"><span class="hljs-comment">// @ts-check</span>

<span class="hljs-keyword">const</span> { <span class="hljs-variable constant_">PHASE_DEVELOPMENT_SERVER</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'next/constants'</span>)

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">phase, { defaultConfig }</span>) =></span> {
  <span class="hljs-keyword">if</span> (phase === <span class="hljs-variable constant_">PHASE_DEVELOPMENT_SERVER</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">/* 개발 서버 환경일 때만 적용할 설정을 여기에 작성하세요 */</span>
    }
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">/* 개발 서버가 아닌 모든 환경에서 공통적으로 적용할 설정을 여기에 작성하세요 */</span>
  }
}
</code></pre>
<p>자, 이 코드는 Next.js의 설정 파일인 <code>next.config.js</code>에서 주로 사용됩니다. <code>phase</code>라는 매개변수를 받아서 현재 실행 중인 환경을 판단할 수 있어요. 예를 들면, <code>PHASE_DEVELOPMENT_SERVER</code>는 로컬 개발 서버를 의미하니까 개발용 설정을 넣고, 그렇지 않은 경우엔 production 등 다른 환경 설정을 넣으면 된답니다.</p>
<blockquote>
<p>참고로, <code>defaultConfig</code> 매개변수에는 Next.js가 기본으로 제공하는 설정 값들이 포함돼 있어 필요할 때 활용할 수 있어요.</p>
</blockquote>
<hr>
<p>그리고 요즘은 TypeScript를 많이 쓰니 Next.js 설정에도 TypeScript를 적용할 수 있어요. 그래서 <code>next.config.ts</code> 라는 파일을 사용하면 훨씬 더 타입 안정성을 갖추면서 편하게 작업할 수 있죠.</p>
<h3>Next.js 설정 파일 예제 (TypeScript)</h3>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'next'</span>

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* 원하는 설정 옵션을 작성하세요 */</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig
</code></pre>
<p>여기서 중요한 점은 <code>NextConfig</code> 타입을 임포트해서 사용하면, 지원하는 설정 옵션들을 타입으로 미리 확인하고 잘못된 설정을 방지할 수 있다는 점이에요.</p>
<hr>
<h3>추가 팁!</h3>
<ul>
<li><code>phase</code>가 다양한 값이 있으니 필요하면 <code>next/constants</code>에서 다른 상수들도 확인해보세요. (예: <code>PHASE_PRODUCTION_BUILD</code>, <code>PHASE_EXPORT</code>)</li>
<li>설정이 많아지면 환경 변수도 함께 관리하는 게 좋아요. <code>.env.local</code>, <code>.env.production</code> 같은 파일을 Next.js가 자동으로 읽어줍니다.</li>
<li>Next.js 공식 문서에서는 환경에 따라 설정 분리하기 좋은 패턴이 많으니 한번 살펴보시면 좋아요.</li>
</ul>
<p>혹시 더 궁금한 점 있으면 언제든지 물어봐 주세요! 개발하면서 이런 설정들은 꼭 익혀두면 나중에 디버깅도 수월해지고 프로젝트 관리도 편하답니다.</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>여기 주석 처리된 줄들은 next.config.js에서 허용하는 설정들을 넣을 수 있는 자리예요. 이 설정들은 이 파일에 정의되어 있죠.</p>
<p>하지만, 꼭 모든 설정을 알아야 하는 건 아니에요! 각 설정이 무슨 역할을 하는지를 다 이해할 필요 없이, 필요에 따라 원하는 기능을 이 부분에서 찾아보고 어떻게 하면 되는지 참고하면 돼요.</p>
<blockquote>
<p>참고로, target Node.js 버전에 지원되지 않는 최신 JavaScript 기능은 사용하지 않는 게 좋아요. next.config.js 파일은 Webpack이나 Babel로 변환되지 않으니까요.</p>
</blockquote>
<p>아래 페이지에서 next.config.js로 설정할 수 있는 모든 옵션들을 자세히 확인할 수 있어요:</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>단위 테스트 (실험적 기능)</h2>
<p>Next.js 15.1부터는 <code>next/experimental/testing/server</code> 패키지에 next.config.js 파일을 단위 테스트할 수 있는 유틸리티가 포함되어 있어요.</p>
<p>여기서 <code>unstable_getResponseFromNextConfig</code> 함수는 next.config.js에 정의된 headers, redirects, rewrites 함수들을 실제 요청 정보와 함께 실행하고, 라우팅 결과를 담은 <code>NextResponse</code> 객체를 돌려줍니다.</p>
<blockquote>
<p>다만, <code>unstable_getResponseFromNextConfig</code> 함수는 next.config.js에 정의된 필드만 고려해서 결과를 반환하기 때문에, 미들웨어(middleware)나 파일 시스템 라우트(filesystem routes)는 반영되지 않아요. 그래서 실제 프로덕션 환경에서의 동작과 테스트 결과가 약간 다를 수 있다는 점 기억하세요.</p>
</blockquote>
<hr>
<p>제가 좀 더 덧붙이자면, 앞으로 이런 실험적 기능들이 안정화되면, 별도의 E2E(End-to-End) 테스트 없이도 설정 파일을 좀 더 쉽고 빠르게 검증할 수 있을 것 같아요. 현재는 아직 불안정하니, 중요한 부분은 반드시 프로덕션 환경에서 추가 테스트를 하는 것을 추천합니다!</p>
<!-- TIL 수평 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="1549334788" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이번에 소개할 코드는 Next.js의 실험적 API를 활용해서 리다이렉트 설정을 테스트하는 방법에 관한 예제예요. Next.js 개발할 때 리다이렉트(redirects) 설정 잘 되어 있는지 테스트하고 싶다면 꽤 유용하게 쓸 수 있죠.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> {
  getRedirectUrl,
  unstable_getResponseFromNextConfig,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'next/experimental/testing/server'</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">unstable_getResponseFromNextConfig</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">'https://nextjs.org/test'</span>,  <span class="hljs-comment">// 테스트할 URL</span>
  <span class="hljs-attr">nextConfig</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">redirects</span>(<span class="hljs-params"></span>) {
      <span class="hljs-keyword">return</span> [{ <span class="hljs-attr">source</span>: <span class="hljs-string">'/test'</span>, <span class="hljs-attr">destination</span>: <span class="hljs-string">'/test2'</span>, <span class="hljs-attr">permanent</span>: <span class="hljs-literal">false</span> }]
    },
  },
})

<span class="hljs-title function_">expect</span>(response.<span class="hljs-property">status</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">307</span>)  <span class="hljs-comment">// 임시 리다이렉트인지 확인</span>
<span class="hljs-title function_">expect</span>(<span class="hljs-title function_">getRedirectUrl</span>(response)).<span class="hljs-title function_">toEqual</span>(<span class="hljs-string">'https://nextjs.org/test2'</span>)  <span class="hljs-comment">// 리다이렉트 목적지 확인</span>
</code></pre>
<h3>핵심 포인트</h3>
<ul>
<li><code>unstable_getResponseFromNextConfig</code>는 Next.js 설정(여기서는 <code>redirects</code>)에 따라 주어진 URL에 대한 응답 객체를 생성해줘요.</li>
<li><code>getRedirectUrl</code>은 응답 헤더 중 리다이렉트 위치(URL)를 쉽게 추출할 수 있게 도와줍니다.</li>
<li>여기서는 '/test'가 '/test2'로 임시 리다이렉트(307) 되는지 검사중이에요.</li>
</ul>
<h3>참고할 점</h3>
<ul>
<li>아직 <code>unstable_</code> 접두어가 붙어있으니 API가 안정화되지 않았고, 향후 바뀔 수도 있어요.</li>
<li>실제 프로젝트에서는 이런 테스트를 CI 파이프라인에 넣어두면 배포 전에 리다이렉트 설정 및 동작을 자동으로 검증할 수 있어 매우 편리하답니다.</li>
</ul>
<h3>마무리</h3>
<p>이렇게 Next.js의 내부 설정을 직접 불러와서 테스트할 수 있는 방법이 있어서, 리다이렉트뿐 아니라 다른 설정도 비슷하게 점검할 수 있어요. 실험적인 API지만 앞으로 점점 정식화될 가능성이 크니 주목해 보세요!</p>
<p>필요하면 <code>next.config.js</code> 내 redirects 설정 외에 rewrites, headers 등도 유사하게 검증할 수 있다는 점도 덧붙여 드립니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Next.js 15 next.config.js 기본 설정 방법","description":"","date":"2025-04-22 12:59","slug":"2025-04-22-nextconfigjs","content":"\n\n# next.config.js 설정하기\n\nNext.js는 프로젝트 최상단(예: package.json이 위치한 같은 폴더)에 `next.config.js` 파일을 만들어 다양한 설정을 할 수 있어요. 이 파일은 기본적으로 `module.exports`로 구성한 객체를 내보내는 형태입니다.\n\n```js\n// @ts-check\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* 여기에 설정 옵션들을 적어주세요 */\n}\n \nmodule.exports = nextConfig\n```\n\n이렇게 하면 Next.js가 프로젝트를 빌드하거나 실행할 때 이 설정을 참조하게 되죠.\n\n---\n\n## ECMAScript 모듈 방식으로 작성하기\n\n최근에는 Node.js가 ECMAScript Modules(ESM)을 더 잘 지원하면서, `next.config.js` 파일을 `ESM` 방식으로 작성하고 싶을 때도 있어요. 예를 들어 `export default`를 사용하는 식이죠.\n\n```js\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* 설정 작성 */\n}\n\nexport default nextConfig\n```\n\n단, 이렇게 하려면 `package.json`에 `\"type\": \"module\"`을 명시하거나, `next.config.mjs`와 같이 `.mjs` 확장자를 사용해야 해요. 그렇지 않으면 여전히 CommonJS 형식(`module.exports`)을 사용해야 합니다.\n\n### 참고로!  \n- 기본적으로 Next.js는 CommonJS 방식을 선호하고, 대부분 예제도 이 방식을 따라요.  \n- 만약 ESM 방식으로 작성했다면, Node.js 버전 호환과 프로젝트 설정을 꼼꼼히 확인하는 게 좋아요.  \n- 또, 환경 변수 설정이나 커스텀 웹팩 등 고급 설정을 할 때 이 차이가 영향을 줄 수 있으니 주의하세요!\n\n---\n\n`next.config.js`는 Next.js 프로젝트를 내 입맛에 맞게 조정하는 아주 중요한 파일이에요. 설정 가능한 옵션들은 [공식 문서](https://nextjs.org/docs/api-reference/next.config.js/introduction)를 참고하면 더 다양한 기능을 활용할 수 있어요!\n\n필요한 설정을 넣고 내 프로젝트를 더 똑똑하게 만들어봅시다! 🚀\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nnext.config.js는 일반적인 Node.js 모듈이지 JSON 파일이 아니에요. 이 파일은 Next.js 서버와 빌드 단계에서 사용되고, 브라우저 빌드에는 포함되지 않아요.\n\n만약 ECMAScript 모듈 방식을 사용하고 싶다면, next.config.mjs 파일을 쓸 수 있는데요, 이렇게 작성하면 됩니다:\n\n```js\n// @ts-check\n\n/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  /* 여기에 설정 옵션을 넣으면 돼요 */\n}\n\nexport default nextConfig\n```\n\n\u003e 참고로 좋은 정보! 현재 next.config 파일은 .cjs, .cts, .mts 확장자는 지원하지 않으니 꼭 .js 나 .mjs 확장자를 사용해야 해요.\n\n추가로, next.config.js는 서버 사이드에서만 동작하기 때문에 브라우저에 환경 설정이 노출되지 않는다는 점이 큰 장점이에요. 그래서 보안에 민감한 설정이나 API 키 같은 걸 넣어도 안전하게 사용할 수 있답니다.\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 함수 형태로 설정하기\n\nNext.js 설정을 할 때, 단순히 객체를 내보내는 것 말고도 함수를 사용해서 설정할 수 있어요. 이렇게 하면 환경에 따라 동적으로 설정값을 다르게 줄 수 있어서 유용하답니다.\n\n```js\n// @ts-check\n\nexport default (phase, { defaultConfig }) =\u003e {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* 여기에 설정 옵션 작성 */\n  }\n  return nextConfig\n}\n```\n\n예를 들어, 빌드 시점(phase)에 따라 다른 옵션을 주거나, 기본 설정(defaultConfig)을 참고할 수도 있어요.\n\n### 비동기 설정도 가능해요!\n\n여기까지 보면 그냥 동기 함수 같지만, async 함수로 만들 수도 있어요. 예를 들어 외부 API에서 설정 정보를 받아 와야 한다면, async/await를 이용해서 처리할 수 있답니다.\n\n```js\nexport default async (phase, { defaultConfig }) =\u003e {\n  // 예: 외부 API에서 설정 가져오기\n  const externalSettings = await fetchSomeSettings()\n\n  return {\n    ...defaultConfig,\n    ...externalSettings,\n  }\n}\n```\n\n이렇게 하면 설정 값도 API 호출 결과에 따라 유연하게 바꿀 수 있으니, 복잡한 환경에서도 활용하기 딱 좋겠죠?\n\n---\n\n다만, async 설정을 쓸 때는 빌드 시간에 네트워크 요청이 포함되니까 빌드 속도가 느려질 수 있어요. 꼭 필요한 경우에만 사용하는 게 좋아요!\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nNext.js 12.1.0 버전부터는 async 함수를 사용해서 설정 파일을 작성할 수 있어요. 예를 들어:\n\n```js\n// @ts-check\n\nmodule.exports = async (phase, { defaultConfig }) =\u003e {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* 여기에 설정 옵션을 작성하세요 */\n  }\n  return nextConfig\n}\n```\n\n여기서 `phase`는 현재 설정이 로드되는 상황(컨텍스트)을 의미해요. 어떤 상황에서 설정이 호출되는지 구분해서 설정을 다르게 할 수 있죠. Next.js에서는 여러 가지 phase를 제공합니다.\n\n그리고 이런 phase 값들은 `next/constants` 모듈에서 가져올 수 있어요. 예를 들어 이렇게요:\n\n```js\nconst { PHASE_DEVELOPMENT_SERVER, PHASE_PRODUCTION_BUILD } = require('next/constants')\n```\n\n이걸 활용하면 특정 상황에서만 설정을 다르게 하거나, 개발 모드와 프로덕션 모드에 맞는 설정을 분리할 수 있답니다.\n\n### Phase 종류 예시\n\n| 상수                          | 의미                                   |\n|----------------------------|--------------------------------------|\n| `PHASE_DEVELOPMENT_SERVER` | 개발 서버 실행 시                       |\n| `PHASE_PRODUCTION_BUILD`    | 프로덕션 빌드 시                      |\n| `PHASE_PRODUCTION_SERVER`   | 프로덕션 서버 실행 시                 |\n| `PHASE_EXPORT`              | 정적 HTML Export 수행 시               |\n\n이렇게 상황에 따라 설정을 구분해놓으면 훨씬 유연하고 관리하기 쉬워져요. 예를들어 개발환경에선 디버깅 옵션을 켜고, 프로덕션에선 최적화 옵션을 켜는 식으로 말이죠.\n\n만약 더 복잡한 설정을 원한다면, async 함수 내에서 API 호출이나 파일 읽기 같은 비동기 작업도 할 수 있어서 설정을 더 동적으로 만들어 줄 수 있어요. Next.js 12.1.0부터 이 기능 덕분에 한층 더 풍부한 설정 구성이 가능해졌답니다!\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n자, 오늘은 Next.js 설정 파일을 다루는 방법에 대해서 이야기해볼게요. Next.js를 사용하다 보면 각 환경(development, production 등)에 따라 다르게 설정하고 싶을 때가 있잖아요? 이럴 때 유용한 예제를 하나 가지고 왔어요.\n\n### Next.js 설정 파일 예제 (JavaScript)\n\n```js\n// @ts-check\n\nconst { PHASE_DEVELOPMENT_SERVER } = require('next/constants')\n\nmodule.exports = (phase, { defaultConfig }) =\u003e {\n  if (phase === PHASE_DEVELOPMENT_SERVER) {\n    return {\n      /* 개발 서버 환경일 때만 적용할 설정을 여기에 작성하세요 */\n    }\n  }\n\n  return {\n    /* 개발 서버가 아닌 모든 환경에서 공통적으로 적용할 설정을 여기에 작성하세요 */\n  }\n}\n```\n\n자, 이 코드는 Next.js의 설정 파일인 `next.config.js`에서 주로 사용됩니다. `phase`라는 매개변수를 받아서 현재 실행 중인 환경을 판단할 수 있어요. 예를 들면, `PHASE_DEVELOPMENT_SERVER`는 로컬 개발 서버를 의미하니까 개발용 설정을 넣고, 그렇지 않은 경우엔 production 등 다른 환경 설정을 넣으면 된답니다.\n\n\u003e 참고로, `defaultConfig` 매개변수에는 Next.js가 기본으로 제공하는 설정 값들이 포함돼 있어 필요할 때 활용할 수 있어요.\n\n---\n\n그리고 요즘은 TypeScript를 많이 쓰니 Next.js 설정에도 TypeScript를 적용할 수 있어요. 그래서 `next.config.ts` 라는 파일을 사용하면 훨씬 더 타입 안정성을 갖추면서 편하게 작업할 수 있죠.\n\n### Next.js 설정 파일 예제 (TypeScript)\n\n```ts\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  /* 원하는 설정 옵션을 작성하세요 */\n}\n\nexport default nextConfig\n```\n\n여기서 중요한 점은 `NextConfig` 타입을 임포트해서 사용하면, 지원하는 설정 옵션들을 타입으로 미리 확인하고 잘못된 설정을 방지할 수 있다는 점이에요.\n\n---\n\n### 추가 팁!\n\n- `phase`가 다양한 값이 있으니 필요하면 `next/constants`에서 다른 상수들도 확인해보세요. (예: `PHASE_PRODUCTION_BUILD`, `PHASE_EXPORT`)\n- 설정이 많아지면 환경 변수도 함께 관리하는 게 좋아요. `.env.local`, `.env.production` 같은 파일을 Next.js가 자동으로 읽어줍니다.\n- Next.js 공식 문서에서는 환경에 따라 설정 분리하기 좋은 패턴이 많으니 한번 살펴보시면 좋아요.\n\n혹시 더 궁금한 점 있으면 언제든지 물어봐 주세요! 개발하면서 이런 설정들은 꼭 익혀두면 나중에 디버깅도 수월해지고 프로젝트 관리도 편하답니다.\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n여기 주석 처리된 줄들은 next.config.js에서 허용하는 설정들을 넣을 수 있는 자리예요. 이 설정들은 이 파일에 정의되어 있죠.\n\n하지만, 꼭 모든 설정을 알아야 하는 건 아니에요! 각 설정이 무슨 역할을 하는지를 다 이해할 필요 없이, 필요에 따라 원하는 기능을 이 부분에서 찾아보고 어떻게 하면 되는지 참고하면 돼요.\n\n\u003e 참고로, target Node.js 버전에 지원되지 않는 최신 JavaScript 기능은 사용하지 않는 게 좋아요. next.config.js 파일은 Webpack이나 Babel로 변환되지 않으니까요.\n\n아래 페이지에서 next.config.js로 설정할 수 있는 모든 옵션들을 자세히 확인할 수 있어요:\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 단위 테스트 (실험적 기능)\n\nNext.js 15.1부터는 `next/experimental/testing/server` 패키지에 next.config.js 파일을 단위 테스트할 수 있는 유틸리티가 포함되어 있어요.\n\n여기서 `unstable_getResponseFromNextConfig` 함수는 next.config.js에 정의된 headers, redirects, rewrites 함수들을 실제 요청 정보와 함께 실행하고, 라우팅 결과를 담은 `NextResponse` 객체를 돌려줍니다.\n\n\u003e 다만, `unstable_getResponseFromNextConfig` 함수는 next.config.js에 정의된 필드만 고려해서 결과를 반환하기 때문에, 미들웨어(middleware)나 파일 시스템 라우트(filesystem routes)는 반영되지 않아요. 그래서 실제 프로덕션 환경에서의 동작과 테스트 결과가 약간 다를 수 있다는 점 기억하세요.\n\n---\n\n제가 좀 더 덧붙이자면, 앞으로 이런 실험적 기능들이 안정화되면, 별도의 E2E(End-to-End) 테스트 없이도 설정 파일을 좀 더 쉽고 빠르게 검증할 수 있을 것 같아요. 현재는 아직 불안정하니, 중요한 부분은 반드시 프로덕션 환경에서 추가 테스트를 하는 것을 추천합니다!\n\n\u003c!-- TIL 수평 --\u003e\n\u003cins class=\"adsbygoogle\"\n     style=\"display:block\"\n     data-ad-client=\"ca-pub-4877378276818686\"\n     data-ad-slot=\"1549334788\"\n     data-ad-format=\"auto\"\n     data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이번에 소개할 코드는 Next.js의 실험적 API를 활용해서 리다이렉트 설정을 테스트하는 방법에 관한 예제예요. Next.js 개발할 때 리다이렉트(redirects) 설정 잘 되어 있는지 테스트하고 싶다면 꽤 유용하게 쓸 수 있죠.\n\n```js\nimport {\n  getRedirectUrl,\n  unstable_getResponseFromNextConfig,\n} from 'next/experimental/testing/server'\n\nconst response = await unstable_getResponseFromNextConfig({\n  url: 'https://nextjs.org/test',  // 테스트할 URL\n  nextConfig: {\n    async redirects() {\n      return [{ source: '/test', destination: '/test2', permanent: false }]\n    },\n  },\n})\n\nexpect(response.status).toEqual(307)  // 임시 리다이렉트인지 확인\nexpect(getRedirectUrl(response)).toEqual('https://nextjs.org/test2')  // 리다이렉트 목적지 확인\n```\n\n### 핵심 포인트\n- `unstable_getResponseFromNextConfig`는 Next.js 설정(여기서는 `redirects`)에 따라 주어진 URL에 대한 응답 객체를 생성해줘요.\n- `getRedirectUrl`은 응답 헤더 중 리다이렉트 위치(URL)를 쉽게 추출할 수 있게 도와줍니다.\n- 여기서는 '/test'가 '/test2'로 임시 리다이렉트(307) 되는지 검사중이에요.\n\n### 참고할 점\n- 아직 `unstable_` 접두어가 붙어있으니 API가 안정화되지 않았고, 향후 바뀔 수도 있어요.\n- 실제 프로젝트에서는 이런 테스트를 CI 파이프라인에 넣어두면 배포 전에 리다이렉트 설정 및 동작을 자동으로 검증할 수 있어 매우 편리하답니다.\n\n### 마무리\n이렇게 Next.js의 내부 설정을 직접 불러와서 테스트할 수 있는 방법이 있어서, 리다이렉트뿐 아니라 다른 설정도 비슷하게 점검할 수 있어요. 실험적인 API지만 앞으로 점점 정식화될 가능성이 크니 주목해 보세요! \n\n필요하면 `next.config.js` 내 redirects 설정 외에 rewrites, headers 등도 유사하게 검증할 수 있다는 점도 덧붙여 드립니다.","ogImage":{"url":"/TIL/assets/img/nextjs.png"},"coverImage":"/TIL/assets/img/nextjs.png","tag":["Tech"],"readingTime":10},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003enext.config.js 설정하기\u003c/h1\u003e\n\u003cp\u003eNext.js는 프로젝트 최상단(예: package.json이 위치한 같은 폴더)에 \u003ccode\u003enext.config.js\u003c/code\u003e 파일을 만들어 다양한 설정을 할 수 있어요. 이 파일은 기본적으로 \u003ccode\u003emodule.exports\u003c/code\u003e로 구성한 객체를 내보내는 형태입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// @ts-check\u003c/span\u003e\n \n\u003cspan class=\"hljs-comment\"\u003e/** \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e} */\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n  \u003cspan class=\"hljs-comment\"\u003e/* 여기에 설정 옵션들을 적어주세요 */\u003c/span\u003e\n}\n \n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = nextConfig\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이렇게 하면 Next.js가 프로젝트를 빌드하거나 실행할 때 이 설정을 참조하게 되죠.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eECMAScript 모듈 방식으로 작성하기\u003c/h2\u003e\n\u003cp\u003e최근에는 Node.js가 ECMAScript Modules(ESM)을 더 잘 지원하면서, \u003ccode\u003enext.config.js\u003c/code\u003e 파일을 \u003ccode\u003eESM\u003c/code\u003e 방식으로 작성하고 싶을 때도 있어요. 예를 들어 \u003ccode\u003eexport default\u003c/code\u003e를 사용하는 식이죠.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e/** \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e} */\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n  \u003cspan class=\"hljs-comment\"\u003e/* 설정 작성 */\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e nextConfig\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e단, 이렇게 하려면 \u003ccode\u003epackage.json\u003c/code\u003e에 \u003ccode\u003e\"type\": \"module\"\u003c/code\u003e을 명시하거나, \u003ccode\u003enext.config.mjs\u003c/code\u003e와 같이 \u003ccode\u003e.mjs\u003c/code\u003e 확장자를 사용해야 해요. 그렇지 않으면 여전히 CommonJS 형식(\u003ccode\u003emodule.exports\u003c/code\u003e)을 사용해야 합니다.\u003c/p\u003e\n\u003ch3\u003e참고로!\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e기본적으로 Next.js는 CommonJS 방식을 선호하고, 대부분 예제도 이 방식을 따라요.\u003c/li\u003e\n\u003cli\u003e만약 ESM 방식으로 작성했다면, Node.js 버전 호환과 프로젝트 설정을 꼼꼼히 확인하는 게 좋아요.\u003c/li\u003e\n\u003cli\u003e또, 환경 변수 설정이나 커스텀 웹팩 등 고급 설정을 할 때 이 차이가 영향을 줄 수 있으니 주의하세요!\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003ccode\u003enext.config.js\u003c/code\u003e는 Next.js 프로젝트를 내 입맛에 맞게 조정하는 아주 중요한 파일이에요. 설정 가능한 옵션들은 \u003ca href=\"https://nextjs.org/docs/api-reference/next.config.js/introduction\" rel=\"nofollow\" target=\"_blank\"\u003e공식 문서\u003c/a\u003e를 참고하면 더 다양한 기능을 활용할 수 있어요!\u003c/p\u003e\n\u003cp\u003e필요한 설정을 넣고 내 프로젝트를 더 똑똑하게 만들어봅시다! 🚀\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003enext.config.js는 일반적인 Node.js 모듈이지 JSON 파일이 아니에요. 이 파일은 Next.js 서버와 빌드 단계에서 사용되고, 브라우저 빌드에는 포함되지 않아요.\u003c/p\u003e\n\u003cp\u003e만약 ECMAScript 모듈 방식을 사용하고 싶다면, next.config.mjs 파일을 쓸 수 있는데요, 이렇게 작성하면 됩니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// @ts-check\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e/**\n * \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e}\n */\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n  \u003cspan class=\"hljs-comment\"\u003e/* 여기에 설정 옵션을 넣으면 돼요 */\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e nextConfig\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003e참고로 좋은 정보! 현재 next.config 파일은 .cjs, .cts, .mts 확장자는 지원하지 않으니 꼭 .js 나 .mjs 확장자를 사용해야 해요.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e추가로, next.config.js는 서버 사이드에서만 동작하기 때문에 브라우저에 환경 설정이 노출되지 않는다는 점이 큰 장점이에요. 그래서 보안에 민감한 설정이나 API 키 같은 걸 넣어도 안전하게 사용할 수 있답니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e함수 형태로 설정하기\u003c/h2\u003e\n\u003cp\u003eNext.js 설정을 할 때, 단순히 객체를 내보내는 것 말고도 함수를 사용해서 설정할 수 있어요. 이렇게 하면 환경에 따라 동적으로 설정값을 다르게 줄 수 있어서 유용하답니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// @ts-check\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e (phase, { defaultConfig }) =\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e/**\n   * \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e}\n   */\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n    \u003cspan class=\"hljs-comment\"\u003e/* 여기에 설정 옵션 작성 */\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e nextConfig\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e예를 들어, 빌드 시점(phase)에 따라 다른 옵션을 주거나, 기본 설정(defaultConfig)을 참고할 수도 있어요.\u003c/p\u003e\n\u003ch3\u003e비동기 설정도 가능해요!\u003c/h3\u003e\n\u003cp\u003e여기까지 보면 그냥 동기 함수 같지만, async 함수로 만들 수도 있어요. 예를 들어 외부 API에서 설정 정보를 받아 와야 한다면, async/await를 이용해서 처리할 수 있답니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (phase, { defaultConfig }) =\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 예: 외부 API에서 설정 가져오기\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e externalSettings = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efetchSomeSettings\u003c/span\u003e()\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n    ...defaultConfig,\n    ...externalSettings,\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이렇게 하면 설정 값도 API 호출 결과에 따라 유연하게 바꿀 수 있으니, 복잡한 환경에서도 활용하기 딱 좋겠죠?\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e다만, async 설정을 쓸 때는 빌드 시간에 네트워크 요청이 포함되니까 빌드 속도가 느려질 수 있어요. 꼭 필요한 경우에만 사용하는 게 좋아요!\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eNext.js 12.1.0 버전부터는 async 함수를 사용해서 설정 파일을 작성할 수 있어요. 예를 들어:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// @ts-check\u003c/span\u003e\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (phase, { defaultConfig }) =\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e/**\n   * \u003cspan class=\"hljs-doctag\"\u003e@type\u003c/span\u003e {\u003cspan class=\"hljs-type\"\u003eimport('next').NextConfig\u003c/span\u003e}\n   */\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nextConfig = {\n    \u003cspan class=\"hljs-comment\"\u003e/* 여기에 설정 옵션을 작성하세요 */\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e nextConfig\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e여기서 \u003ccode\u003ephase\u003c/code\u003e는 현재 설정이 로드되는 상황(컨텍스트)을 의미해요. 어떤 상황에서 설정이 호출되는지 구분해서 설정을 다르게 할 수 있죠. Next.js에서는 여러 가지 phase를 제공합니다.\u003c/p\u003e\n\u003cp\u003e그리고 이런 phase 값들은 \u003ccode\u003enext/constants\u003c/code\u003e 모듈에서 가져올 수 있어요. 예를 들어 이렇게요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-variable constant_\"\u003ePHASE_DEVELOPMENT_SERVER\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003ePHASE_PRODUCTION_BUILD\u003c/span\u003e } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'next/constants'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이걸 활용하면 특정 상황에서만 설정을 다르게 하거나, 개발 모드와 프로덕션 모드에 맞는 설정을 분리할 수 있답니다.\u003c/p\u003e\n\u003ch3\u003ePhase 종류 예시\u003c/h3\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003e상수\u003c/th\u003e\u003cth\u003e의미\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ePHASE_DEVELOPMENT_SERVER\u003c/code\u003e\u003c/td\u003e\u003ctd\u003e개발 서버 실행 시\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ePHASE_PRODUCTION_BUILD\u003c/code\u003e\u003c/td\u003e\u003ctd\u003e프로덕션 빌드 시\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ePHASE_PRODUCTION_SERVER\u003c/code\u003e\u003c/td\u003e\u003ctd\u003e프로덕션 서버 실행 시\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003ccode\u003ePHASE_EXPORT\u003c/code\u003e\u003c/td\u003e\u003ctd\u003e정적 HTML Export 수행 시\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003e이렇게 상황에 따라 설정을 구분해놓으면 훨씬 유연하고 관리하기 쉬워져요. 예를들어 개발환경에선 디버깅 옵션을 켜고, 프로덕션에선 최적화 옵션을 켜는 식으로 말이죠.\u003c/p\u003e\n\u003cp\u003e만약 더 복잡한 설정을 원한다면, async 함수 내에서 API 호출이나 파일 읽기 같은 비동기 작업도 할 수 있어서 설정을 더 동적으로 만들어 줄 수 있어요. Next.js 12.1.0부터 이 기능 덕분에 한층 더 풍부한 설정 구성이 가능해졌답니다!\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e자, 오늘은 Next.js 설정 파일을 다루는 방법에 대해서 이야기해볼게요. Next.js를 사용하다 보면 각 환경(development, production 등)에 따라 다르게 설정하고 싶을 때가 있잖아요? 이럴 때 유용한 예제를 하나 가지고 왔어요.\u003c/p\u003e\n\u003ch3\u003eNext.js 설정 파일 예제 (JavaScript)\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// @ts-check\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-variable constant_\"\u003ePHASE_DEVELOPMENT_SERVER\u003c/span\u003e } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'next/constants'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ephase, { defaultConfig }\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (phase === \u003cspan class=\"hljs-variable constant_\"\u003ePHASE_DEVELOPMENT_SERVER\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e/* 개발 서버 환경일 때만 적용할 설정을 여기에 작성하세요 */\u003c/span\u003e\n    }\n  }\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e/* 개발 서버가 아닌 모든 환경에서 공통적으로 적용할 설정을 여기에 작성하세요 */\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e자, 이 코드는 Next.js의 설정 파일인 \u003ccode\u003enext.config.js\u003c/code\u003e에서 주로 사용됩니다. \u003ccode\u003ephase\u003c/code\u003e라는 매개변수를 받아서 현재 실행 중인 환경을 판단할 수 있어요. 예를 들면, \u003ccode\u003ePHASE_DEVELOPMENT_SERVER\u003c/code\u003e는 로컬 개발 서버를 의미하니까 개발용 설정을 넣고, 그렇지 않은 경우엔 production 등 다른 환경 설정을 넣으면 된답니다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e참고로, \u003ccode\u003edefaultConfig\u003c/code\u003e 매개변수에는 Next.js가 기본으로 제공하는 설정 값들이 포함돼 있어 필요할 때 활용할 수 있어요.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003e그리고 요즘은 TypeScript를 많이 쓰니 Next.js 설정에도 TypeScript를 적용할 수 있어요. 그래서 \u003ccode\u003enext.config.ts\u003c/code\u003e 라는 파일을 사용하면 훨씬 더 타입 안정성을 갖추면서 편하게 작업할 수 있죠.\u003c/p\u003e\n\u003ch3\u003eNext.js 설정 파일 예제 (TypeScript)\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eNextConfig\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'next'\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003enextConfig\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eNextConfig\u003c/span\u003e = {\n  \u003cspan class=\"hljs-comment\"\u003e/* 원하는 설정 옵션을 작성하세요 */\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e nextConfig\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e여기서 중요한 점은 \u003ccode\u003eNextConfig\u003c/code\u003e 타입을 임포트해서 사용하면, 지원하는 설정 옵션들을 타입으로 미리 확인하고 잘못된 설정을 방지할 수 있다는 점이에요.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003e추가 팁!\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ephase\u003c/code\u003e가 다양한 값이 있으니 필요하면 \u003ccode\u003enext/constants\u003c/code\u003e에서 다른 상수들도 확인해보세요. (예: \u003ccode\u003ePHASE_PRODUCTION_BUILD\u003c/code\u003e, \u003ccode\u003ePHASE_EXPORT\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e설정이 많아지면 환경 변수도 함께 관리하는 게 좋아요. \u003ccode\u003e.env.local\u003c/code\u003e, \u003ccode\u003e.env.production\u003c/code\u003e 같은 파일을 Next.js가 자동으로 읽어줍니다.\u003c/li\u003e\n\u003cli\u003eNext.js 공식 문서에서는 환경에 따라 설정 분리하기 좋은 패턴이 많으니 한번 살펴보시면 좋아요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e혹시 더 궁금한 점 있으면 언제든지 물어봐 주세요! 개발하면서 이런 설정들은 꼭 익혀두면 나중에 디버깅도 수월해지고 프로젝트 관리도 편하답니다.\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e여기 주석 처리된 줄들은 next.config.js에서 허용하는 설정들을 넣을 수 있는 자리예요. 이 설정들은 이 파일에 정의되어 있죠.\u003c/p\u003e\n\u003cp\u003e하지만, 꼭 모든 설정을 알아야 하는 건 아니에요! 각 설정이 무슨 역할을 하는지를 다 이해할 필요 없이, 필요에 따라 원하는 기능을 이 부분에서 찾아보고 어떻게 하면 되는지 참고하면 돼요.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e참고로, target Node.js 버전에 지원되지 않는 최신 JavaScript 기능은 사용하지 않는 게 좋아요. next.config.js 파일은 Webpack이나 Babel로 변환되지 않으니까요.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e아래 페이지에서 next.config.js로 설정할 수 있는 모든 옵션들을 자세히 확인할 수 있어요:\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e단위 테스트 (실험적 기능)\u003c/h2\u003e\n\u003cp\u003eNext.js 15.1부터는 \u003ccode\u003enext/experimental/testing/server\u003c/code\u003e 패키지에 next.config.js 파일을 단위 테스트할 수 있는 유틸리티가 포함되어 있어요.\u003c/p\u003e\n\u003cp\u003e여기서 \u003ccode\u003eunstable_getResponseFromNextConfig\u003c/code\u003e 함수는 next.config.js에 정의된 headers, redirects, rewrites 함수들을 실제 요청 정보와 함께 실행하고, 라우팅 결과를 담은 \u003ccode\u003eNextResponse\u003c/code\u003e 객체를 돌려줍니다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e다만, \u003ccode\u003eunstable_getResponseFromNextConfig\u003c/code\u003e 함수는 next.config.js에 정의된 필드만 고려해서 결과를 반환하기 때문에, 미들웨어(middleware)나 파일 시스템 라우트(filesystem routes)는 반영되지 않아요. 그래서 실제 프로덕션 환경에서의 동작과 테스트 결과가 약간 다를 수 있다는 점 기억하세요.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003e제가 좀 더 덧붙이자면, 앞으로 이런 실험적 기능들이 안정화되면, 별도의 E2E(End-to-End) 테스트 없이도 설정 파일을 좀 더 쉽고 빠르게 검증할 수 있을 것 같아요. 현재는 아직 불안정하니, 중요한 부분은 반드시 프로덕션 환경에서 추가 테스트를 하는 것을 추천합니다!\u003c/p\u003e\n\u003c!-- TIL 수평 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"1549334788\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이번에 소개할 코드는 Next.js의 실험적 API를 활용해서 리다이렉트 설정을 테스트하는 방법에 관한 예제예요. Next.js 개발할 때 리다이렉트(redirects) 설정 잘 되어 있는지 테스트하고 싶다면 꽤 유용하게 쓸 수 있죠.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e {\n  getRedirectUrl,\n  unstable_getResponseFromNextConfig,\n} \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'next/experimental/testing/server'\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e response = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eunstable_getResponseFromNextConfig\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003eurl\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'https://nextjs.org/test'\u003c/span\u003e,  \u003cspan class=\"hljs-comment\"\u003e// 테스트할 URL\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enextConfig\u003c/span\u003e: {\n    \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eredirects\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e [{ \u003cspan class=\"hljs-attr\"\u003esource\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'/test'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003edestination\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'/test2'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003epermanent\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e }]\n    },\n  },\n})\n\n\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(response.\u003cspan class=\"hljs-property\"\u003estatus\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003etoEqual\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e307\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e// 임시 리다이렉트인지 확인\u003c/span\u003e\n\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003egetRedirectUrl\u003c/span\u003e(response)).\u003cspan class=\"hljs-title function_\"\u003etoEqual\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'https://nextjs.org/test2'\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e// 리다이렉트 목적지 확인\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e핵심 포인트\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunstable_getResponseFromNextConfig\u003c/code\u003e는 Next.js 설정(여기서는 \u003ccode\u003eredirects\u003c/code\u003e)에 따라 주어진 URL에 대한 응답 객체를 생성해줘요.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetRedirectUrl\u003c/code\u003e은 응답 헤더 중 리다이렉트 위치(URL)를 쉽게 추출할 수 있게 도와줍니다.\u003c/li\u003e\n\u003cli\u003e여기서는 '/test'가 '/test2'로 임시 리다이렉트(307) 되는지 검사중이에요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e참고할 점\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e아직 \u003ccode\u003eunstable_\u003c/code\u003e 접두어가 붙어있으니 API가 안정화되지 않았고, 향후 바뀔 수도 있어요.\u003c/li\u003e\n\u003cli\u003e실제 프로젝트에서는 이런 테스트를 CI 파이프라인에 넣어두면 배포 전에 리다이렉트 설정 및 동작을 자동으로 검증할 수 있어 매우 편리하답니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e마무리\u003c/h3\u003e\n\u003cp\u003e이렇게 Next.js의 내부 설정을 직접 불러와서 테스트할 수 있는 방법이 있어서, 리다이렉트뿐 아니라 다른 설정도 비슷하게 점검할 수 있어요. 실험적인 API지만 앞으로 점점 정식화될 가능성이 크니 주목해 보세요!\u003c/p\u003e\n\u003cp\u003e필요하면 \u003ccode\u003enext.config.js\u003c/code\u003e 내 redirects 설정 외에 rewrites, headers 등도 유사하게 검증할 수 있다는 점도 덧붙여 드립니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2025-04-22-nextconfigjs"},"buildId":"X4OrKfmLtU3-3BijwfHe6","assetPrefix":"/TIL","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>